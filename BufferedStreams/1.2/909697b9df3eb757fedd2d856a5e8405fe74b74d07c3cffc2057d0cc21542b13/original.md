Refill the buffer, optionally moving and retaining part of the data, ensuring buffer space to read at least `minalloc` bytes.
