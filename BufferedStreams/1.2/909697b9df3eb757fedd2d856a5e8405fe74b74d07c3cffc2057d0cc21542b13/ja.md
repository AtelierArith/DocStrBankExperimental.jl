バッファを再充填し、オプションでデータの一部を移動および保持し、少なくとも `minalloc` バイトを読み取るためのバッファスペースを確保します。
