```
FISP2D{T, Ns, U<:AbstractVector, V<:AbstractMatrix} <: EPGSimulator{T,Ns}
```

この構造体は、EPGモデルを使用して、フリップ角スキームが変化する勾配スプイリングシーケンスとアディアバティック反転プレパルスをシミュレートするために使用されます。TRとTEはシーケンス全体で固定されています。瞬時RF励起が仮定されています。スライスプロファイルの補正は、分割EPGモデルを使用して行われ、各フリップ角に対してRFスケーリングファクターのベクトルがシミュレーションの前に決定されます（例えば、小さなティップ角近似やShinnar LeRoux前方モデルを使用）。

各TR内では、RF励起をシミュレートするために単一の時間ステップが使用されます。次に、1つの時間ステップでRF励起の終了からエコー時間まで（T₁およびT₂減衰、T₁再成長、B₀回転を適用）進み、再び1つの時間ステップでエコー時間から次のRF励起の開始まで進みます。

# フィールド

  * `RF_train::U` 各TRのフリップ角を持つベクトルで、abs.(RF*train)はRFフリップ角（度）で、angle.(RF*train)はRF位相（度）であるべきです。
  * `sliceprofiles::V` # スライスプロファイル効果をシミュレートするためのRFスケーリングファクター（a.u.）を持つ行列。各列はスライス方向に沿った1つの位置の（フリップ角依存の）スケーリングファクターを表します。
  * `TR::T`: シーケンス中に一定と仮定される秒単位の繰り返し時間
  * `TE::T`: シーケンス中に一定と仮定される秒単位のエコー時間
  * `max_state::Val{Ns}`: EPGシミュレーションで追跡する最大状態数
  * `TI::T`: 反転プレパルス後の反転遅延（秒単位）
