```
PMC(
    sampler::AbstractSampler,
    model,
    rule::AbstractSamplingRule;
    ntransitions::Int = 100,
    niter::Int = 100,
    kwargs...,
)
```

Runs a Persistent Markov Chain (PMC) using the sampler and model. Persistent Markov Chains are used, for example, for Persistent Contrastive Convergence ([Tieleman (2008)](https://www.cs.toronto.edu/~tijmen/pcd/pcd.pdf)), a variant of the Contrastive Divergence (CD) algorithm. The main difference is that PCD uses a persistent chain to estimate the negative phase of the gradient. This is done by keeping the state of the Markov chain between iterations. 

In our context, the sampler is the persistent chain and the model is a supervised model. The sampler generates samples from the model's learned distribution. 

# Note

This function does not perform any training. It only generates samples from the model. In other words, there is no Contrastive Divergence. For training Joint Energy Models, see [JointEnergyModels.jl](https://github.com/JuliaTrustworthyAI/JointEnergyModels.jl).

# Arguments

  * `sampler::AbstractSampler`: The sampler to use.
  * `model`: The model to sample from.
  * `rule::AbstractSamplingRule`: The sampling rule to use.
  * `ntransitions::Int=100`: The number of transitions to perform.
  * `niter::Int=100`: The number of iterations to perform.
  * `kwargs...`: Additional keyword arguments.

# Returns

  * `sampler.buffer`: The buffer containing the samples generated by the sampler.
