```
setup_reservoir_simulator(case::JutulCase; <keyword arguments>)
```

# キーワード引数

  * `mode=:default`: 解決に使用されるモード。MPIモードでHYPRE、PartitionedArrays、およびMPIと一緒に実行している場合は、`:mpi`に設定できます。
  * `method=:newton`: `:newton`、`:nldd`、または`:aspen`にできます。Newtonは最もテストされたアプローチであり、`:nldd`は難しいモデルの速度を向上させることができます。`:nldd`オプションは、追加のオプションを有効にします（詳細についてはシミュレーターの設定を参照してください）。
  * `presolve_wells=false`: 各線形化の前に井戸を解決します。マルチセグメント井戸を持つモデルの収束を改善することができます。

## 線形ソルバーオプション

  * `linear_solver=:bicgstab`: 使用する反復ソルバー（提供されたモデルがサポートしている場合）。典型的なオプションは`:bicgstab`または`:gmres`です。代わりに線形ソルバーインスタンスを渡すこともできます。
  * `precond=:cpr`: 反復ソルバーの前処理器。大きな問題には、CPRバリアントが推奨されます。強度とコストの順に：

      * `:cpr` ILU(0)第二段階を持つ標準制約圧力残差（強い前処理器）
      * `:cprw` ILU(0)第二段階を持つCPRW。井戸を持つ問題に対してはより速い（強い前処理器）
      * `:ilu0` ブロック不完全LU（中程度の強度の前処理器）
      * `:spai0`: 最低次のスパース近似逆行列（弱い前処理器）
      * `jacobi`: ジャコビ前処理器（弱い前処理器）
  * `rtol=nothing`: 線形ソルバーの相対許容誤差。`nothing`に設定すると、前処理器のデフォルトの許容誤差が使用され、CPRバリアントの場合は5e-3、スムーザーの場合は1e-2です。
  * `linear_solver_arg`: 追加の線形ソルバー引数を含む`Dict`。

## タイムステッピングオプション

  * `initial_dt=si_unit(:day)`: 初期タイムステップ（デフォルトで1日）
  * `target_ds=Inf`: タイムステッパーによって使用されるタイムステップ内の目標飽和度変化。
  * `target_dz=Inf`: タイムステッパーによって使用されるタイムステップ内の目標モル分率変化（成分的のみ）。
  * `target_its=8`: タイムステップごとの非線形反復の目標数
  * `offset_its=1`: タイムステップセレクターの減衰パラメータ。大きな値はより悲観的な推定をもたらします。
  * `timesteps=:auto`: 自動タイムステッピングを使用するには`:auto`に設定し、自動タイムステッピングを行わないには`:none`に設定します（すなわち、正確な報告ステップを解決しようとします）
  * `max_timestep=si_unit(:year)`: ソルバーで使用される最大内部タイムステップ。
  * `min_timestep=0.0`: ソルバーで使用される最小内部タイムステップ。

## 収束基準

  * `tol_cnv=1e-3`: 最大許容点ごとの誤差（体積バランス）
  * `tol_mb=1e-7`: 最大許容統合誤差（質量バランス）
  * `tol_cnv_well=10*tol_cnv`: 井戸ノードの最大許容点ごとの誤差（体積バランス）
  * `tol_mb_well=1e4*tol_mb`: 井戸ノードの最大許容統合誤差（質量バランス）
  * `inc_tol_dp_abs=Inf`: 最大許容圧力変化（絶対）
  * `inc_tol_dp_rel=Inf`: 最大許容圧力変化（絶対）
  * `inc_tol_dz=Inf`: 最大許容成分変化（成分的のみ）。

## 継承されたキーワード引数

追加のキーワード引数は、基本的なJutulシミュレーションフレームワークから来ます。便利のために、ここに最も関連性の高いエントリのいくつかをリストします：

  * `info_level = 0`: 出力レベル。最小出力のために0に設定し、出力なしのために-1に設定し、冗長性を増すために1以上に設定します。
  * `output_path`: 出力を書き込むパス。
  * `max_nonlinear_iterations=15`: タイムステップがカットされる前の最大ニュートン反復数。
  * `min_nonlinear_iterations=1`: 収束を確認する前に実行する最小ニュートン数。
  * `relaxation=Jutul.NoRelaxation()`: 解決に使用される減衰。難しいモデルには`Jutul.SimpleRelaxation()`に設定できます。等価なオプションは、減衰のために`true`に設定し、減衰なしのために`false`に設定することです。
  * `failure_cuts_timestep=true`: 数値的な問題が発生したときにエラーを投げるのではなく、タイムステップをカットします（例：線形ソルバーの発散）。
  * `max_timestep_cuts=25`: ソルバーがあきらめる前の最大タイムステップカット数。動的タイムステッピングを使用する場合、これは実際には最小タイムステップを定義し、カット後にタイムステップが動的に増加する場合は、指定されたカット数を超えることが許可されます。
  * `timestep_max_increase=10.0`: タイムステップを増加させるための最大許容係数。動的ステップ選択で行われた選択を上書きします。
  * `timestep_max_decrease=0.1`: タイムステップを減少させるための最大許容係数。動的ステップ選択で行われた選択を上書きします。
  * `tol_factor_final_iteration=1.0`: 1.0より大きい値に設定すると、タイムステップがカットされる前の最終収束チェックが、この値で全ての許容誤差を乗算することによって緩和されます。警告：大きな値に設定すると数値的な精度に深刻な影響を与える可能性があります。デフォルトの許容誤差が厳しい場合、1から10の値は通常安全です。
