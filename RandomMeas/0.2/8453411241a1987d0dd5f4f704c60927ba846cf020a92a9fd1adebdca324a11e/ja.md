```
get_trace_moment(ψ::Union{MPS, MPO}, k::Int, subsystem::Vector{Int}=collect(1:length(ψ)))
```

与えられた量子状態の部分系に対するk番目のトレースモーメントを計算します。

純粋状態（MPS）の場合、かつ部分系がサイト1から始まる連続したものであるとき、この関数は`subsystem`の最後のサイトで定義される二分割のエンタングルメントスペクトルを計算し、シュミット係数の二乗のk番目のモーメントを返します。それ以外の場合、関数は状態を指定された部分系に縮小します。

k = 2（純度）の場合、二乗ノルム（これはtr(ρ²)に相当します）を返します。k > 2の場合、`apply`関数を繰り返し適用してρ^kを計算し、得られたテンソルのトレースを返します。

# 引数

  * `ψ::Union{MPS, MPO}`: 量子状態、純粋状態の場合はMPS、混合状態の場合はMPOとして表現されます。
  * `k::Int`: 計算するモーメントの次数（整数である必要があります ≥ 1）。
  * `subsystem::Vector{Int}`（オプション）: 保持する部分系を指定するサイトインデックスのベクトル（1ベース）。デフォルトはすべてのサイトです。

# 戻り値

縮小された密度行列のk番目のトレースモーメントを表すスカラー（Float64）。

# 例

```julia
moment = get_trace_moment(ψ, 3, [1, 2, 3]; partial_transpose=false)
```
