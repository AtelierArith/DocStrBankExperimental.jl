```
co_refract(old_alt[, altitude=0, pressure=NaN, temperature=NaN,
           epsilon=0.25, to_observe=false]) -> aout
```

### 目的

大気屈折による高度の補正を計算します。

### 説明

空気の屈折率が正確に1.0ではないため、大気はすべての入射光を曲げ、星や他の天体が実際よりもわずかに異なる高度（または標高）に見えるようにします。以下の定義を理解することが重要です：

  * 観測高度：望遠鏡で見たときの星の見かけの高度。これは空における位置です。これは常に見かけの高度よりも大きいはずです。
  * 見かけの高度：大気がなければ星があるはずの高度（時には「真の」高度と呼ばれます）。これは通常、天体の天球座標から計算されます。見かけの高度は常に観測高度よりも小さいはずです。

したがって、例えば、地平線上で見る太陽の見かけの高度は実際には-34アークミニッツです。

このプログラムは、ほとんどの光学およびラジオ波長に対する効果を推定するためにいくつかの簡単な公式を使用します。通常、観測から得られた観測高度がわかっており、見かけの高度を求めたい場合に使用します。逆に行くために、このプログラムは反復的なアプローチを使用します。

### 引数

  * `old_alt`：度単位の観測高度。`to_observe`がtrueに設定されている場合、これは見かけの高度である必要があります。
  * `altitude`（オプション）：観測地点の高さ（メートル単位）。これは、別々に指定されていない場合の温度と圧力の近似値を決定するためにのみ使用されます。デフォルトは0、すなわち海面です。
  * `pressure`（オプション）：観測地点の圧力（ミリバール単位）。デフォルトはNaNです。
  * `temperature`（オプション）：観測地点の温度（ケルビン単位）。デフォルトはNaNです。
  * `epsilon`（オプション）：得られる精度（アーク秒単位）。`to_observe`がtrueの場合、計算されます。デフォルトは0.25アーク秒です。
  * `to_observe`（オプションのブールキーワード）：trueに設定されている場合、`old_alt`が見かけの高度を入力として持ち、観測高度が求められると仮定されます。

### 出力

  * `aout`：見かけの高度（度単位）。`to_observe`がtrueに設定されている場合、観測高度が返されます。

### 例

太陽の下部が0d 30'の高度で観測されました。平均的な気圧と温度の条件を使用して、太陽の下部の真の（すなわち見かけの）高度を計算します。

```jldoctest
julia> using AstroLib

julia> co_refract(0.5)
0.02584736873098442
```

### 注意事項

高度が設定されているが温度または圧力が設定されていない場合、プログラムは温度と圧力のインテリジェントな推測を行います。

#### 波長依存性

この補正は天頂で0、45度で約1アークミニッツ、光学波長の地平線で34アークミニッツです。補正はすべての波長で無視できないが、非常に簡単に計算できるわけではありません。これらの公式は550 nmの波長を仮定しており、10度以上の標高に対してすべての可視波長で約4アーク秒の精度があります。驚くべきことに、これらは100 GHz未満のラジオ周波数にも正確です。

#### 参考文献

  * Meeus, Astronomical Algorithms, Chapter 15.
  * Explanatory Supplement to the Astronomical Almanac, 1992.
  * Methods of Experimental Physics, Vol 12 Part B, Astrophysics, Radio Telescopes, Chapter 2.5, "Refraction Effects in the Neutral Atmosphere", by R.K. Crane.

この関数のコードはIDL Astronomy User's Libraryに基づいています。 ```
