```
Diffusivity(target::SIA2D_D_target; H, ∇S, θ, iceflow_model, ml_model, glacier, params)
```

2D浅氷モデルのための有効拡散率フィールドを診断`target`と予測された速度行列`U`を使用して計算します。

この関数は、学習済みまたは指定されたモデルを使用して速度行列`U`を推定し、次に拡散率を`H .* U`（次元が一致する場合）または次元が1つのグリッドセル異なる場合（スタッガードグリッド）の`H`の平均値に`U`を掛けたものとして計算します。次元が互換性がない場合はエラーが発生します。

# 引数

  * `target::SIA2D_D_target`: 補間およびスケーリングルールを定義する診断ターゲットオブジェクト。

# キーワード引数

  * `H`: 氷の厚さ。
  * `∇S`: 氷の表面傾斜。
  * `θ`: モデルのパラメータ。
  * `iceflow_model`: シミュレーションに使用される氷流モデル。
  * `ml_model`: シミュレーションに使用される機械学習モデル。
  * `glacier`: 氷河データ。
  * `params`: モデルパラメータ。

# 戻り値

  * `H`と同じ形状の拡散率値の行列、または`U`に応じて1セル分スタッガードされたもの。

# 例外

  * `U`と`H`の次元が拡散率計算に互換性がない場合はエラーが発生します。

# 注意事項

内部で`predict_U_matrix`を使用して速度に似た項を取得します。必要に応じて`H`を平均化することで、グリッドが一致する構成とスタッガード構成の両方をサポートします。
