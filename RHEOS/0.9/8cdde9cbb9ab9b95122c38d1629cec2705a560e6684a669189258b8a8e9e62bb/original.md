```
modelfit(data::RheoTimeData, model::RheoModelClass, modloading::Symbol; p0::Union{NamedTuple,Nothing} = nothing, lo::Union{NamedTuple,Nothing} = nothing, hi::Union{NamedTuple,Nothing} = nothing, verbose::Bool = false, rel_tol_x = 1e-4, diff_method="BD", weights::Union{Vector{Integer},Nothing}=nothing)
```

Fit `RheologyData` struct to model and return a fitted model as a `RheologyModel` object. For the fitting process RHEOS relies on the optimistion package [NLopt](https://nlopt.readthedocs.io/en/latest/). By default, RHEOS makes use of a local derivative free algorithm, specifically the Tom Rowan's "Subplex" It is possible to specify which algorithm NLopt should use with the keyword parameter `optmethod`, by providing the relevant symbols as defined by NLopt.jl. Suitable options include `:LN_SBPLX` (default),  `:LN_COBYLA`, `:LN_BOBYQA` for local derivative free optimisation. Global optimisation methods are also available, but require all parameters to have lower and upper bounds set. More information about these algorithms is available on the [NLopt website](https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/).

# Arguments

  * `data`: `RheoTimeData` struct containing all data
  * `model`: `RheoModelClass` containing moduli functions and named tuple parameters
  * `modloading`: `strain_imposed` or `1`, `stress_imposed` or `2`
  * `p0`: Initial parameters to use in fit (uses 0.5 for all parameters if not defined), provided as a named tuple
  * `lo`: Lower bounds for parameters, provided as a named tuple
  * `hi`: Upper bounds for parameters, provided as a named tuple
  * `verbose`: If true, prints parameters on each optimisation iteration
  * `rel_tol_x`: Relative tolerance of optimization as a function of input parameter values, see NLOpt docs for more details
  * `rel_tol_f`: If given, sets a criterion based directly on changes of the function value
  * `diff_method`: Set finite difference formula to use for derivative, currently `"BD"` or `"CD"`
  * `weights`: Vector of indices weighted according to importance, can be generated by `indexweight` function
  * `optmethod`: optimisation algorithm used by NLOpt (passed as symbol or string)
  * `opttimeout`: allows user to set a wall clock timeout on optimisation, used to halt a failing optimisation and return safely
  * `optmaxeval`: allows user to set a maximum number of evaluations during optimisation, used when repeatability is required
