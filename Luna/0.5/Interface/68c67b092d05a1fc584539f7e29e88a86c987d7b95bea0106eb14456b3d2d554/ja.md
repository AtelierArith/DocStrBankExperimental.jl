```
prop_capillary(radius, flength, gas, pressure; λ0, λlims, trange, kwargs...)
```

キャピラリーモデルを使用して、空洞ファイバー内のパルス伝播をシミュレートします。

# 必須引数

  * `radius`: ファイバーのコア半径。定数半径の場合は`Number`、または`z`依存の半径を返す関数`a(z)`であることができます。
  * `flength::Number`: ファイバーの長さ。
  * `gas::Symbol`: 充填ガスの種類。
  * `pressure`: ガス圧。定数圧の場合は`Number`、単純な圧力勾配の場合は`Number`の2-タプル、または`(Z, P)`のタプルで、`Z`と`P`は`z`位置とその位置での圧力を含みます。
  * `λ0`: (キーワード引数) シミュレーションのための基準波長。単純な単一パルス入力の場合、これは入力パルスの中心波長でもあります。
  * `λlims::Tuple{<:Number, <:Number}`: シミュレーショングリッドの波長制限。
  * `trange::Number`: 時間グリッドの全幅。サンプル数を2の累乗にするために、実際に使用されるグリッドは通常大きくなります。

# グリッドオプション

  * `envelope::Bool`: シミュレーションにエンベロープ場を使用するかどうか。デフォルトは`false`です。デフォルトでは、エンベロープシミュレーションは三次高調波生成を無視します。プラズマはエンベロープ場にはまだ実装されていません。
  * `δt::Number`: 非線形相互作用に使用される細かいグリッドの時間ステップ。デフォルトでは、これは波長グリッドによって決定されます。`δt`が指定され、必要な値より**小さい**場合は、代わりに使用されます。

# 入力パルスオプション

最低次モードの単一パルスは、以下のキーワード引数で指定できます。より複雑な入力は、単一の`AbstractPulse`または`Vector{AbstractPulse}`で定義できます。この場合、`λ0`以外のすべてのキーワード引数は無視されます。

  * `λ0`: 中心波長
  * `τfwhm`: 半値全幅で定義されるパルスの持続時間。
  * `τw`: 「自然」パルス持続時間。パルス形状が`sech`の場合のみ利用可能。
  * `ϕ`: 変換制限パルスに適用されるスペクトル位相。要素は通常の多項式位相ϕ₀ (CEP)、ϕ₁ (群遅延)、ϕ₂ (GDD)、ϕ₃ (TOD)などです。
  * `energy`: パルスエネルギー。
  * `power`: **スペクトル位相が追加された後の**ピークパワー。
  * `pulseshape`: 変換制限パルスの形状。ガウスパルスの場合は`:gauss`、sech²パルスの場合は`:sech`。
  * `polarisation`: 入力パルスの偏光。`:linear`（デフォルト）、`:x`、`:y`、`:circular`、または楕円率-1 ≤ ε ≤ 1の数値。ここで、ε=-1は左手円偏光、ε=1は右手円偏光、ε=0は線形偏光に対応します。楕円偏光の主軸は常にy軸です。
  * `propagator`: シミュレーション開始前にパルスに任意の伝播を適用するために最初の引数を**変異**させる関数`propagator!(Eω, grid)`。
  * `shotnoise`: `true`（デフォルト）の場合、モードごとの1光子量子ノイズが含まれます。

# モードオプション

  * `modes`: 伝播に含まれるモードを定義します。次のいずれかです：

      * 単一モード指定子（デフォルト: :HE11）、これはモード平均伝播をもたらします（すべての入力が線形偏光である限り）。
      * モード指定子のリスト、これはそれらのモードでの多モード伝播をもたらします。
      * モードの`Number` `N`、これは単に最初の`N` `HE`モードを作成します。

    楕円または円偏光が含まれる場合、各モードは出力に2回現れます。1回は`x`偏光、もう1回は`y`偏光です。
  * `model::Symbol`: `:full`は、モードの有効屈折率にクラッディングの完全な複素屈折率を含むか、`:reduced`は文献で一般的に見られるより単純なモデルを使用します。詳細については`Luna.Capillary`を参照してください。デフォルトは`:full`です。
  * `loss::Bool`: 伝播損失を含めるかどうか。デフォルトは`true`です。

# 非線形相互作用オプション

  * `kerr`: ケル効果を含めるかどうか。デフォルトは`true`です。
  * `raman`: ラマン効果を含めるかどうか。デフォルトは`false`です。
  * `plasma`: 次のいずれかです。

      * `:ADK` – ADKイオン化率を使用してプラズマを含める。
      * `:PPT` – PPTイオン化率を使用してプラズマを含める。
      * `true`（デフォルト） – `:PPT`と同じ。
      * `false` – プラズマを無視します。

    プラズマはフルフィールドシミュレーションでのみ利用可能です。
  * `PPT_stark_shift::Bool`: PPTイオン化率を使用する場合、基底状態エネルギーレベルのスタークシフトの影響を含めるかどうかを決定します。*必要なデータはヘリウム、ネオン、アルゴンにのみ利用可能です！*
  * `thg::Bool`: 三次高調波生成を含めるかどうか。フルフィールドシミュレーションではデフォルトで`true`、エンベロープシミュレーションでは`false`です。

`raman`が`true`の場合、次のオプションが適用されます：     - `rotation::Bool = true`: 回転ラマン寄与を含めるかどうか     - `vibration::Bool = true`: 振動ラマン寄与を含めるかどうか

# 出力オプション

  * `saveN::Integer`: フィールドを保存するz方向のポイント数。
  * `filepath`: `nothing`（デフォルト）の場合、シミュレーション結果を作業メモリ内にのみ保存する`MemoryOutput`を作成します。`nothing`でない場合は、`String`としてのファイルパスであり、結果はこの場所にあるファイルに保存されます。`scan`が渡された場合、`filepath`はスキャンの出力**ディレクトリ**を決定します。
  * `scan`: パラメータスキャンを定義する`Scan`インスタンス。`scan`が指定された場合、`Output.ScanHDF5Output`が使用されてスキャンの出力ファイルを自動的に命名し、生成します。`scanidx`も指定する必要があります。
  * `scanidx`: 実行中のスキャン内の現在のスキャンインデックス。`scan`が渡された場合のみ使用されます。
  * `filename`: パラメータスキャンを実行する際にスキャン名を上書きするために使用できます。実行中の`scanidx`がこのファイル名に追加されます。`scan`が指定されていない場合は無視されます。
  * `status_period::Number`: 印刷されたステータス更新の間隔（秒単位）。
