# 非線形多変数最小二乗法

モデルの最小二乗フィットを計算するためにニュートンのようなアルゴリズムを使用します。

## パラメータ:

  * `x` 各列が変数である配列
  * `fun` フィッティングすべき関数（後で詳しく説明します）
  * `a0` 各フィッティングパラメータの初期推定値
  * `eps` 収束基準
  * `maxiter` 最大反復回数

## モデルの指定

モデルは、次のシグネチャに従って呼び出し可能であるべき引数 `fun` で指定されます:

`r = fun(x, a)`

ここで、`x` と `a` はベクトルです。

アルゴリズムの実装方法により、関数は暗黙的であることが許可されています。これは、`fun(x, a) = 0` の関係をフィットさせようとしていることを意味します。

## 初期推定値

初期推定値は重要であり、期待される値にできるだけ近いものであるべきです。少なくとも、各パラメータのオーダーを示す必要があります。ゼロ値は推奨されません。なぜなら、この場合、オーダーの大きさが利用できず、仮定されるからです。初期ステップは `a0/10` と仮定されます。

## 収束基準

初期推定値 `a0` は、おそらくデータにうまくフィットしません。`maxerr = maxabs(fun(x, a0))`（最大誤差）の最大値が基準として使用され、新しい近似が計算されるたびに、パラメータの変化がこの基準誤差と比較されます。もしそれが小さい場合、`maxabs(da) < eps*maxerr`、アルゴリズムは収束したと見なされます。

## 戻り値

次の内容を含むタプル:

  * 推定された係数
  * アルゴリズムが収束したかどうかを示す `Bool`
  * 収束するのにかかった反復回数。
