```
inner(B::MPO, y::MPS, A::MPO, x::MPS)
```

`⟨By|A|x⟩ = ⟨By|Ax⟩` を効率的かつ正確に計算します。中間のMPOを作成することはありません。一般的に、`inner(apply(B, y), apply(A, x))` よりも効率的で正確です。

これは演算子 `A` の分散を計算するのに役立ちます。分散は次のようになります：

```julia
inner(A, x, A, x) - inner(x, A, x) ^ 2
```

!!! compat "ITensors 0.3"



ITensors 0.3以前は、`inner` に `make_inds_match` というキーワード引数があり、デフォルトは `true` でした。`true` の場合、関数は収束する前にサイトインデックスを一致させようとしました。したがって、入力は異なるサイトインデックスを持つことができましたが、同じ次元またはQNブロックを持っている限りです。この動作は脆弱で、テンソルごとに単一のサイトインデックスを持つMPSにのみ機能しましたが、ITensors 0.3以降は非推奨となりました。ITensors 0.3以降は、収束するために入力するMPSまたはMPOが互換性のあるサイトインデックスを持っていることを確認する必要があります。たとえば、プライムレベルが適切に一致していることを確認することです。

[`dot`](@ref) と同じです。
