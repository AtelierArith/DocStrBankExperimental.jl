```
corners = corner2subpixel(responses::AbstractMatrix,corner_indicator::AbstractMatrix{Bool})
        -> Vector{HomogeneousPoint{Float64,3}}
```

整数のコーナー座標をサブピクセル精度に精緻化します。

この関数は、コーナー応答を表す行列と、画像内のコーナーの整数座標を示すブール指標行列を入力として受け取ります。出力は、コーナーのサブピクセル座標を格納する型[`HomogeneousPoint`](@ref)のベクトルです。

アルゴリズムは、元の整数座標に加算される補正係数を計算します。特に、コーナーとその直近の東/西、北/南の隣接点の$x$座標と$y$座標に対して、1次元の二次多項式が別々にフィットされます。フィットは、各コーナーのためのローカル座標系を使用して達成され、座標系の原点は指定されたコーナーであり、その直近の隣接点にはマイナス1とプラス1の座標が割り当てられます。

コーナーとその2つの隣接点は、3つの方程式のシステムを形成します。例えば、$x_1 = -1$、$x_2 = 0$、$x_3 = 1$を西、中央、東のピクセルのローカル$x$座標とし、ベクトル$\mathbf{b} = [r_1, r_2, r_3]$を対応するコーナー応答値とします。次のように

$$
    \mathbf{A} =
        \begin{bmatrix}
            x_1^2 & x_1  & 1  \\
            x_2^2 & x_2  & 1 \\
            x_3^2 & x_3  & 1 \\
        \end{bmatrix},
$$

二次多項式の係数は、方程式のシステム$\mathbf{b} = \mathbf{A}\mathbf{x}$を解くことによって見つけることができます。結果は$x = \mathbf{A}^{-1}\mathbf{b}$で与えられます。

二次多項式の頂点は、真のコーナー位置のサブピクセル推定を提供します。例えば、1次元の二次多項式$px^2 + qx + r$の場合、頂点の$x$座標は$\frac{-q}{2p}$です。したがって、精緻化されたサブピクセル座標は$c +  \frac{-q}{2p}$に等しく、ここで$c$は整数座標です。

!!! note
    画像の境界にあるコーナーは、サブピクセル精度に精緻化されません。

