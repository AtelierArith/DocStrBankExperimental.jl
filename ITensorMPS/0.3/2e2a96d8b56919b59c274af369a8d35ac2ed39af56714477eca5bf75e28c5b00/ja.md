```
inner(y::MPS, A::MPO, x::MPS)
```

`⟨y|A|x⟩ = ⟨y|Ax⟩` を効率的かつ正確に計算します。中間のMPOを作成することはありません。一般的に、`inner(y, apply(A, x))` よりも効率的で正確です。

これは演算子 `A` の期待値を計算するのに役立ちます。これは次のようになります：

```julia
inner(x', A, x)
```

`x` が正規化されていると仮定します。

`⟨By|Ax⟩` を計算したい場合は、`inner(B::MPO, y::MPS, A::MPO, x::MPS)` を使用できます。

これは演算子 `A` の分散を計算するのに役立ちます。これは次のようになります：

```julia
inner(A, x, A, x) - inner(x', A, x) ^ 2
```

`x` が正規化されていると仮定します。

!!! compat "ITensors 0.3"



ITensors 0.3 より前は、`inner` に `make_inds_match` というキーワード引数があり、デフォルトは `true` でした。真の場合、関数は収束する前にサイトインデックスを一致させようとしました。したがって、入力は異なるサイトインデックスを持つことができましたが、同じ次元またはQNブロックを持っている限りです。この動作は脆弱で、テンソルごとに単一のサイトインデックスを持つMPSにのみ機能しました。ITensors 0.3 以降は非推奨となりました。ITensors 0.3 以降は、収束するために入力するMPSまたはMPOが互換性のあるサイトインデックスを持っていることを確認する必要があります。たとえば、プライムレベルが適切に一致するようにすることです。

[`dot`](@ref) と同じです。
