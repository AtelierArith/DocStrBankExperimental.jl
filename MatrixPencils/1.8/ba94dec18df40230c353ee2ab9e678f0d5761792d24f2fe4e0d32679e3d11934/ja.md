```
 klf_right_refine!(ν, μ, M, N, tol; fast = true, ut = false, roff = 0, coff = 0, rtrail = 0, ctrail = 0, withQ = true, withZ = true) -> (νr, μr, νi)
```

分割された行列ペンシル `M - λN` を次のように減少させます（`*` は関連しないサブペンシルを示します）

```
         [   *         *        *  ] roff
M - λN = [   0      Mri-λNri    *  ] mri
         [   0         0        *  ] rtrail
           coff      nri     ctrail
```

等価な形 `F - λG = Q1'*(M - λN)*Z1` に変換します。ここで、直交またはユニタリ変換行列 `Q1` と `Z1` を使用し、完全行ランクのサブペンシル `Mri-λNri` を次のようなクロンネッカー様式に変換します。この形式は右側と無限のクロンネッカー構造を示します：

```
              |  Mr-λNr    |     *      |
 Fri - λGri = |------------|------------|
              |    O       |   Mi-λNi   |
```

完全行ランクのペンシル `Mri-λNri` は階段形式であり、`nb` 次元のベクトル `ν` と `μ` は階段形式 `Mri-λNri` のブロックの行および列の次元を含みます。ここで、`i` 番目のブロックは次元 `ν[i] x μ[i]` を持ち、完全行ランクです。行列 Mri は完全行ランクを持ち、`Nri` のトレーリング列 `μ[2]+...+μ[nb]` は完全列ランクのサブマトリックスを形成します。

完全行ランクのペンシル `Mr-λNr` は階段形式であり、ペンシル `M-λN` の右クロンネッカーインデックスを含み、次の形式を持ちます：

```
  Mr-λNr  = | Br | Ar-λEr |,
```

ここで `Er` は上三角で非特異です。`nr` 次元のベクトル `νr` と `μr` は階段形式 `Mr-λNr` のブロックの行および列の次元を含みます。ここで、`i` 番目のブロックは次元 `νr[i] x μr[i]` を持ち、完全行ランクです。差 `μr[i]-νr[i] = μ[i]-ν[i]` （`i = 1, 2, ..., nr` の場合）は、サイズ `(i-1) x i` の基本クロンネッカーブロックの数です。`ut = true` の場合、`Mr` の完全行ランクの対角ブロックは `[0 X]` の形式に減少し、ここで `X` は上三角で非特異です。また、`Nr` の完全列ランクの超対角ブロックは `[Y; 0]` の形式に減少し、ここで `Y` は上三角で非特異です。

正則ペンシル `Mi-λNi` は階段形式であり、`Mri-λNri` の無限基本因子を含み、`Mi` は `ut = true` の場合上三角で非特異であり、`Ni` は上三角でニルポテントです。`ni` 次元のベクトル `νi` は階段形式 `Mi-λNi` の正方形対角ブロックの次元を含み、ここで `i` 番目のブロックは次元 `νi[i] x νi[i]` を持ちます。差 `νi[ni-i+1]-νi[ni-i] = ν[i]-μ[i+1]` （`i = 1, 2, ..., ni` の場合）は、次数 `i` の無限基本因子の数です（`νi[0] = 0` および `μ[nb+1] = 0`）。

`F` と `G` はそれぞれ `M` と `N` に返されます。

実行された左の直交またはユニタリ変換は、`withQ = true` の場合に行列 `Q` に蓄積されます（すなわち、`Q <- Q*Q1`）。そうでない場合、`Q` は変更されません。実行された右の直交またはユニタリ変換は、`withZ = true` の場合に行列 `Z` に蓄積されます（すなわち、`Z <- Z*Z1`）。そうでない場合、`Z` は変更されません。
