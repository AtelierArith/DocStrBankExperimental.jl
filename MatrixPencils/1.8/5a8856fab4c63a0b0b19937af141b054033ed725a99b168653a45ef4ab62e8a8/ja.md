```
preduceBF(M, N; fast = true, atol = 0, rtol, withQ = true, withZ = true) -> (F, G, Q, Z, n, m, p)
```

行列ペンシル `M - λN` を同等の形 `F - λG = Q'*(M - λN)*Z` に縮約します。ここで、直交またはユニタリ変換行列 `Q` と `Z` を使用し、ペンシル `M - λN` を以下の標準形に変換します。

```
               | B  | A-λE | 
      F - λG = |----|------| ,        
               | D  |  C   |
```

ここで、`E` は `nxn` の非特異行列であり、`A`、`B`、`C`、`D` はそれぞれ `nxn`、`nxm`、`pxn`、`pxm` 次元の行列です。`E` の次数 `n` は、絶対許容誤差 `atol` と相対許容誤差 `rtol` を使用して決定される `N` の数値ランクに等しいです。`M` と `N` はそれぞれ `F` と `G` に上書きされます。

`fast = true` の場合、`E` は `N` の列ピボッティングを伴うランクを明らかにするQR分解を使用して上三角行列として決定され、`n` は `R` 因子の非零対角要素の数として評価されます。その絶対値が `tol = max(atol,abs(R[1,1])*rtol)` より大きい場合です。`fast = false` の場合、`E` は `N` のランクを明らかにするSVD分解を使用して対角行列として決定され、`n` は `tol = max(atol,smax*rtol)` より大きい特異値の数として評価されます。ここで、`smax` は最大特異値です。SVD分解に基づくランクの決定は一般的により信頼性がありますが、関与する計算コストは高くなります。

実行された左の直交またはユニタリ変換は、`withQ = true` の場合、行列 `Q` に蓄積されます。そうでない場合、`Q` は `nothing` に設定されます。実行された右の直交またはユニタリ変換は、`withZ = true` の場合、行列 `Z` に蓄積されます。そうでない場合、`Z` は `nothing` に設定されます。
