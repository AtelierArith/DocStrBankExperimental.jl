```
pbalance!(M, N; r, c, regpar, shift, maxiter, tol, pow2) -> (Dl, Dr)
```

`M - λN` の `m×n` 行列ペンシルを、行列 `T := abs(M)+abs(N)` の 1-ノルムを行と列のバランシングによって減少させることでバランスを取ります。これは、行列 `T` に対して対角行列 `Dl` と `Dr` を適用する類似変換を含み、`Dl*T*Dr` の行と列のノルムをできるだけ近づけることを目的としています。修正された [Sinkhorn–Knopp アルゴリズム](https://en.wikipedia.org/wiki/Sinkhorn%27s_theorem) が [1] で説明されており、`T` をおおよそ二重確率行列に減少させるために使用されます。ターゲットとなる行と列の合計は、キーワード引数 `r = rs` と `c = cs` を使用して指定でき、ここで `rs` と `cs` はそれぞれ望ましい行と列の合計を表す `m-` および `n-` 次元の正のベクトルです（デフォルト: `rs = ones(m)` および `cs = ones(n)`）。

結果として得られる `Dl` と `Dr` は対角スケーリング行列です。キーワード引数 `pow2 = true` が指定されている場合、結果として得られる最適な `Dl` と `Dr` の成分は、それぞれ最も近い整数の2の累乗に置き換えられます。`pow2 = false` の場合、最適な値 `Dl` と `Dr` が返されます。結果として得られる `Dl*M*Dr` と `Dl*N*Dr` は、それぞれ `M` と `N` を上書きします。

非ゼロの正則化パラメータ `α` がキーワード引数 `regpar = α` を介して指定されている場合、正則化に基づくスケーリングが実行されます。`diagreg = true` の場合、バランシングアルゴリズムは拡張対称行列 `[ α^2*I  T; T' α^2*I ]` に対して実行されますが、`diagreg = false`（デフォルト）の場合、バランシングアルゴリズムは行列 `[ (α/m)^2*em*em'  T; T' (α/n)^2*en*en' ]` に対して実行されます。ここで、`em` と `en` はそれぞれ要素が1の `m-` および `n-` 次元のベクトルです。`α = 0` で `shift = γ > 0` が指定されている場合、アルゴリズムはランク1の摂動 `T+γ*em*en` に対して実行されます。

キーワード引数 `tol = τ`（`τ ≤ 1`）は、停止基準に使用される許容誤差を指定します。反復プロセスは、増分スケーリングが単位行列に `tol` 近いときに停止します。

キーワード引数 `maxiter = k` は、バランシングアルゴリズムで許可される最大反復回数 `k` を指定します。

*メソッド:* この関数は、[1] で提案された正則化アプローチを使用し、ゼロ行またはゼロ列を持つ行列を処理するように修正されています。代替のシフトベースの正則化は [2] で提案されています。

[1] F.M.Dopico, M.C.Quintana and P. van Dooren, "Diagonal scalings for the eigenstructure of arbitrary pencils", SIMAX, 43:1213-1237, 2022.

[2] P.A.Knight, The Sinkhorn–Knopp algorithm: Convergence and applications, SIAM J. Matrix Anal. Appl., 30 (2008), pp. 261–275.
