```
pmpoles(P; CF1, fast = false, atol::Real = 0, rtol::Real = atol>0 ? 0 : n*ϵ) -> (val, ip, id)
```

多項式行列 `P(λ)` の有限および無限の極を `val` に、無限の極の重複度を `ip` に、無限の基本除数を `Q(λ) = [P(λ) I; I 0]` の `id` に返します。極構造の計算は、`CF1 = true` の場合は第一伴随形式、`CF1 = false` の場合は第二伴随形式のいずれかで `Q(λ)` の強い線形化を用いて行われます。

`P(λ)` は、`P(λ) = P_1 + λ P_2 + ... + λ**k P_(k+1)` の形の次数 `k` の多項式行列として指定でき、係数行列 `P_i`（`i = 1, ..., k+1`）は3次元行列 `P` に格納され、`P[:,:,i]` には `i` 番目の係数行列 `P_i`（`λ**(i-1)` を掛けたもの）が含まれます。

`P(λ)` は、[Polynomials](https://github.com/JuliaMath/Polynomials.jl) パッケージによって提供される `Polynomial` 型の要素の行列、ベクトル、またはスカラーとしても指定できます。

多項式行列 `P(λ)` の有限および無限の極に関する情報は、基礎となる線形化 `Q(λ)` のクロンカー構造情報から得られ、[1] および [2] の結果を使用します。極の計算は、拡張多項式行列 `Q(λ) = [P(λ) I; I 0]` の伴随形式に基づく線形化 `M-λN` を構築し（[1] を参照）、次にペンシル `M-λN` をそのクロンカー構造に関する情報を示す適切なクロンカー様形式（KLF）に縮約することによって行われます。`Q(λ)` は正則であるため、`M-λN` には左または右のクロンカーインデックスはありません。`P(λ)` の無限の極の重複度は、`M-λN` の無限の固有値の重複度と `P(λ)` の次数の間の正の差として返されます [2]。`val` の有限極の数は `M-λN` の有限固有値の数（`KRInfo.nf` に返される）に等しく、`val` の無限極の数は `ip` の重複度の合計です。`Q(λ)` の無限の固有値の重複度は `id` に返されます。

`M-λN` を KLF に縮約するには、直交類似変換を使用し、列ピボットを伴うランクを明らかにするQR分解に基づくランク決定を含みます。`fast = true` の場合は、より信頼性の高いSVD分解を使用します。効率のために、縮約は部分的にのみ行われ、実行された直交変換を蓄積しません。

キーワード引数 `atol` と `rtol` は、それぞれ `P(λ)` の非ゼロ係数に対する絶対および相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `n` は `P(λ)` の最小次元のサイズ、`ϵ` は `P(λ)` の係数の要素型の機械イプシロンです。

[1] F. De Terán, F. M. Dopico, D. S. Mackey, Spectral equivalence of polynomial matrices and the Index Sum Theorem, Linear Algebra and Its Applications, vol. 459, pp. 264-333, 2014.

[2] A. Varga, On computing the Kronecker structure of polynomial matrices using Julia, June 2020,  [arXiv:2006.06825](https://arxiv.org/pdf/2006.06825).
