```
sklf_rightfin2!(A, E, B, m1, C; fast = true, atol1 = 0, atol2 = 0,  
               rtol, withQ = true, withZ = true) -> (Q, Z, νr, nc, nuc)
```

分割されたフル行ランク行列ペンシルを削減します 

```
  M - λN = [ B | A-λE ] n  = [ B1  B2 | A-λE ] n
             m    n            m1 m-m1   n
```

`A-λE` が正則である場合、同等の形 `F - λG = Q'*(M - λN)*diag(I,Z)` に変換します。ここで、直交またはユニタリ変換行列 `Q` と `Z` を使用して、`M - λN` を階段形式 `[ Bt | At-λEt ]` に変換し、有限固有値の分離を示します：

```
                     [  Bc | Ac-λEc     *    ] nc
  [ Bt | At-λEt ] =  [-----|-----------------]
                     [  0  |  0     Auc-λEuc ] nuc
                        m     nc      nuc
```

`Bt = Q'*B`、`At = Q'*A*Z` および `Et = Q'*E*Z` はそれぞれ `B`、`A` および `E` に返され、`C*Z` は `C` に返されます（`C = missing` でない限り）。結果として得られる `Et` は上三角行列です。もし `E` がすでに上三角行列であれば、`E` を上三角形式に前処理することは行われません。                

サブペンシル `[ Bc | Ac-λEc ]` は、すべての有限値の `λ` に対してフル行ランク `nc` を持ち、`[ Bc | Ac ] = [ Bc1 Bc2 | Ac]` は階段形式で表されます。

```
                    m1  m-m1  νr[1] νr[2] . . .  νr[p-2] 
                  [ B11 B12 | A11   A12   . . .  A1,p-2  A1,p-1  A1p ]  νr[1]
                  [  0  B22 | A21   A22   . . .  A2,p-2  A2,p-1  A2p ]  νr[2]
                  [  0   0  | A31   A32   . . .  A3,p-2  A3,p-1  A3p ]  νr[3]
                  [  0   0  |  0    A42   . . .  A4,p-2  A4,p-1  A4p ]  νr[4]
[ Bc1 Bc2 | Ac] = [  0   0  |  .     .    . . .    .       .      .  ]   .
                  [  0   0  |  .     .      . .    .       .      .  ]   .
                  [  0   0  |  .     .        .    .       .      .  ]   .
                  [  0   0  |  0     0    . . .  Ap,p-2  Ap,p-1  App ]  νr[p]
```

ここで、ブロック `B11`、`B22`、`A31`、...、`Ap,p-2` はフル行ランクを持ちます。次元 `p` のベクトル `νr` は、`p = 2nr` が偶数で、ブロックの行の次元を含みます。差 `νr[2i-1]+νr[2i]-νr[2i+1]-νr[2i+2]` は `i = 1, 2, ..., nr` に対して、サイズ `(i-1) x i` の基本的なクロネッカー ブロックの数です。

`nuc x nuc` サブペンシル `Auc-λEuc` は、`M - λN` の有限固有値を含みます（`A - λE` の制御不能な有限固有値とも呼ばれます）。もし `E` が特異であれば、`Auc-λEuc` は `M - λN` の無限固有値の一部も含む可能性があります（`A - λE` の制御不能な無限固有値とも呼ばれます）。

キーワード引数 `atol1`、`atol2` および `rtol` は、それぞれ `A` の非ゼロ要素の絶対許容誤差、`B` の非ゼロ要素の絶対許容誤差、`A` および `B` の非ゼロ要素の相対許容誤差を指定します。削減は、`fast = true` の場合は列ピボットを伴うランクを明らかにするQR分解に基づくランク決定を使用して行われ、`fast = false` の場合はより信頼性の高いSVD分解が使用されます。

実行された直交またはユニタリ左変換は、`withQ = true` の場合、行列 `Q` に蓄積されます。そうでない場合、`Q` は `nothing` に設定されます。実行された直交またはユニタリ右変換は、`withZ = true` の場合、行列 `Z` に蓄積されます。そうでない場合、`Z` は `nothing` に設定されます。   

メソッド：実装されたアルゴリズム [1] は、入力行列 `B = [B1,B2]` の特別な構造に対する制御可能性階段アルゴリズム [2] の特殊化を表します。

参考文献

[1] Varga, A. 信頼性の高いアルゴリズムによる記述子システムの最小動的カバーの計算。     Proc. of MTNS'04, Leuven, Belgium, 2004.

[2] Varga, A. 縮約不可能な一般化状態空間実現の計算。     Kybernetika, vol. 26, pp. 89-106, 1990. ```
