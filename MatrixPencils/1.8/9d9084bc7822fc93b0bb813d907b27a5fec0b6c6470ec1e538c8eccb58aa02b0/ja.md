```
klf_right_refineut!(ν, μ, M, N, Q, Z; ctrail = 0, withQ = true, withZ = true)
```

分割された行列ペンシル `M - λN` を次のように減少させます（`*` は関連しないサブペンシルを表します）

```
         [ Mri-λNri  *   ] 
M - λN = [    0      *   ] 
                   ctrail
```

等価な形 `F - λG = Q1'*(M - λN)*Z1` に変換します。ここで、直交またはユニタリ変換行列 `Q1` と `Z1` を使用し、完全行ランクのサブペンシル `Mri-λNri` が階段形式に変換されます。`Mri` の完全行ランクの対角ブロックは `[0 X]` の形に減少し、ここで `X` は上三角で非特異です。また、`Nri` の完全列ランクの超対角ブロックは `[Y; 0]` の形に減少し、ここで `Y` は上三角で非特異です。`Mri-λNri` には `nb` の対角ブロックがあり、対角ブロックの次元は `nb` 次元のベクトル `ν` と `μ` によって指定され、`i` 番目のブロックは `ν[i] x μ[i]` の次元を持つと仮定します。

実行された直交またはユニタリ変換は `Q` に蓄積されます（すなわち、`Q <- Q*Q1`）、`withQ = true` の場合、`Z` にも蓄積されます（すなわち、`Z <- Z*Z1`）、`withZ = true` の場合。
