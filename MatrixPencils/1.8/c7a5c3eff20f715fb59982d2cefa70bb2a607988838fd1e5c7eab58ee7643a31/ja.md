```
sfisplit(A, E, B, C; fast = true, finite_infinite = false, atol1 = 0, atol2 = 0, rtol, withQ = true, withZ = true) -> (At, Et, Bt, Ct, Q, Z, ν, blkdims)
```

正則行列ペンシル `A - λE` を、直交またはユニタリ変換行列 `Q` と `Z` を使用して、同等の形 `At - λEt = Q'*(A - λE)*Z` に還元します。変換された行列 `At` と `Et` は、次のいずれかのブロック上三角形の形になります。

(1) `finite_infinite = true` の場合、

```
               | Ai1    *        *     |
    At - λEt = | O    Af-λEf     *     |
               | O      0     Ai2-λEi2 |
```

ここで、`ni1 x ni1` の上三角非特異行列 `Ai1` と、無限の基本因子を含む `ni2 x ni2` のサブペンシル `Ai2-λEi2`、および `nf x nf` のサブペンシル `Af-λEf`（`Ef` は非特異で上三角）は、ペンシル `A-λE` の有限固有値を含みます。

サブペンシル `Ai2-λEi2` は階段形式であり、`Ai2` は非特異で上三角、`Ei2` は nilpotent で上三角です。`nb` 次元のベクトル `ν` は、階段形式 `Ai2-λEi2` の対角ブロックの次元を含み、`i` 番目のブロックは次元 `ν[i] x ν[i]` を持ちます。`ν[nb-j+2]-ν[nb-j+1]` の差は、次数 `j` の無限基本因子の数です（`ν[0] := 0` および `ν[nb+1] := ni1`）。

対角ブロックの次元は `blkdims = (ni1, nf, ni2)` に返されます。

(2) `finite_infinite = false` の場合、

```
               | Ai1-λEi1    *      *  |
    At - λEt = | O         Af-λEf   *  |
               | O           0     Ai2 |
```

ここで、`ni1 x ni1` のサブペンシル `Ai1-λEi1` と上三角非特異行列 `Ai2` は無限の基本因子を含み、`nf x nf` のサブペンシル `Af-λEf`（`Ef` は非特異で上三角）は、ペンシル `A-λE` の有限固有値を含みます。

サブペンシル `Ai1-λEi1` は階段形式であり、`Ai1` は非特異で上三角、`Ei1` は nilpotent で上三角です。`nb` 次元のベクトル `ν` は、階段形式 `Ai1-λEi1` の対角ブロックの次元を含み、`i` 番目のブロックは次元 `ν[i] x ν[i]` を持ちます。`ν[i]-ν[i+1]` の差は、次数 `i` の無限基本因子の数です（`ν[nb+1] = 0` および `ν[0] = ni2`）。

対角ブロックの次元は `blkdims = (ni1, nf, ni2)` に返されます。

キーワード引数 `atol1`、`atol2`、および `rtol` は、それぞれ、`A` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、および `A` と `E` の非ゼロ要素の相対許容誤差を指定します。

還元は、`fast = true` の場合は列ピボットを伴うランクを明らかにする QR 分解に基づくランク決定を使用して、また `fast = false` の場合はより信頼性の高い SVD 分解を使用して行われます。

左の直交またはユニタリ変換は、`withQ = true` の場合に行列 `Q` に蓄積されます。そうでない場合、`Q` は `nothing` に設定されます。右の直交またはユニタリ変換は、`withZ = true` の場合に行列 `Z` に蓄積されます。そうでない場合、`Z` は `nothing` に設定されます。

`Bt = Q'*B` ですが、`B = missing` の場合は `Bt = missing` が返され、`Ct = C*Z` ですが、`C = missing` の場合は `Ct = missing` が返されます。              
