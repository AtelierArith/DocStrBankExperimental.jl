```
 lsequal(A1, E1, B1, C1, D1, A2, E2, B2, C2, D2; 
         fastrank = true, atol1 = 0, atol2 = 0, rtol = min(atol1,atol2)>0 ? 0 : n*ϵ) -> flag::Bool
```

2つの記述子システムの線形化 `(A1-λE1,B1,C1,D1)` と `(A2-λE2,B2,C2,D2)` が同値条件を満たすかどうかを確認します  

```
            -1                      -1
 C1*(λE1-A1)  *B1 + D1 = C2*(λE2-A2)  *B2 + D2
```

チェックは、構造化行列ペンシル `M - λN` の通常のランク `n` を計算することによって行われます。

```
          | A1-λE1   0    |   B1  | 
          |   0    A2-λE2 |   B2  | 
 M - λN = |---------------|-------|
          |   C1     -C2  | D1-D2 |
```

そして `n = n1+n2` を確認します。ここで `n1` と `n2` はそれぞれの正方行列 `A1` と `A2` の次数です。

`fastrank = true` の場合、ランクは `M - γ N` の特異値のうち、`max(max(atol1,atol2), rtol*σ₁)` より大きいものの数を数えることによって評価されます。ここで `σ₁` は `M - γ N` の最大特異値であり、`γ` はランダムに生成された値です [1]。 `fastrank = false` の場合、ランクは `nr + ni + nf + nl` として評価されます。ここで `nr` と `nl` はそれぞれ右および左のクロンカー指数の合計であり、`ni` と `nf` はそれぞれ無限および有限の固有値の数です。合計 `nr+ni` と `nf+nl` は、ペンシル `M - λN` の右および左の構造の分割を示す適切なクロンカー様形式 (KLF) から決定されます。効率のために、関連する KLF への削減は、ランクを明らかにする SVD 分解に基づくランク決定を使用して部分的にのみ行われます。

キーワード引数 `atol1`、`atol2`、および `rtol` は、それぞれ `M` の非ゼロ要素の絶対許容誤差、`N` の非ゼロ要素の絶対許容誤差、および `M` と `N` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `k*ϵ` であり、ここで `k` は `M` の最小次元のサイズ、`ϵ` は `M` の要素型のマシンイプシロンです。

[1] A. Varga, On checking null rank conditions of rational matrices, [arXiv:1812.11396](https://arxiv.org/abs/1812.11396), 2018. ```
