```
sreduceBF(A, E, B, C, D; fast = true, atol = 0, rtol, withQ = true, withZ = true) -> F, G, Q, Z, n, m, p
```

分割行列ペンシル `M - λN` を削減します。

```
           | A-λE | B | ndx
  M - λN = |------|---|
           |  C   | D | ny
              nx    nu
```

等価な基本形式 `F - λG = Q'*(M - λN)*Z` に変換します。ここで、直交変換行列 `Q` と `Z` を使用して、`M - λN` を以下の標準形式に変換します。

```
           | B1 | A1-λE1 | n
  F - λG = |----|--------|   ,        
           | D1 |   C1   | p
             m      n
```

ここで、`E1` は `nxn` の非特異行列であり、`A1`、`B1`、`C1`、`D1` はそれぞれ `nxn`、`nxm`、`pxn`、`pxm` 次元の行列です。`E1` の順序 `n` は、絶対許容誤差 `atol` と相対許容誤差 `rtol` を使用して決定された `E` の数値ランクに等しいです。次元 `m` と `p` は `m = nu + (nx-n)` および `p = ny + (ndx-n)` として計算されます。

`fast = true` の場合、`E1` は `E` の列ピボッティングを伴うランクを明らかにするQR分解を使用して上三角行列として決定され、`n` はR因子の非零対角要素の数として評価されます。その絶対値は `tol = max(atol,abs(R[1,1])*rtol)` より大きいです。`fast = false` の場合、`E1` は `E` のランクを明らかにするSVD分解を使用して対角行列として決定され、`n` は `tol = max(atol,smax*rtol)` より大きい特異値の数として評価されます。ここで、`smax` は最大特異値です。SVD分解に基づくランクの決定は一般的により信頼性がありますが、関与する計算努力は高くなります。

左側の直交またはユニタリ変換は、`withQ = true` の場合に行列 `Q` に蓄積されます。そうでない場合、`Q` は `nothing` に設定されます。右側の直交またはユニタリ変換は、`withZ = true` の場合に行列 `Z` に蓄積されます。そうでない場合、`Z` は `nothing` に設定されます。
