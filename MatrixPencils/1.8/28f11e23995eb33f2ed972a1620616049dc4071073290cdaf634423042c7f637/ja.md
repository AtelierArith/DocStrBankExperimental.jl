```
sklf_right2!(A, B, m1, C; fast = true, atol1 = 0, atol2 = 0, rtol, withQ = true) -> (Q, νr, nc, nuc)
```

分割されたフル行ランク行列ペンシルを減少させます 

```
  M - λN = [ B | A-λI ] n  = [ B1  B2 | A-λI ] n
             m    n            m1 m-m1   n
```

を同等の形 `F - λG = Q'*(M - λN)*diag(I,Q)` に変換します。ここで、直交またはユニタリ変換行列 `Q` を使用して、`M - λN` を右側および有限のクロンネッカー構造（制御可能性階段形式とも呼ばれる）を示すクロンネッカーのような形 `[ Bt | At-λI ]` に変換します：

```
                    [  Bc | Ac-λI     *    ] nc
  [ Bt | At-λI ] =  [-----|----------------]
                    [  0  |  0     Auc-λI  ] nuc
                       m     nc      nuc
```

`Bt = Q'*B` および `At = Q'*A*Q` はそれぞれ `B` と `A` に返され、`C*Q` は `C` に返されます（`C = missing` の場合を除く）。                 

サブペンシル `[ Bc | Ac-λI ]` はフル行ランク `nc` を持ち、階段形式で `[ Bc | Ac ] = [ Bc1 Bc2 | Ac]` になります。

```
                    m1  m-m1  νr[1] νr[2] . . .  νr[p-2] 
                  [ B11 B12 | A11   A12   . . .  A1,p-2  A1,p-1  A1p ]  νr[1]
                  [  0  B22 | A21   A22   . . .  A2,p-2  A2,p-1  A2p ]  νr[2]
                  [  0   0  | A31   A32   . . .  A3,p-2  A3,p-1  A3p ]  νr[3]
                  [  0   0  |  0    A42   . . .  A4,p-2  A4,p-1  A4p ]  νr[4]
[ Bc1 Bc2 | Ac] = [  0   0  |  .     .    . . .    .       .      .  ]   .
                  [  0   0  |  .     .      . .    .       .      .  ]   .
                  [  0   0  |  .     .        .    .       .      .  ]   .
                  [  0   0  |  0     0    . . .  Ap,p-2  Ap,p-1  App ]  νr[p]
```

ここで、ブロック `B11`, `B22`, `A31`, ..., `Ap,p-2` はフル行ランクを持ちます。次元 `p` のベクトル `νr` は、`p = 2nr` が偶数であるとき、ブロックの行の次元を含みます。差 `νr[2i-1]+νr[2i]-νr[2i+1]-νr[2i+2]` は `i = 1, 2, ..., nr` のとき、サイズ `(i-1) x i` の基本クロンネッカーブロックの数です。

`nuc x nuc` 行列 `Auc` には、`M - λN` の（有限の）固有値が含まれています（`A` の制御不能な固有値とも呼ばれます）。  

キーワード引数 `atol1`, `atol2`, および `rtol` は、それぞれ `A` の非ゼロ要素の絶対許容誤差、`B` の非ゼロ要素の絶対許容誤差、および `A` と `B` の非ゼロ要素の相対許容誤差を指定します。減少は、`fast = true` の場合は列ピボッティングを伴うランクを明らかにするQR分解に基づくランク決定を使用して、`fast = false` の場合はより信頼性の高いSVD分解を使用して行われます。

実行された直交またはユニタリ変換は、`withQ = true` の場合、行列 `Q` に蓄積されます。そうでない場合、`Q` は `nothing` に設定されます。  

メソッド：実装されたアルゴリズム [1] は、入力行列 `B = [B1,B2]` の特別な構造に対する制御可能性階段アルゴリズム [2] の特殊化を表します。

参考文献：

[1] Varga, A. 信頼性の高い動的カバーを計算するためのアルゴリズム。Proc. CDC'2003, Hawaii, 2003.

[2] Varga, A. 標準制御可能形式の決定のための数値的に安定したアルゴリズム。エレクトロニクスレター、vol. 17, pp. 74-75, 1981. ```
