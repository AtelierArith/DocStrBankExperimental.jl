```
exit_entry_times(ds::DynamicalSystem, u₀, εs, T; kwargs...) → exits, entries
```

`u₀`を中心とし、半径`εs`のボールまたはボックスの出口および入場時間を収集し、与えられた動的システムの状態空間でのものです。出口および（再）入場の戻り時間をセットに返します。これらはそれぞれの`ε`半径セットのために収集されたすべての時間を含むベクトルです。動的システムは合計時間`T`まで進化します。

`transit_return_times(exits, entries)`を使用して出力を通過および戻り時間に変換し、[`mean_return_times`](@ref)も参照してください。

キーワード`show_progress`は進行状況バーを表示します。これは、離散システムの場合は`false`、連続システムの場合はデフォルトで`true`です。

## 説明

通過および戻り時間の統計は、動的システムの輸送特性にとって重要であり[^Meiss1997]、カオス的セットのフラクタル次元と関連付けることができます[^Boev2014]。

現在のアルゴリズムは、状態`u₀`を中心とした状態空間内の指定されたセットへの出口および再入場時間を収集します。**システムの進化は常に`u₀`から始まります**。したがって、`ds`の初期状態は無関係です。`εs`は常に`Vector`です。

### 戻るセットの指定

`εs`の各エントリが実数である場合、`u₀`の周りのセットは半径`ε ∈ εs`のネストされたハイパー球です。`εs`の各エントリがベクトル自体である場合、セットはハイパー長方形（ボックス）にもなります。この場合、`i`番目のボックスは`u0 .± εs[i]`でカバーされる空間によって定義されます（したがって、実際のボックスサイズは`2εs[i]`です！）。将来的には、状態空間のセットはより便利に指定され、`u₀, εs`の代わりに単一の引数`sets`が与えられます。

複数の`εs`を一度に入力する理由は、パフォーマンスの最適化のためです（各`ε`を個別に処理するよりもはるかに速いです）。

### 離散時間システム

離散システムの場合、出口時間はセットから出た直後に記録され、再入場は再入場直後に記録されます。これは、軌道がセットを離れるのに1ステップ必要で、次のステップで直ちに再入場する場合、戻り時間は1であることを意味します。

### 連続時間システム

連続システムの場合、補間をサポートするステップ可能な積分器が使用されます。出口および入場時間を推定する方法は、キーワード`crossing_method`を介して指定され、その値は次のようになります。

1. `CrossingLinearIntersection()`: 積分器のステップ間で線形補間が使用され、線と球の間の交差を使用して交差時間を見つけます。
2. `CrossingAccurateInterpolation(; abstol=1e-12, reltol=1e-6)`: 積分器のステップ間で非常に高精度の高次補間が使用されます。最初に、Optim.jlを使用して軌道とセット中心との最小距離を見つける最適化が行われます。次に、Roots.jlを使用して正確な交差点を見つけます。許容誤差は両方の手続きに与えられます。

明らかに、`CrossingAccurateInterpolation`は`CrossingLinearIntersection`よりもはるかに正確ですが、同時にはるかに遅いです。ただし、積分器が取るステップが小さくなるほど（非常に高精度のソルバーが使用される場合）、線形交差は正確なバージョンに近づきます。アルゴリズムが適用される特定のケースに対してベンチマークを行うことが推奨され、最適な方法を選択するために役立ちます。

キーワード`threshold_distance = Inf`は、積分器の現在の状態がセット中心から遠すぎる場合に補間チェックをスキップする手段を提供します。積分器の現在の状態の距離が`threshold_distance`以上でセット中心から離れている場合、補間を試みることはスキップされます。デフォルトでは`threshold_distance = Inf`であり、したがってこれは決して発生しません。通常、これは軌道が平均的な積分器ステップでカバーする距離の10〜100倍であることが望ましいです。

[^Meiss1997]: Meiss, J. D. *体積保存マップの平均出口時間*, [Chaos (1997)](https://doi.org/10.1063/1.166245)

[^Boev2014]: Boev, Vadivasova, & Anishchenko, *カオス同期の指標としてのポアンカレ再発統計*, [Chaos (2014)](https://doi.org/10.1063/1.4873721)
