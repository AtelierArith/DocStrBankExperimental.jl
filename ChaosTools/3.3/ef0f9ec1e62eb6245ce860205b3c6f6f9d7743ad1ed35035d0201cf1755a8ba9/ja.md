```
expansionentropy(ds::DynamicalSystem, sampler, isinside; kwargs...)
```

`ds`の拡張エントロピー[^Hunt2015]を、制約領域$S$内で計算します。これは、曲線$\log E_{t0+T, t0}(f, S)$と$T$の間の傾きを（線形回帰を通じて）推定することによって行われます（[`linear_region`](@ref)を使用）。これは、[^Hunt2015]に従った拡張エントロピー$H_0$の近似です。$T$、$\log E$、および計算された傾きを返します。

`sampler`は、`ds`のランダムな初期条件を生成する0引数の関数であり、`isinside`は、状態を与えられたときにその状態が制約領域内にある場合はtrueを返す1引数の関数です。通常、`sampler`と`isinside`は[`statespace_sampler`](@ref)の出力です。

## キーワード引数

  * `N = 1000`: 各バッチで取得されるサンプルの数（[^Hunt2015]の$N$と同じ）。
  * `steps = 40`: システムが実行される最大ステップ数。
  * `batches = 100`: 計算を実行するバッチの数、以下を参照。
  * `Δt = 1`: 時間発展のステップサイズ。
  * `J = nothing`: [`TangentDynamicalSystem`](@ref)に与えられるヤコビアン関数。

## 説明

`N`サンプルが初期化され、時間の前方に伝播されます（その接空間とともに）。各時間$t$において、`[t0+Δt, t0+2Δt, ..., t0+steps*Δt]`の範囲内で$H$を計算します：

$$
H[t] = \log E_{t0+T, t0}(f, S),
$$

ここで

$$
E_{t0+T, t0}(f, S) = \frac 1 N \sum_{i'} G(Df_{t0+t, t0}(x_i))
$$

（[^Hunt2015]と同じ表記を使用）。原則として、$E$は初期条件によってサンプリングされた制約領域内での最大の成長比率の平均です。総和は、ブール関数`isinside`によって定義された領域$S$内に留まる$x_i$のみに対して行われます。このプロセスは、`ChaosTools.expansionentropy_sample`関数によって行われます。

次に、これは[^Hunt2015]で推奨されているように、`batches`回数繰り返されます。これらのバッチから、各時間点での$H$の平均と標準偏差が計算されます。これは[`expansionentropy_batch`](@ref)関数によって行われます。$t$に対してプロットされると、これらは例えば[1]の図2、3の曲線と誤差バーを作成します。

この関数`expansionentropy`は、$H$と$t$の曲線の最大の線形領域の傾きを単純に返します。これは拡張エントロピー$H_0$の近似です。したがって、[`expansionentropy_batch`](@ref)を直接使用し、結果を自分で評価することを*推奨*します。このステップは、非カオス的なシステム（$H$が0の周りで強く変動する場合）に対して不正確であることが知られています。

[^Hunt2015]: Hunt & Ott, ‘Defining Chaos’, [Chaos 25.9 (2015)](https://doi.org/10/gdtkcf)

```
