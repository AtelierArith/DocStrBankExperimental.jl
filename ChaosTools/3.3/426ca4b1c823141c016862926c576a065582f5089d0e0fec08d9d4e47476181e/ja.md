```
lyapunov(ds::DynamicalSystem, Τ; kwargs...) -> λ
```

最大リャプノフ指数 `λ` を、ベネッティンによる方法 [^Benettin1976] を使用して計算します。この方法は、隣接する2つの軌道（1つは「与えられた」、もう1つは「テスト」）を進化させながら、テスト軌道を常に再スケーリングします。

`T` は進化の総時間を示します（離散時間システムの場合は `Int` である必要があります）。

[`lyapunovspectrum`](@ref) や [`local_growth_rates`](@ref) も参照してください。

## キーワード引数

  * `show_progress = false`: プロセスの進行状況を表示するプログレスバー。
  * `u0 = initial_state(ds)`: 初期条件。
  * `Ttr = 0`: 指数を測定する前に軌道を進化させるための追加の「過渡」時間。離散システムの場合は `Int` である必要があります。
  * `d0 = 1e-9`: 2つの隣接する軌道間の初期および再スケーリング距離。
  * `d0_lower = 1e-3*d0`: 再スケーリングのための下限距離閾値。
  * `d0_upper = 1e+3*d0`: 再スケーリングのための上限距離閾値。
  * `Δt = 1`: 距離の再スケーリングをチェックする間の進化時間。
  * `inittest = (u1, d0) -> u1 .+ d0/sqrt(length(u1))`: `(u1, d0)` を与えられたときに、与えられた状態 `u1` から距離 `d0` でテスト状態を初期化する関数です（`D` はシステムの次元です）。この関数は、テスト状態が異なるエネルギーを持つか無限大に逃げるような位相空間の領域に現れるのを避けたいときに使用できます。

## 説明

初期距離 `d0` を持つ2つの隣接する軌道が時間とともに進化します。時間 $t_i = t_{i-1} + \Delta t$ において、もしその距離 $d(t_i)$ が `d0_upper` を超えるか、`d0_lower` よりも低い場合、テスト軌道は参照軌道から距離 `d0` を持つように再スケーリングされます。この再スケーリングは、最大の拡張/収縮方向に沿った差ベクトルを保持します: $u_2 \to u_1+(u_2−u_1)/(d(t_i)/d_0)$。

最大リャプノフ指数は、時間局所リャプノフ指数の平均です。

$$
\lambda = \frac{1}{t_{n} - t_0}\sum_{i=1}^{n}
\ln\left( a_i \right),\quad a_i = \frac{d(t_{i})}{d_0}.
$$

## パフォーマンスノート

この関数は単に [`ParallelDynamicalSystem`](@ref) を初期化し、以下のメソッドを呼び出します。

隣接する軌道を条件付きで再スケーリングする理由は計算上のものであり、軌道が決して発散または収束しない場合（すなわち、周期軌道の場合）には、平均化が全体として正しい結果を与えます。

[^Benettin1976]: G. Benettin *et al.*, Phys. Rev. A **14**, pp 2338 (1976)

```
