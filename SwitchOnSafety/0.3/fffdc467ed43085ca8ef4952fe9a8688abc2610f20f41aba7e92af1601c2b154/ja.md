システム `s` の不変バランス多面体を、スペクトル最大化積候補 (s.m.p.) `smp` を用いた [GP13] のアルゴリズムで計算します。複素バランス多面体、実バランス多面体、または正の直交体の不変性に基づいて自動的に選択されます。使用されるソルバーは `optimizer_constructor` です。このソルバーは、複素バランス多面体が使用される場合（例えば、主固有値に虚部がある場合）に二次円錐をサポートする必要があります。考慮される最大深さは `max_length` であり、点 `x` は、最大の `λ` が `λ * x` が多面体に含まれる場合、`1 + tol` より大きいときに多面体の内部にあると見なされます。

新しい s.m.p. 候補は、許容誤差 `new_candidate_tol` で考慮されます。現在の s.m.p. 候補の最大 `max_cycles` 回がこの新しい候補の前に追加され、現在のものよりも成長率が高い候補を見つけることを試みます。また、長さが `max_smp_length` に達した場合はサイクルの追加を停止します。もし `gready` が真であれば、成長率が現在の s.m.p. よりも高い場合でもサイクルは追加され続け、新しいサイクルを追加する際に成長率が減少するまで続きます。

`verbose` が 1 の場合、深さが `log_step_length` の倍数のときに葉の数が印刷されます。

[GP13] N. Guglielmi and V. Protasov. *線形演算子の共同スペクトル特性の正確な計算*. 計算数学の基礎 13.1, **2013**, 37-97.
