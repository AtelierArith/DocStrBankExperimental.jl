```
h!(h, pnsystem; ℓₘᵢₙ=0, ℓₘₐₓ=typemax(Int))
mode_weights!(h, pnsystem; ℓₘᵢₙ=0, ℓₘₐₓ=typemax(Int))
```

`pn` システムから放出される重力波のモード重みを計算し、`h` をその場で修正します。

!!! note
    これは低レベルの関数ですので、直接使用することはお勧めしません。 よりユーザーフレンドリーな関数については [`coorbital_waveform`](@ref) または [`inertial_waveform`](@ref) を参照してください。


これらのモードは「共軌道」フレームで計算されており、その中で大きな物体は正の $x$ 軸上にあり、小さな物体は負の $x$ 軸上にあり、瞬時の角速度は正の $z$ 方向にあります。

モードは、$ℓ$ が増加する順序と $m$ が増加する順序で `h` に格納されており、$m$ は最も速く反復され、最高の利用可能なモード $(8,8)$ まで続きます。

重力波はスピン重み -2 を持つため、$(ℓ,m)=(0,0)$、$(1,-1)$、$(1,0)$、および $(1,1)$ モードは常に 0 です。 デフォルトでは、これらのモードが `h` に含まれていると仮定します。 そうでない場合は、出力データに存在すべき最小の $ℓ$ 値に `ℓₘᵢₙ` を設定してください — `ℓₘᵢₙ=2` が最も合理的な代替案です。

これらの結果は、[Boyle et al. (2014)](https://arxiv.org/abs/1409.4431) の式 (A5) から最も直接的に得られますが、2PN スピン-スピン項の誤差を除き、これらのケースでは $\nu/2$ で乗算し、$S_1 \mapsto S_0^+$ および $S_2 \mapsto S_0^-$ という置換を行う必要があります。 それに対して、これらの表現は以下から合成されています： 非スピン項は [Blanchet (2014)](https://doi.org/10.12942/lrr-2014-2) から取得されますが、(2,±2) モードの最高 pN 項は [Blanchet et al. (2023)](https://arxiv.org/abs/2304.11186) から取得され、$m=0$ モードは [Favata (2008)](https://arxiv.org/abs/0812.0069) から取得されます。 1PN スピン-軌道項は [Kidder (1995)](https://link.aps.org/doi/10.1103/PhysRevD.52.821) の式 (3.22d) から得られます。 1.5PN スピン-軌道項は Kidder (1995) の式 (3.22f) および [Will and Wiseman (1996)](https://link.aps.org/doi/10.1103/PhysRevD.54.4813) の式 (F15b) から得られます。 2PN スピン-軌道項は [Buonanno, Faye, Hinderer (2013)](https://link.aps.org/doi/10.1103/PhysRevD.87.044009) の式 (4.13) から得られますが、2PN スピン-スピン項はその参考文献の式 (4.15) から得られます。 ```
