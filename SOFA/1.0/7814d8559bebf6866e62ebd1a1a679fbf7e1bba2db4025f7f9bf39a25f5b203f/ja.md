観測者の地心位置と速度が知られている場合、ICRSとGCRS間の変換のための星独立の天文学パラメータを準備します。地球のエフェメリスは呼び出し元によって提供されます。

この関数によって生成されるパラメータは、天文学的変換チェーンの空間運動、視差、光の屈折およびアベレーションの部分で必要です。

この関数は国際天文学連合のSOFA（基礎天文学の標準）ソフトウェアコレクションの一部です。

ステータス：サポート関数。

与えられたもの： date1  double       TDBとしての2部...    date2  double       ...ユリウス日（注1）    pv     double[2][3] 観測者の地心位置/速度（m, m/s）    ebpv   double[2][3] 地球重心PV（au, au/day）    ehp    double[3]    地球太陽中心P（au）

返されるもの：    astrom iauASTROM*   星独立の天文学パラメータ：       pmt    double       PM時間間隔（SSB、ユリウス年）       eb     double[3]    SSBから観測者へのベクトル（au）       eh     double[3]    太陽から観測者への単位ベクトル       em     double       太陽から観測者までの距離（au）       v      double[3]    重心観測者速度（ベクトル、c）       bm1    double       sqrt(1-|v|^2)：ローレンツ因子の逆数       bpn    double[3][3] バイアス-歳差- nutation行列       along  double       変更なし       xpl    double       変更なし       ypl    double       変更なし       sphi   double       変更なし       cphi   double       変更なし       diurab double       変更なし       eral   double       変更なし       refa   double       変更なし       refb   double       変更なし

注：

1. TDB日付 date1+date2 はユリウス日であり、2つの引数の間で任意の便利な方法で分配されます。例えば、    JD(TDB)=2450123.7 は以下のいずれかの方法で表現できます：

```
     date1          date2

  2450123.7           0.0       （JD法）
  2451545.0       -1421.3       （J2000法）
  2400000.5       50123.2       （MJD法）
  2450123.5           0.2       （日付と時間法）
```

JD法は、いくつかの小数点以下の桁数の解像度の損失が許容される場合に最も自然で便利です。J2000法は、引数が内部で処理される方法に最も適しており、最適な解像度を提供します。MJD法と日付と時間法は、解像度と便利さの間の良い妥協です。この関数のほとんどのアプリケーションでは、選択は全く重要ではありません。

TTは、精度に大きな影響を与えることなくTDBの代わりに使用できます。

2. すべてのベクトルはBCRS軸に対してです。
3. （i）観測者の地心位置と速度、および（ii）地球のエフェメリスのために別々の引数を提供するのは、地心、地上、および地球軌道の場合の便利さのためです。深宇宙のアプリケーションでは、地心位置と速度をゼロに指定し、観測者の位置と速度情報を地球に対してではなく直接提供する方が便利な場合があります。ただし、異なる単位に注意してください：地心ベクトルにはmおよびm/s、太陽中心および重心ベクトルにはauおよびau/dayが使用されます。
4. 呼び出し元が地球のエフェメリスを提供したくない場合、関数 iauApcs13 を現在の関数の代わりに使用できます。これは、SOFA関数 iauEpv00 を使用して地球のエフェメリスを計算します。
5. これは、ICRS <-> GCRS <-> CIRS <-> 観測の天文学的変換チェーンに必要な星独立のパラメータをastrom構造に挿入するいくつかの関数の1つです。

さまざまな関数は、異なるクラスの観測者と変換チェーンの部分をサポートします：

```
     関数             観測者        変換

  iauApcg iauApcg13    地心      ICRS <-> GCRS
  iauApci iauApci13    地上      ICRS <-> CIRS
  iauApco iauApco13    地上      ICRS <-> 観測
  iauApcs iauApcs13    宇宙      ICRS <-> GCRS
  iauAper iauAper13    地上      地球の回転を更新
  iauApio iauApio13    地上      CIRS <-> 観測
```

「13」で終わる名前のものは、さまざまなエフェメリスを計算するために現代のSOFAモデルを使用します。他のものは、呼び出し元によって提供されたエフェメリスを受け入れます。

ICRSからGCRSへの変換は、空間運動、視差、光の屈折、およびアベレーションをカバーします。GCRSからCIRSへの変換は、フレームバイアスと歳差- nutationを含みます。CIRSから観測への変換は、地球の回転、極運動、日周アベレーションおよび視差（ICRS <-> GCRS変換に組み込まれていない限り）、および大気屈折を考慮します。

6. この関数によって生成されたコンテキスト構造astromは、iauAtciq*およびiauAticq*によって使用されます。

呼び出し：    iauCp        pベクトルをコピー    iauPm        pベクトルの大きさ    iauPn        pベクトルを大きさと方向に分解    iauIr        r行列を単位行列に初期化

この改訂：   2017年3月16日

SOFAリリース 2018-01-30

著作権 (C) 2018 IAU SOFA理事会。 末尾の注釈を参照してください。
