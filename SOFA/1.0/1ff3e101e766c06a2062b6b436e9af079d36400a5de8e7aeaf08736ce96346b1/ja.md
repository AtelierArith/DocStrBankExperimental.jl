水平面から赤道座標への変換：方位角と高度を時角と赤緯に変換します。

与えられたもの： az       double       方位角    el       double       高度（非公式には、標高）    phi      double       観測地点の緯度

返されるもの： ha       double       時角（ローカル）    dec      double       赤緯

注意事項：

1. すべての引数はラジアンでの角度です。
2. 方位角の符号規則は、北がゼロ、東が +pi/2 です。
3. HA は +/-pi の範囲で返されます。赤緯は +/-pi/2 の範囲で返されます。
4. 緯度 phi は、地球の回転軸と採用された天頂との間の角度を引いた pi/2 です。多くのアプリケーションでは、観測地点の公表された測地緯度を使用するだけで十分です。非常に精密な（サブアークセカンド）アプリケーションでは、phi を極運動に対して補正することができます。
5. 方位角 az は、ITRS 極ではなく、回転北極に対してでなければならず、地球の表面の地図上の北に対する方位角は、サブアークセカンドの精度が要求される場合、極運動に対して調整する必要があります。
6. ユーザーが測地的天頂ではなく天文学的天頂に対して作業したい場合、phi は垂直の偏差（しばしば数十アークセカンド）に対して調整する必要があり、ha のゼロポイントにも影響があります。
7. 変換は Ve = Ry(phi-pi/2)*Rz(pi)*Vh と同じであり、ここで Ve と Vh はそれぞれ (ha,dec) および (az,el) 系における左手系単位ベクトルであり、Rz と Ry は最初に z 軸の周り、次に y 軸の周りの回転です。（注：Rz(pi) は単に x および y 成分の符号を反転させます。）効率のために、アルゴリズムは他のユーティリティ関数を呼び出すのではなく、明示的に記述されています。さらに大きな効率が要求されるアプリケーションでは、緯度の関数などの定数項を一度だけ計算することで追加の節約が可能です。
8. 再度効率のために、引数の範囲チェックは行われません。

最終改訂：2017年9月12日

SOFA リリース 2018-01-30

著作権 (C) 2018 IAU SOFA ボード。最後にノートを参照してください。
