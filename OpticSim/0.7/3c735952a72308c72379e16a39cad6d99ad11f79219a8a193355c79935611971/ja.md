```
Surface{T<:Real}
```

`T`は表面を表すために使用される数値型で、例えば`Float64`です。基本的な`Surface`は*有効なCSGオブジェクトではなく*、単独で機能します。

**次のことを実装する必要があります：**

```julia
surfaceintersection(surface::Surface{T}, ray::AbstractRay{T,3}) -> Union{EmptyInterval{T},Interval{T}}
normal(surface::Surface{T}) -> SVector{3,T}
interface(surface::Surface{T}) -> OpticalInterface{T}
makemesh(surface::Surface{T}) -> TriangleMesh{T}
```

従来のレイトレーサーでは、表面交差関数はレイが最初に交差する表面のみを返します。しかし、私たちのレイトレーサーはCSG操作を行うため、表面交差関数はCSGツリーの一部であるすべての葉表面とレイを交差させます。

各葉表面は、レイに沿った1Dの区間を1つ以上返します。これらの区間は、表面の内部にあるレイの部分を含みます。葉で計算された区間はCSGツリーを通じて上方に伝播され、和、交差、差のCSG操作が適用されて新しい区間が生成され、それ自体が上方に伝播されます。

結果は、互いに離散している場合もあれば、単一の区間、または空である場合もある1D区間の和です。区間の和は、CSGオブジェクトの内部にあるレイの部分を表します。

内部は、空間を2つの部分に分割する円柱や球などの半空間に対しては明確に定義されていますが、一般的に体積を囲まないBezierやNURBSパッチに対しては定義されていません。半空間でない表面に対しては、内部の概念は、交差点での入射レイと表面の法線との間の角度を計算することによって局所的に定義されます。すべての表面は、法線が表面の外側を指すように定義される必要があります。

入射レイと法線との間の負のドット積は、レイが表面の外側から来て内部に向かっていることを示します。正のドット積は、レイが表面の内部から来て外側に向かっていることを示します。

区間は、表面と交差しているレイに沿って定義されるため、1次元です。例えば、平面の外側に原点oを持つレイがあり、平面との交差点が点int = o + tdであると仮定します。ここで、tはスカラーでdはレイの単位方向です。内部区間は(Intersection(t),Infinity)になります。この区間は平面の交差点から始まり、正の無限大まで続きます。Intersection構造体は、さまざまな操作をより効率的にするために、パラメトリック値tと3D交差点を両方とも格納します。しかし、区間操作はパラメトリック値tのみに依存します。

原点oが平面の内部にある場合、内部区間は(RayOrigin,Intersection(t))になります。レイの原点から交差点までの部分のみが平面の内部にあります。

これらの特性を維持するInterval結果をsurfaceintersectionから返すことはプログラマーの責任です。

次のことは、表面が検出器として使用される場合にのみ実装する必要があります。

```julia
uv(surface::Surface{T}, p::SVector{3,T}) -> SVector{2,T}
uvtopix(surface::Surface{T}, uv::SVector{2,T}, imsize::Tuple{Int,Int}) -> Tuple{Int,Int}
onsurface(surface::Surface{T}, p::SVector{3,T}) -> Bool
```
