```
fit_j2_mean_elements!(j2d::J2Propagator{Tepoch, T}, vjd::AbstractVector{Tjd}, vr_i::AbstractVector{Tv}, vv_i::AbstractVector{Tv}; kwargs...) where {T<:Number, Tepoch<:Number, Tjd<:Number, Tv<:AbstractVector} -> KeplerianElements{Tepoch, T}, SMatrix{6, 6, T}
```

J2軌道伝播器 `j2d` のための平均ケプラー要素のセットを、位置ベクトルのセット `vr_i` [m] と、配列 `vjd` [ユリウス日] の瞬間における速度ベクトルのセット `vv_i` を用いてフィットします。

!!! note
    J2軌道伝播器 `j2d` は、関数によって返されるケプラー要素で初期化されます。


# キーワード

  * `atol::Number`: 残差の絶対値に対する許容誤差。残差が任意の反復で `atol` より小さい場合、計算ループは停止します。   (**デフォルト** = 2e-4)
  * `rtol::Number`: 残差間の相対差に対する許容誤差。2つの連続した反復での残差間の相対差が `rtol` より小さい場合、計算ループは停止します。   (**デフォルト** = 2e-4)
  * `initial_guess::Union{Nothing, KeplerianElements}`: 平均要素フィッティングプロセスの初期推定。`nothing` の場合、アルゴリズムは `vr_i` と `vv_i` のオスキュレーション要素から初期推定を取得します。   (**デフォルト** = nothing)
  * `jacobian_perturbation::Number`: ヤコビ行列を計算する際の有限差分を計算するための初期状態の摂動。   (**デフォルト** = 1e-3)
  * `jacobian_perturbation_tol::Number`: ヤコビ行列を計算する際に摂動を受け入れるための許容誤差。計算された摂動が `jacobian_perturbation_tol` より小さい場合、絶対値が `jacobian_perturbation_tol` より大きくなるまで増加させます。   (**デフォルト** = 1e-7)
  * `max_iterations::Int`: 最小二乗フィッティングのために許可される最大反復回数。   (**デフォルト** = 50)
  * `mean_elements_epoch::Number`: フィットされた平均要素のエポック。   (**デフォルト** = vjd[end])
  * `verbose::Bool`: `true` の場合、アルゴリズムはデバッグ情報を `stdout` に出力します。   (**デフォルト** = true)
  * `weight_vector::AbstractVector`: 最小二乗アルゴリズムのための測定値の重みを持つベクトル。重み行列 `W` を、対角に `weight_vector` の要素を持つ対角行列として組み立てます。   (**デフォルト** = `@SVector(ones(Bool, 6))`)

# 戻り値

  * `KeplerianElements{Tepoch, T}`: フィットされたケプラー要素。
  * `SMatrix{6, 6, T}`: 最小二乗アルゴリズムの最終共分散行列。

# 例

```julia-repl
# ダミーのケプラー要素を使用して新しいJ2軌道伝播器を割り当てます。
julia> j2d = j2_init(KeplerianElements{Float64, Float64}(0, 7000e3, 0, 0, 0, 0, 0));

julia> vr_i = [
           [-6792.402703741442, 2192.6458461287293, 0.18851758695295118]  .* 1000,
           [-1781.214419290065, 1619.7795321872854, 6707.771633846665]    .* 1000,
           [ 5693.643675547716, -1192.342828671633, 4123.976025977494]    .* 1000,
           [ 5291.613719530499, -2354.5417593130833, -4175.561367156414]  .* 1000,
           [-2416.3705905186903, -268.74923235392623, -6715.411357310478] .* 1000,
           [-6795.043410709359, 2184.4414321930635, -0.4327055325971031]  .* 1000,
       ];

julia> vv_i = [
           [0.3445760107690598, 1.0395135806993514, 7.393686131436984]    .* 1000,
           [6.875680282038698, -1.864319399615942, 2.270603214569518]     .* 1000,
           [3.8964090757666496, -2.1887896252945875, -5.9960180359219075] .* 1000,
           [-4.470258022565413, 0.5119576359985208, -5.9608372367141635]  .* 1000,
           [-6.647358060413909, 2.495415251255861, 2.292118747543002]     .* 1000,
           [0.3427096905434428, 1.040125572862349, 7.3936887585116855]    .* 1000,
       ];

julia> vjd = [
           2.46002818657856e6
           2.460028200467449e6
           2.460028214356338e6
           2.4600282282452267e6
           2.4600282421341157e6
           2.4600282560230047e6
       ];

julia> orb, P = fit_j2_mean_elements!(j2d, vjd, vr_i, vv_i)
ACTION:   J2伝播器のための平均要素をフィッティング中。
           反復        位置RMSE        速度RMSE           総RMSE       RMSE変動
                                     [km]             [km / s]                  [ ]
PROGRESS:         23               4.3413           0.00540076              4341.31         -2.90721e-06 %

(KeplerianElements{Float64, Float64}: Epoch = 2.46003e6 (2023-03-24T18:08:40.388), [0.16604846233666615 0.06643574144803302 … -3.85541368066423e-5 0.000124032254172014; 0.0664357414470214 0.26633448262787296 … -1.7943612056596758e-5 -1.9567956793856743e-5; … ; -3.855413680493565e-5 -1.7943612058983507e-5 … 4.3971984339116176e-7 -8.092704691911699e-8; 0.0001240322541726098 -1.9567956793417353e-5 … -8.092704692135158e-8 1.2451922454639337e-7])

julia> orb
KeplerianElements{Float64, Float64}:
           Epoch :    2.46003e6 (2023-03-24T18:08:40.388)
 半長軸 : 7131.63       km
    離心率 :    0.00114299
     傾斜角 :   98.4366     °
            RAAN :  162.177      °
  近点引数 :  101.286      °
    真の異常 :  258.689      °
```
