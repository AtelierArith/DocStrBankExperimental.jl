```
H!(H, expiβ, ℓₘₐₓ, m′ₘₐₓ, H_rec_coeffs)
H!(H, expiβ, ℓₘₐₓ, m′ₘₐₓ, H_rec_coeffs, Hindex)
```

$$
H
$$

行列を [Gumerov_2015](@citet) に従って計算します。

この計算は、[`d_matrices!`](@ref) および [`D_matrices!`](@ref) を介してウィグナーの $d$ および $𝔇$ 行列を計算するための基礎を形成し、[`sYlm_values!`](@ref) を介してスピン重み付き球面調和関数を計算し、[`map2salm`](@ref) を介してグリッド上で評価されたスピン重み付き球面関数の値から対応するモード重みへの変換を行います。

対称性により、この行列の要素の約1/4のみを計算する必要があるため、$m ≥ |m′|$ の要素のみが計算されます。 `H` ベクトルの関連インデックスは `Hindex` 関数に基づいて計算されます — これはデフォルトで `WignerHindex` ですが、入力 `H` ベクトルがすべての有効なインデックスを含む場合は `WignerDindex` でも合理的です。ただし、`H` に使用されるストレージスキームは、連続する $m$ 値が連続する要素に配置されていると仮定されています。

$$
m′ₘₐₓ < ℓₘₐₓ
$$

の場合、1/4 の要素さえ必要なく、$|m′| ≤ m′ₘₐₓ$ の値のみが計算されます。これは、スピン重み付き球面調和関数を計算する際に特に便利です。

再帰係数 `H_rec_coeffs` は、[`H_recursion_coefficients`](@ref) によって返される量である必要があります。
