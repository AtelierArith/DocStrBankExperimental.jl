```
Xa,xa = local_ETKF(Xf,H,y,diagR,part,selectObs,...)
```

予測アンサンブル `Xf` を使用して、観測 `y` に基づいて分析アンサンブル `Xa` をローカル ETKF を使用して計算します。

## 入力:

  * `Xf`: 予測アンサンブル (n x N)
  * `H`: 観測演算子 (m x n)
  * `y`: 観測 (m x 1)
  * `diagR`: 観測誤差共分散 R の対角成分 (m x 1)
  * `part`: 整数の "ラベル" のベクトル。状態ベクトルの同じ番号を持つすべての要素は同じサブドメインに属します
  * `selectObs`: サブドメイン内の観測を選択するためのコールバックルーチン。入力として状態ベクトルのインデックスを表す整数を受け取り、重みのベクトル (m x 1) を返します。例えば:

```
     selectObs(i) = exp(- ((x[i] - xobs[:]).^2 + (y(i) - yobs[:]).^2)/L^2 );
```

または

```
     selectObs(i) = compact_locfun(L,...
         sqrt((x[i] - xobs[:]).^2 + (y[i] - yobs[:]).^2));
```

ここで `x` と `y` は水平モデルグリッド、`xobs` と `yobs` は観測の位置、`L` は相関長さスケールです。

## オプション入力:

  * `display`: true の場合、進行状況を表示します (false がデフォルト)
  * `minweight`: 分析は、重みが minweight より大きい観測を使用して行われます (デフォルト 1e-8)
  * `HXf`: 空でない場合、`H*Xf` の積です。この場合、`H` は使用されません。

## 出力:

  * `Xa`: 分析アンサンブル (n x N)
  * `xa`: 分析アンサンブルの平均 (n x 1)

参照: compact_locfun
