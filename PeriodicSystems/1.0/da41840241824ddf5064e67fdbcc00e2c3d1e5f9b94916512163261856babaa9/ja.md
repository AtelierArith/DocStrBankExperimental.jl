```
psh2norm(psys; adj = false, smarg = 1, fast = false, offset = sqrt(ϵ)) -> nrm
```

離散時間周期系 `psys = (A(t),B(t),C(t),D(t))` の H2-ノルムを計算します。ノルムの計算には、[1] に示された式が使用されます。`adj = false` の場合、ノルムは次のように計算されます。

```
 nrm = sqrt(sum(tr(C(t)P(t)C(t)'+D(t)*D(t)'))),
```

ここで `P(t)` は、周期的リャプノフ方程式を満たす制御可能性グラミアンです。

```
 P(t+1) = A(t)P(t)A(t)' + B(t)B(t)',
```

一方、`adj = true` の場合、ノルムは次のように計算されます。

```
nrm = sqrt(sum(tr(B(t)'Q(t+1)B(t)+D(t)'*D(t)))),
```

ここで `Q(t)` は、周期的リャプノフ方程式を満たす可観測性グラミアンです。

```
Q(t) = A(t)'Q(t+1)A(t) + C(t)'C(t) .
```

不安定なシステムの場合、ノルムは無限大に設定されます。

安定性を評価するために、`A(t)` の特性乗数の絶対値は `smarg-β` より小さくなければなりません。ここで `smarg` は離散時間安定性マージン（デフォルト: `smarg = 1`）であり、`β` は固有値の安定性を数値的に評価するためにキーワードパラメータ `offset = β` を介して指定されるオフセットです。`β` に使用されるデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。

`fast = false`（デフォルト）の場合、ノルムは `A(t)` の周期的シュール分解に基づくアプローチを使用して評価されます。一方、`fast = true` の場合、リフトされた標準システムのノルムが評価されます。この後者のオプションは、大量の行列に対して不正確な結果をもたらすことがあります。

*参考文献*

[1] S. Bittanti and P. Colaneri. Periodic Systems : Filtering and Control.     Springer-Verlag London, 2009. 
