```
pstimeresp(sys, u, t, x0 = zeros(sys.nx); state_history = false, solver, reltol, abstol) -> (y, tout, x)
```

周期的システム `sys = (A(t),B(t),C(t),D(t))` の時間応答を、入力信号 `u` と `t` に基づいて計算します。時間ベクトル `t` は、定期的に間隔を空けた時間サンプルで構成されています。入力 `u` は、`sys` の入力数と同じ数の列を持つ行列として指定でき、その場合、`i` 行目は時間 `t[i]` における入力値を指定します。離散時間システムの場合、`u` は `sys` と同じサンプリングレート `Ts` でサンプリングされ、`t` はすべての時間ステップが `Ts` と等しいか、空のベクトルに設定する必要があります。連続時間モデルの場合、入力値はゼロ次保持による補間を使用してサンプル間で補間されます。ベクトル `x0` は、時間 `t[1]` における初期状態ベクトルを指定し、省略した場合はゼロに設定されます。

行列 `y` には `sys` の出力の結果としての時間履歴が含まれ、ベクトル `tout` には対応する時間サンプルの値が含まれます。`y` の `i` 行目には、時間 `tout[i]` における出力値が含まれます。キーワードパラメータ `state_history = true` が使用されると、行列 `x` には状態ベクトルの結果としての時間履歴が含まれ、その `i` 行目 `x[i,:]` には時間 `tout[i]` における状態値が含まれます。行列 `x` の列の次元は `n` であり、状態ベクトルの次元です。時間変化する状態次元を持つ離散時間周期システムの場合、`n` は1周期における状態ベクトルの次元の最大値です。`x[i,:]` の要素は、対応する状態ベクトルの次元が `n` より小さい場合、末尾にゼロ値を持ちます。デフォルトでは、状態履歴は保存されず、`x = nothing` です。

連続時間モデルの場合、シミュレーションに使用するための同等の離散化モデルが決定されます。離散化は、対応する同次線形ODEを数値的に統合することによって、拡張状態空間行列 `[A(t) B(t); 0 0]` の状態遷移行列の積としてモノドロミー行列を決定することによって行われます。使用するODEソルバーは、キーワード引数 `solver` を使用して指定でき、必要な相対精度 `reltol`（デフォルト: `reltol = 1.e-4`）、絶対精度 `abstol`（デフォルト: `abstol = 1.e-7`）、および/または固定ステップ長 `dt`（デフォルト: `dt = Ts/10`）を指定できます。望ましい相対精度 `reltol` に応じて、`reltol >= 1.e-4` の場合は低次のソルバーが使用され、一般的に非常に効率的ですが、精度は低くなります。`reltol < 1.e-4` の場合は、高精度の要求に対応できる高次のソルバーが使用されます。

次のソルバーは、[OrdinaryDiffEq.jl](https://github.com/SciML/OrdinaryDiffEq.jl) パッケージから選択できます：

`solver = "non-stiff"` - 非剛性問題用のソルバーを使用します（`Tsit5()` または `Vern9()`）;

`solver = "stiff"` - 剛性問題用のソルバーを使用します（`Rodas4()` または `KenCarp58()`）;

`solver = "linear"` - 固定時間ステップ `dt` を持つ線形ODE用の特別なソルバーを使用します（`MagnusGL6()`）;

`solver = "symplectic"` - シンプレクティックハミルトニアン構造を保持するソルバーを使用します（`IRKGL16()`）;

`solver = "auto"` - デフォルトのソルバーを使用し、自動的に剛性問題を検出します（`AutoTsit5(Rosenbrock23())` または `AutoVern9(Rodas5())`）。

多数の積項がある場合、Juliaを複数の実行スレッドで起動することにより、因子の並列計算を代わりに実行できます。実行スレッドの数は、`-t/--threads` コマンドライン引数を使用するか、`JULIA_NUM_THREADS` 環境変数を使用して制御されます。
