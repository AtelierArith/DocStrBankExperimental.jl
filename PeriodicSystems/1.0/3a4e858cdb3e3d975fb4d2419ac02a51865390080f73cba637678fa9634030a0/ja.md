```
psstepresp(sys[, tfinal]; ustep = ones(psys.nu), x0 = zeros(psys.nx), timesteps = 100, 
         state_history = false, abstol, reltol) -> (y, tout, x)
```

周期的システム `sys = (A(t),B(t),C(t),D(t))` のステップ入力信号に対する時間応答を計算します。最終時間 `tfinal` は指定されていない場合、周期的システム `sys` の周期と等しく設定されます。離散時間システムの場合、最終時間 `tfinal` はシステムのサンプリング時間 `Ts` と整合性がなければなりません（そうでない場合は、最も近い小さい整合値に調整されます）。キーワード引数 `ustep` は、`sys` の入力と同じ数の成分を持つベクトルで、ステップ入力の希望する振幅を指定します（デフォルト：すべての成分は1に設定されます）。キーワード引数 `x0` は、時間 `0` における初期状態ベクトルを指定するベクトルで、省略した場合はゼロに設定されます。キーワード引数 `timesteps` は、希望するシミュレーション時間ステップの数を指定します（デフォルト：`timesteps = 100`）。

`ns` がシミュレーション値の総数、`n` が状態成分の数、`p` がシステム出力の数、`m` がシステム入力の数である場合、結果として得られる `ns×p×m` 配列 `y` には、`sys` の出力の時間履歴が含まれ、`y[:,:,j]` は `j` 番目の入力が `ustep[j]` に設定され、他の入力がゼロに設定されたときの時間応答です。ベクトル `tout` には、対応する時間サンプルの値が含まれます。`i` 番目の行 `y[i,:,j]` には、`j` 番目のステップ応答の時間 `tout[i]` における出力値が含まれます。キーワードパラメータ値 `state_history = true` が使用されると、結果として得られる `ns×n×m` 配列 `x` には状態ベクトルの時間履歴が含まれ、`i` 番目の行 `x[i,:,j]` には、`j` 番目のステップ応答の時間 `tout[i]` における状態値が含まれます。時間変化する状態次元を持つ離散時間周期システムの場合、`n` は1周期における状態ベクトルの次元の最大値です。`x[i,:,j]` の成分は、対応する状態ベクトルの次元が `n` より小さい場合、末尾にゼロ値を持ちます。デフォルトでは、状態履歴は保存されず、`x = nothing` です。

シミュレーション値の総数 `ns` は次のように設定されます：連続時間システムの場合 `ns = timesteps+1`、離散時間システムの場合 `ns = min(timesteps,tfinal/Ts)+1`。

連続時間モデルの場合、時間ステップ `Δ = tfinal/timesteps` がシステムの周期 `T` と整合性があり、`tfinal >= T` の場合にシミュレーションに使用するための同等の離散化モデルが決定されます。離散化は、対応する同次線形ODEを数値的に統合することによって、拡張状態空間行列 `[A(t) B(t); 0 0]` の状態遷移行列の積としてモノドロミー行列を決定することによって行われます。時間ステップ `Δ` が周期 `T` と整合性がない場合や `tfinal < T` の場合は、基礎となるODEシステムの数値的統合が行われます。使用するODEソルバーは、キーワード引数 `solver` を使用して指定でき、必要な相対精度 `reltol`（デフォルト：`reltol = 1.e-4`）、絶対精度 `abstol`（デフォルト：`abstol = 1.e-7`）、および/または固定ステップ長 `dt`（デフォルト：`dt = Ts/10`）とともに指定できます。希望する相対精度 `reltol` に応じて、`reltol >= 1.e-4` の場合は低次のソルバーが使用され、一般的に非常に効率的ですが、精度は低くなります。`reltol < 1.e-4` の場合は、高精度の要求に対応できる高次のソルバーが使用されます。

次のソルバーは、[OrdinaryDiffEq.jl](https://github.com/SciML/OrdinaryDiffEq.jl) パッケージから選択できます：

`solver = "non-stiff"` - 非剛性問題用のソルバーを使用します（`Tsit5()` または `Vern9()`）;

`solver = "stiff"` - 剛性問題用のソルバーを使用します（`Rodas4()` または `KenCarp58()`）;

`solver = "linear"` - 固定時間ステップ `dt` を持つ線形ODE用の特別なソルバーを使用します（`MagnusGL6()`）;

`solver = "symplectic"` - シンプレクティックハミルトニアン構造を保持するソルバーを使用します（`IRKGL16()`）;

`solver = "auto"` - 剛性問題を自動的に検出するデフォルトのソルバーを使用します（`AutoTsit5(Rosenbrock23())` または `AutoVern9(Rodas5())`）。

多数の積項がある場合、Juliaを複数の実行スレッドで起動することにより、因子の並列計算を代替的に実行できます。実行スレッドの数は、`-t/--threads` コマンドライン引数を使用するか、`JULIA_NUM_THREADS` 環境変数を使用して制御されます。
