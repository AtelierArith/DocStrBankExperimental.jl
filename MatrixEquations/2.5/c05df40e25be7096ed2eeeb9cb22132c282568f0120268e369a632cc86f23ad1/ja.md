```
gared(A, E, B, R, Q, S; scaling = 'B', pow2 = false, as = false, rtol::Real = nϵ, nrm = 1) -> (X, EVALS, F, Z, scalinfo)
```

一般化離散時間代数リカッティ方程式のエルミート/対称安定解（`as = false`の場合）または反安定解（`as = true`の場合）である`X`を計算します。

```
A'XA - E'XE - (A'XB+S)(R+B'XB)^(-1)(B'XA+S') + Q = 0,
```

ここで、`R`と`Q`はエルミート/対称行列であり、`E`は非特異です。スカラー値の`R`と`Q`は、適切なサイズの一様スケーリング演算子`R*I`および`Q*I`として解釈されます。`S`は指定されていない場合、`S = zeros(size(B))`に設定されます。

計算の精度を向上させるために、行列`R,` `Q`および`S`のブロック指向スケーリングがデフォルト設定`scaling = 'B'`を使用して行われます。このスケーリングは、`norm(Q) > norm(B)^2/norm(R)`の場合にのみ実行されます。`scaling = 'G'`が選択された場合、一般的な固有値計算指向のスケーリングとブロックスケーリングが組み合わされます。構造を保持する代替スケーリングは、オプション`scaling = 'S'`を使用して実行できます。対称行列の均衡に基づくスケーリングは、`scaling = 'K'`の場合に使用され、基礎となるベクトルノルムはキーワード引数`nrm = p`を使用して指定できます。ここで、`p = 1`がデフォルト設定です。実験的な構造保持スケーリングは、オプション`scaling = 'D'`、`scaling = 'R'`および`scaling = 'T'`を使用して実行できます。スケーリングは、選択`scaling = 'N'`で無効にできます。`pow2 = true`の場合、スケーリング要素は最も近い2の累乗に強制されます（デフォルト：`pow2 = false`）。

デフォルトでは、1ノルムの逆条件数`rtol`の下限は`n*ϵ`であり、ここで`n`は`A`の次数で、`ϵ`は`A`の要素型の*マシンイプシロン*です。

`EVALS`は、ペア`(A-BF,E)`の（安定または反安定）一般化固有値を含むベクトルです。

`F`は安定化/反安定化ゲイン行列`F = (R+B'XB)^(-1)(B'XA+S')`です。

`Z = [U; V; W]`は、関連する安定/反安定のデフレーティング部分空間の直交基底であり、`X = (Sx*(V/U)*Sxi)/E`および`F = -Sr*(W/U)*Sxi`となります。ここで、`Sx`、`Sxi`および`Sr`は、名前付きタプル`scalinfo`に含まれる対角スケーリング行列であり、それぞれ`scalinfo.Sx`、`scalinfo.Sxi`および`scalinfo.Sr`です。

`参考文献:`

[1] W.F. Arnold, III and A.J. Laub,     Generalized Eigenproblem Algorithms and Software for Algebraic Riccati Equations,     Proc. IEEE, 72:1746-1754, 1984.

# 例

```jldoctest
julia> using LinearAlgebra

julia> A = [-6. -2. 1.; 5. 1. -1; -4. -2. -1.]
3×3 Array{Float64,2}:
 -6.0  -2.0   1.0
  5.0   1.0  -1.0
 -4.0  -2.0  -1.0

julia> E = [10. 3. 0.; 0. 5. -1.; 0. 0. 10.]
3×3 Array{Float64,2}:
 10.0  3.0   0.0
  0.0  5.0  -1.0
  0.0  0.0  10.0

julia> B = [1. 2.; 2. 0.; 0. 1.]
3×2 Array{Float64,2}:
 1.0  2.0
 2.0  0.0
 0.0  1.0

julia> R = [1. 0.; 0. 5.]
2×2 Array{Float64,2}:
 1.0  0.0
 0.0  5.0

julia> X, CLSEIG, F = gared(A,E,B,R,2I);

julia> X
3×3 Array{Float64,2}:
  0.065865   -0.0147205  -0.0100407
 -0.0147205   0.0885939   0.0101422
 -0.0100407   0.0101422   0.0234425

julia> A'*X*A-E'*X*E-A'*X*B*inv(R+B'*X*B)*B'*X*A+2I
3×3 Array{Float64,2}:
 -1.33227e-15  -2.48412e-15   1.38778e-16
 -2.498e-15    -4.44089e-16  -6.50521e-16
  1.80411e-16  -5.91541e-16  -1.33227e-15

julia> CLSEIG
3-element Array{Complex{Float64},1}:
  -0.084235615751339 - 0.0im
  -0.190533552034239 - 0.0im
 -0.5238922629921539 - 0.0im

julia> eigvals(A-B*F,E)
3-element Array{Float64,1}:
 -0.5238922629921539
 -0.19053355203423886
 -0.08423561575133902
```
