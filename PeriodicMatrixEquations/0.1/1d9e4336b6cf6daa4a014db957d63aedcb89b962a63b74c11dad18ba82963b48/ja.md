```
pclyap(A, C; K = 10, N = 1, adj = false, solver, reltol, abstol, intpol) -> X
```

周期的リャプノフ微分方程式を解きます。

```
.
X(t) = A(t)X(t) + X(t)A(t)' + C(t) , adj = false の場合、
```

または 

```
 .
-X(t) = A(t)'X(t) + X(t)A(t) + C(t) , adj = true の場合。
```

周期行列 `A` と `C` は同じ型、同じ次元、かつ同じ周期でなければなりません。さらに、`C` は対称でなければなりません。得られた対称的な周期解 `X` は `PeriodicFunctionMatrix` 型であり、`X(t)` を使用して時刻 `t` における `X` の値を評価できます。`X` の周期は `A` と `C` の最小公倍周期に設定され、サブ周期の数はそれに応じて調整されます。

[1] の多重射撃法が、（連続時間の）周期的リャプノフ方程式を解の多点周期生成器が満たす離散時間の周期的リャプノフ方程式に変換するために使用されます。キーワード引数 `K` は、連続時間問題の離散化に使用されるグリッドポイントの数を指定します（デフォルト: `K = 10`）。`A` と `C` が `PeriodicTimeSeriesMatrix` または `PeriodicSwitchingMatrix` 型の場合、`K` は2つの連続する切り替え時刻の間で使用されるグリッドポイントの数を指定します（デフォルト: `K = 1`）。多点周期生成器は、[2] の周期的シュール法を使用して適切な離散時間の周期的リャプノフ方程式を解くことによって計算されます。得られた周期生成器は、与えられた `t` に対して、`intpol = true`（デフォルト）であれば適切な微分方程式の解を補間することによって関数値 `X(t)` を決定する周期関数行列に変換されます。`intpol = false` の場合は、最寄りのグリッドポイント値から適切なODEを統合します。補間に基づく評価のために、整数キーワード引数 `N` を使用して、積分領域（すなわち1周期）を `N` のサブドメインに分割し、各ドメインで補間を別々に行うことができます。`N` のデフォルト値は `N = 1` です。

連続時間問題を離散時間問題に変換するために使用されるODEソルバーは、キーワード引数 `solver` を使用して指定でき、必要な相対精度 `reltol`（デフォルト: `reltol = 1.e-4`）および絶対精度 `abstol`（デフォルト: `abstol = 1.e-7`）とともに指定されます。望ましい相対精度 `reltol` に応じて、`reltol >= 1.e-4` の場合は低次のソルバーが使用され、一般的に非常に効率的ですが、精度は低くなります。`reltol < 1.e-4` の場合は、高精度の要求に対応できる高次のソルバーが使用されます。

以下のソルバーは、[OrdinaryDiffEq.jl](https://github.com/SciML/OrdinaryDiffEq.jl) パッケージから選択できます：

`solver = "non-stiff"` - 非剛性問題用のソルバーを使用します（`Tsit5()` または `Vern9()`）;

`solver = "stiff"` - 剛性問題用のソルバーを使用します（`Rodas4()` または `KenCarp58()`）;

`solver = "auto"` - 剛性問題を自動的に検出するデフォルトのソルバーを使用します（`AutoTsit5(Rosenbrock23())` または `AutoVern9(Rodas5()`）。 

離散時間問題の行列の並列計算は、複数の実行スレッドでJuliaを起動することによっても行うことができます。実行スレッドの数は、`-t/--threads` コマンドライン引数を使用するか、`JULIA_NUM_THREADS` 環境変数を使用して制御されます。

*参考文献*

[1] A. Varga. 周期的な微分行列方程式の解法と周期システムノルム計算への応用。Proc. IEEE CDC/ECC, Seville, 2005.

[2] A. Varga. 周期的リャプノフ方程式：いくつかの応用と新しいアルゴリズム。Int. J. Control, vol, 67, pp, 69-87, 1997. ```
