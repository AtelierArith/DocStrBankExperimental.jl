```
pgcplyap(A, C[, K = 1]; adj = false, solver, reltol, abstol) -> U
```

周期的リャプノフ微分方程式の解 `X(t) = U(t)U(t)'` の上三角周期生成器 `U(t)` を計算します。

```
.
X(t) = A(t)X(t) + X(t)A(t)' + C(t)C(t)' , if adj = false,
```

または、周期的リャプノフ微分方程式の解 `X(t) = U(t)'U(t)` の上三角周期生成器 `U(t)` を計算します。

```
 .
-X(t) = A(t)'X(t) + X(t)A(t) + C(t)'C(t) , if adj = true.
```

周期的行列 `A` と `C` は同じ型で、共通の周期を持ち、`A` は安定でなければなりません。結果として得られる `U` は、`A` と `C` が定数行列である場合は `N = 1`、それ以外の場合は `N = K` の `N` コンポーネントを持つ周期的生成行列のコレクションです。`U` の周期は `A` と `C` の最小公倍数の共通周期に設定され、サブ周期の数はそれに応じて調整されます。`U` の任意のコンポーネント行列は、適切な微分方程式を統合することによって完全な周期にわたって解を生成するために使用される有効な初期値です。[1] の多重射撃法の拡張が使用され、まず連続時間の周期的リャプノフを、`K` の時間グリッドポイントで生成器解を満たす離散時間の周期的リャプノフ方程式に変換し、次に適切な離散時間の周期的リャプノフ方程式を解くことによって解を計算します（アルゴリズム 5）[2]。

連続時間の問題を離散時間の問題に変換するために使用されるODEソルバーは、キーワード引数 `solver` を使用して指定でき、必要な相対精度 `reltol`（デフォルト: `reltol = 1.e-4`）および絶対精度 `abstol`（デフォルト: `abstol = 1.e-7`）とともに指定されます。望ましい相対精度 `reltol` に応じて、`reltol >= 1.e-4` の場合は低次のソルバーが使用され、一般的に非常に効率的ですが、精度は低くなります。`reltol < 1.e-4` の場合は、高精度の要求に対応できる高次のソルバーが使用されます。

[OrdinaryDiffEq.jl](https://github.com/SciML/OrdinaryDiffEq.jl) パッケージから次のソルバーを選択できます：

`solver = "non-stiff"` - 非剛性問題用のソルバーを使用します（`Tsit5()` または `Vern9()`）;

`solver = "stiff"` - 剛性問題用のソルバーを使用します（`Rodas4()` または `KenCarp58()`）;

`solver = "auto"` - 剛性問題を自動的に検出するデフォルトのソルバーを使用します（`AutoTsit5(Rosenbrock23())` または `AutoVern9(Rodas5())`）。

大きな値の `K` に対しては、複数の実行スレッドでJuliaを起動することにより、離散時間問題の行列の並列計算を代わりに実行できます。実行スレッドの数は、`-t/--threads` コマンドライン引数を使用するか、`JULIA_NUM_THREADS` 環境変数を使用して制御されます。

*参考文献*

[1] A. Varga. 周期的なシステムノルム計算への応用を伴う周期的な微分行列方程式の解法について。Proc. IEEE CDC/ECC, Seville, 2005.

[2] A. Varga. 周期的リャプノフ方程式：いくつかの応用と新しいアルゴリズム。Int. J. Control, vol, 67, pp, 69-87, 1997.
