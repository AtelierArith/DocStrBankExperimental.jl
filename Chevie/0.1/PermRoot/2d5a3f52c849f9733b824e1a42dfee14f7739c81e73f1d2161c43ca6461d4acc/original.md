Let  `V` be a vector  space over a subfield  `K` of the complex numbers (in Julia  the elements  of `K`  will be  usually represented by `Rational`s or `Cyc`s).

A *complex reflection* is an element `s∈ GL(V)` of finite order whose fixed point  set is  a hyperplane,  the *reflecting  hyperplane* `Hₛ` of `s`.

Most  of the  time we  abbreviate "complex  reflection" to *reflection*; in some  literature "reflection" is reserved for  `s` of order 2 and otherwise *pseudo-reflection* is used.

A  reflection `s` has a unique eigenvalue `ζₛ` not equal to `1`, which is a root  of  unity;  if  `K`  is  a  subfield  of  the  real  numbers, `ζₛ` is necessarily  equal to `-1` and `s` is of  order 2. An eigenvector `r∈ V` of `s`  for the eigenvalue  `ζₛ` is called  a *root* of  `s` and a linear form `rᵛ`  on `V` of  kernel `Hₛ` is  called a *coroot*  of `s`. Usually `r` and `rᵛ`  are scaled so that `rᵛ(r)=1-ζ`; then `s` is the map on `V` defined by `s(x)=x-rᵛ(x)r`.  Such roots and  coroots for `s`  are unique up to scaling the root and inversely scaling the coroot.

A  finite  complex  reflection  group  `W`  is  a finite group generated by complex  reflections.  Since  whenever  `W`  contains  a  reflection `s` it contains  its powers, `W` is always  generated by reflections `s` such that `ζₛ==E(d)`  where `d` is the  order of `s`; we  can also assume that `s` is not  a  power  of  another  reflection  of  `W`  with  larger order. Such a reflection is called a *distinguished* reflection of `W`; it is a canonical generator  of the cyclic subgroup of  `W` centralizing `Hₛ`. The generators of  the  complex  reflection  groups  we construct are always distinguished reflections; the set of distinguished reflections are in bijection with the reflecting  hyperplanes.  In  a  real  reflection group all reflections are distinguished.

It  is much  more efficient  to compute  with permutation  groups than with matrix  groups; hence we use for computing with a finite complex reflection group  `W` a permutation representation on  a `W`-invariant set of root and coroot vectors for reflections of `W`; that is, a set `R` of pairs `(r,rᵛ)∈ V×Vᵛ`  invariant by `W` and such that every distinguished reflection in `W` is determined by some pair in `R` (see [`reflectionMatrix`](@ref)). Using a `W`-invariant set implies that there are several pairs determining the same reflection,  which differ  by roots  of unity.  This generalizes  the usual construction  for Coxeter groups (the case `K=ℝ`) where to each reflection of `W` is associated two roots, one positive and one negative.

A  complex reflection group  is *irreducible* if  the representation `V` is irreducible.  For irreducible complex reflection groups, there are at least as  many roots for a given distinguished reflection as the lcm of the order of the reflection and of the order of the center of `W`.

The  following  methods  are  always  defined for finite complex reflection groups:

  * `gens(W)`: the (distinguished) reflections which generate `W`, given as permutations of the roots. `reflrep(W)` gives them as matrices.
  * `roots(W)`: the list of roots of `W`.
  * `coroots(W)`: the list of coroots, in the same order as the roots.
  * `refls(W)`:  a list of  distinguished reflections of  `W`, as permutations. This list is of same length as the roots, and its `i`-th element is the distinguished   reflection  for  the  `i`-th  root,  so  it  will  have repetitions. `unique_refls(W)` returns a sublist of `1:length(roots(W))` such that the distinguished reflections around the corresponding  roots reach one time  only each distinguished reflection of `W`.

The  lists  `roots`,  `coroots`  and  `refls`  starts with the ones for the reflections  `gens(W)`;  these  are  called  *simple* roots and coroots and *simple* reflections.

  * `simpleroots(W)`:  the simple roots as a matrix.
  * `simplecoroots(W)`:  the simple coroots as a matrix.
  * `reflections(W)` gives a list without repetitions of all reflections of `W`   (not   only   the   distinguished   ones),  as  objects  of  type [`Reflection`](@ref),  starting  with  the  distinguished  reflections. These objects contain more information on each reflection.

The  finite irreducible complex  reflection groups have  been classified by Shephard and Todd, see [ShephardTodd1954](biblio.htm#ST54). They consist of one  infinite family `G(de,e,r)` depending  on 3 parameters (which includes the infinite families of Weyl groups), and 34 exceptional groups which have been given by Shephard and Todd names which range from `G₄` to `G₃₇`. These exceptional   groups   include   the   exceptional   Weyl   groups,   e.g., `coxgroup(:E,8)` is the same as `G₃₇`.

We provide functions to build any finite reflection group, either by giving a  list of simple roots and simple coroots (see [`PRG`](@ref)), or in terms of  the  classification  (see  [`complex_reflection_group`](@ref)).  In the context  e.g. of  Weyl groups,  one wants  to describe  the particular root system chosen in term of the traditional classification of crystallographic root systems. This is done via calls to the function [`coxeter_group`](@ref) (see the module [`Weyl`](@ref)). There is not yet a general  theory on  how to  construct a  nice set  of roots  for a non-real reflection  group;  the  roots  chosen  here  where  obtained case-by-case; however, they satisfy several important properties:

  * The simple reflections  satisfy braid relations  which present the braid group associated to `W` (see [`diagram`](@ref)).
  * The *field  of definition*  of `W`  is the  field `K` generated by the traces  of the elements of `W` acting on  `V`. It is a theorem that `W` may be realized as a reflection group over `K`.
  * The Cartan matrix `rᵛ(r')` where `r` and `r'` runs over the simple roots and  coroots has entries in  the ring `ℤₖ` of  integers of `K`, and the other  roots (resp. coroots) are  linear combinations with coefficients in `ℤₖ` of a linearly independent subset of them.

It  turns out that all representations of `W` are defined over the field of definition `K` (see. [Benard1976](biblio.htm#Ben76) and D.~Bessis' thesis). This  has been known for a  long time in the case  `K=ℚ`, the case of Weyl groups, whose representations are all integral.

```julia-repl
julia> W=complex_reflection_group(4)
G₄

julia> gens(W) # as permutations of the 24 roots
2-element Vector{Perm{Int16}}:
 (1,3,9)(2,4,7)(5,10,18)(6,11,16)(8,12,19)(13,15,20)(14,17,21)(22,23,24)
 (1,5,13)(2,6,10)(3,7,14)(4,8,15)(9,16,22)(11,12,17)(18,19,23)(20,21,24)

julia> length(unique(refls(W)))
4

julia> length(refls(W)) # 24=4*(number of roots of unity in ℚ (ζ₃))
24

julia> reflrep(W) # the generators as matrices
2-element Vector{Matrix{Cyc{Rational{Int64}}}}:
 [1 0; 0 ζ₃]
 [√-3/3 -ζ₃²√-3/3; (-3+√-3)/3 -ζ₃√-3/3]
```

For  almost  all  irreducible  complex  reflection  groups,  the generating matrices  for `W` we give have coefficients in the field of definition `K`. Further,  the set of matrices for all elements of `W` is globally invariant under  the  Galois  group  of  `K/ℚ`,  thus  the  Galois  action  induces automorphisms  of `W`. The exceptions are `G₂₂, G₂₇` where the matrices are in  a  degree  two  extension  of  `K`  (this  is needed to have a globally invariant  model, see [MarinMichel2010](biblio.htm#MarinMichel10)) and some dihedral  groups, as well as  `H₃` and `H₄`, where  the matrices given (the usual   Coxeter  reflection  representation  over  `K`)  are  not  globally invariant (but one can get invariant ones by `chevieget(:H4,:InvariantModel)`).

```julia-repl
julia> braid_relations(W) # as tuples of equal words in the generators
1-element Vector{Tuple{Vector{Int64}, Vector{Int64}}}:
 ([1, 2, 1], [2, 1, 2])

julia> diagram(W) # the same in pictures
③ ——③ G₄
1   2

julia> cartan(W)
2×2 Matrix{Cyc{Rational{Int64}}}:
 ζ₃²√-3     ζ₃²
   -ζ₃²  ζ₃²√-3

julia> simpleroots(W)
2×2 Matrix{Cyc{Rational{Int64}}}:
    0  ζ₃²√-3
 2ζ₃²     ζ₃²

julia> simplecoroots(W)
2×2 Matrix{Cyc{Rational{Int64}}}:
     0      1
 √-3/3  √-3/3
```

Let `SV` be the symmetric algebra of `V`. The invariants of `W` in `SV` are called the *polynomial invariants* of `W`. If `n=dim V`, they are generated as   a  polynomial  ring  by   `n`  homogeneous  algebraically  independent polynomials `f₁,…,fₙ`. The polynomials `fᵢ` are not uniquely determined but their  degrees are. The `fᵢ` are called  the *basic invariants* of `W`, and their  degrees the *reflection  degrees* of `W`;  the function `degrees(W)` returns these invariants.

Let  `I` be the  ideal generated by  the homogeneous invariants of positive degree  in `SV`. Then `SV/I` is isomorphic to the regular representation of `W`  as a  `W`-module. It  is thus  a graded  (by the degree of elements of `SV`)  version of the  regular representation of  `W`. The polynomial which gives  the graded  multiplicity of  a character  `φ` of  `W` in  the graded module   `SV/I`  is  called   the  *fake  degree*   of  `φ`.  The  function `fakedegrees` returns these polynomials.

```julia-repl
julia> degrees(W)
2-element Vector{Int64}:
 4
 6

julia> fakedegrees(W,Pol(:x))
7-element Vector{Pol{Int64}}:
 1
 x⁴
 x⁸
 x⁷+x⁵
 x⁵+x³
 x³+x
 x⁶+x⁴+x²
```
