```
stagger_and_step(ds::DynamicalSystem, x0, N::Int, 
    isinside::Function; kwargs...) -> trajectory
```

スタッガー・アンド・ステップ法 [Sweet2001](@cite) および [Sala2016](@cite) を実装して、システムのカオス的遷移ダイナミクスを支配する不変の非吸引集合、すなわちカオス的鞍の安定多様体を近似します。

動的システム `ds` と、吸引子のない領域での初期推定 `x0` が与えられ、メンバーシップ関数 `isinside` によって定義されると、アルゴリズムは安定多様体に近い位相空間からの `N` 点の `StateSpaceState` という名前の `trajectory` を返します。この点の1つを `ds` の初期条件として設定すると、軌道は `ds` の少なくとも `Tm` ステップ後に領域から脱出します。探索は確率的であり、探索の小さな近傍を定義するパラメータ `δ` に依存します。

関数 `isinside(x)` は、点 `x` が選択された有界領域の内部にある場合は `true` を返し、そうでない場合は `false` を返さなければなりません。この関数を構築するためのヘルパーとして [`statespace_sampler`](@ref) を参照してください。

## キーワード引数

  * `δ = 1e-10`: 特定の点の周りのランダム探索を制約する小さな数。この数の解釈は、サンプリングのために選択された確率分布に依存します（`stagger_mode` を参照）。
  * `Tm = 30`: 軌道が `isinside` によって定義されたバウンディングボックスから脱出する前の `ds` の最小ステップ数。
  * `max_steps = 10^5`: 新しい候補点の探索がある時点で失敗する可能性があります。`max_steps` の後に探索が失敗した場合、新しい初期点が設定され、メソッドは新しい点から開始します。
  * `max_escape_time = 10000`: 軌道が `max_escape_time` ステップ後に定義された領域に留まる場合、その領域にはおそらく吸引子があり、アルゴリズムはエラーをスローします。
  * `stagger_mode = :exp`: 候補点 `x` を生成して条件 `T(x) > Tm` を満たす方法はいくつかあります。利用可能な方法は次のとおりです：

      * `:exp`: 候補は、現在の `x` の周りのランダムな方向 `u` で切り捨てられた指数分布からサンプリングされます。`x_c = x + u*r` で、`r = 10^-s` で `s` は [-15, δ] の一様分布から取られます。
      * `:unif`: 次の候補は `x_c = x + u*r` で、`r` は一様分布 [0,δ] から取り、`u` は `x` の周りのランダムな方向です。
      * `:adaptive`: 次の候補は `x_c = x + u*r` で、`r` は平均ゼロで分散 δ のガウス分布から引かれます。分散は自由パラメータ `γ` に応じて適応され、候補が見つからない場合は `δ = δ/γ`、成功した場合は `δ = δ*γ` となります。
  * `γ = 1.1`: 適応スタッガー法 `:adaptive` の自由パラメータです。
  * `δ₀ = 1.0`: これは最初のスタッガー軌道探索の半径です。アルゴリズムは、スタッガー・アンド・ステップルーチンに切り替える前に鞍に十分近い点を探します。探索半径は適切な初期候補を見つけるのに十分大きくなければなりません。`δ₀` を入力するには `\delta<TAB>\_0<TAB>` を使用します。
  * `rng::AbstractRNG = Xoshiro()`: 乱数生成器。再現性のためにこれを使用します。

## 説明

このメソッドは、鞍に近い初期条件を探索し、脱出時間 `T(x_n) > Tm` を持つスタッガー・アンド・ステップアルゴリズムに依存しています。関数 `T` は、初期条件 `x_n` を持つ軌道がユーザーによって定義された領域から出る時間を表します（引数 `isinside` を参照）。この時間は、動的システム `ds` に応じて離散または連続の変数です。

動的マッピング `F` が与えられた場合、ステップ `x_{n+1} =  F(x_n)` が条件 `T(x_{n+1}) > Tm` を満たす場合、この次の点を受け入れます。これがメソッドの *ステップ* 部分です。そうでない場合、メソッドは与えられた確率分布に従って近傍内で次の点をランダムに探索します。これが *スタッガー* 部分です。*スタッガー* プロセスは時々新しい候補を見つけることに失敗し、定義された領域内で軌道の新しい出発点が選ばれます。異なる利用可能な方法についてはキーワード引数 `stagger_mode` を参照してください。

このメソッドは、カオス的鞍の安定多様体に δ-近い `N` 点の擬似軌道を生成します。 ```
