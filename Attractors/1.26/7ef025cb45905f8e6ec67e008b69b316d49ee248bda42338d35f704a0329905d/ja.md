```
basin_entropy(basins::Array{Integer}, ε = size(basins, 1)÷10) -> Sb, Sbb
```

与えられた引力の `basins` の盆地エントロピー [Daza2016](@cite) `Sb` と盆地境界エントロピー `Sbb` を、各次元に沿った `ε` サイズのボックスを考慮して返します。

## 説明

まず、n 次元の入力 `basins` を、辺の長さ `ε` の n 次元ボックスに定期的に分割します。`ε` が整数の場合、すべての次元に同じサイズが使用されます。それ以外の場合、`ε` は `basins` の次元と同じサイズのタプルであることができます。盆地のサイズは `ε` で割り切れる必要があります。

`basins` をカバーする $N$ の `ε`-ボックスがあると仮定すると、盆地エントロピーは [Daza2016](@cite) に従って推定されます。

$$
S_b = \tfrac{1}{N}\sum_{i=1}^{N}\sum_{j=1}^{m_i}-p_{ij}\log(p_{ij})
$$

ここで、$m_i$ はボックス $i$ におけるユニークな ID（`basins` の整数）の数であり、$p_{ij}$ はボックス $i$ で ID $j$ を取得する相対頻度（確率）であり、単に ID $j$ のカウントをボックス内の合計で割ったものです。

`Sbb` は境界盆地エントロピーです。これは $S_b$ と同じ定義に従いますが、今度は少なくとも 2 つの異なる盆地を含むボックスのみに対して平均化されます。つまり、境界上のボックスに対してです。

盆地エントロピーは、盆地の初期条件に関する不確実性の尺度です。これは、`basins` 内のユニークな ID の数 `n_att` に対して最大値 `log(n_att)` になります。この場合、境界は混在しています：特定の初期条件に対して、別の盆地に至る別の初期条件を任意の近さで見つけることができます。また、境界盆地エントロピー `Sbb` が `log(2)` を超える場合、フラクタル境界があるという単純な基準を提供します。これは、値がそれ以下の盆地がフラクタル境界を持たないことを意味するわけではありません。より正確なテストについては [`basins_fractal_test`](@ref) を参照してください。盆地エントロピーの重要な特徴は、同じボックスサイズ `ε` を使用して異なる盆地間の比較を可能にすることです。 ```
