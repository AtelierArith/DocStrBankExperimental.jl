```julia
function cochranqTest(table::Matrix{I};
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true) where {I <: Int, TestDir <: TestDirection}

```

å˜å¤‰é‡ [Cochran Q](https://en.wikipedia.org/wiki/Cochran's_Q_test) ãƒ†ã‚¹ãƒˆã¯ãƒ‡ãƒ¼ã‚¿ã®ç½®æ›ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã™ã€‚Cochran Q ãƒ†ã‚¹ãƒˆã¯ã€ç¹°ã‚Šè¿”ã—æ¸¬å®šã® 1-way ANOVA ã«é¡žä¼¼ã—ã¦ã„ã¾ã™ãŒã€äºŒé …ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¼ãƒ­ã¨1ï¼‰ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã‚Šã¾ã™ã€‚$N$ ã®è¦³å¯Ÿå˜ä½ï¼ˆä¾‹ï¼šè¢«é¨“è€…ã€ãƒ–ãƒ­ãƒƒã‚¯ãªã©ï¼‰ã¨ $K$ ã®ç¹°ã‚Šè¿”ã—æ¸¬å®šï¼ˆä¾‹ï¼šå‡¦ç½®ã€æ™‚é–“ãªã©ï¼‰ãŒä¸Žãˆã‚‰ã‚ŒãŸå ´åˆã€å¸°ç„¡ä»®èª¬ã¯æ¬¡ã®å½¢ã«ãªã‚Šã¾ã™ã€‚

$$
H_0: Î¼_1= \ldots =Î¼_K
$$

,

ã“ã“ã§ $Î¼_k$ ã¯ $k^{th}$ æ¸¬å®šã®å¹³å‡ã§ã™ã€‚

$$
K=2
$$

ã®å ´åˆã€ãƒ†ã‚¹ãƒˆã¯ [McNemar ãƒ†ã‚¹ãƒˆ](https://en.wikipedia.org/wiki/McNemar's_test) ã«ç°¡ç•¥åŒ–ã•ã‚Œã€ã“ã‚Œã¯äºŒé …ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¼ãƒ­ã¨1ï¼‰ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã‚‹ç¹°ã‚Šè¿”ã—æ¸¬å®šã®ãŸã‚ã® Student ã® t ãƒ†ã‚¹ãƒˆã«é¡žä¼¼ã—ã¦ã„ã¾ã™ã€‚

å…¥åŠ› `table` ã¯ $N \cdot K$ ã®ã‚¼ãƒ­ã¨1ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã‚ã‚Šã€$N$ ã¯è¦³å¯Ÿã®æ•°ã€$K$ ã¯ç¹°ã‚Šè¿”ã—æ¸¬å®šã§ã™ã€‚è»¢ç½®ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã«ãªã‚Šã¾ã™ã€‚

| 1 | 1 | 1 | 1 | 1 | 1 | æ¸¬å®š 1

| 1 | 0 | 1 | 1 | 0 | 1 | æ¸¬å®š 2

| 0 | 0 | 1 | 0 | 1 | 0 | æ¸¬å®š 3

ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€`table=[1 1 0; 1 0 0; 1 1 1; 1 1 0; 1 0 1; 1 1 0]` ã®ã‚ˆã†ã«å…¥åŠ›ã¨ã—ã¦ä¸Žãˆã‚‰ã‚Œã€å†…éƒ¨çš„ã«é–¢æ•° [`table2vec`](@ref) ã«ã‚ˆã£ã¦é©åˆ‡ãªå½¢å¼ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚

!!! note "å†—é•·ãªç½®æ›"
    ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä»»æ„ã®çµ„ã¿åˆã‚ã›ã§ãƒ™ã‚¯ãƒˆãƒ« `[0 0 0]` ã¾ãŸã¯ `[1 1 1]` ã‚’è¿½åŠ ã™ã‚‹ã¨ã€ç³»çµ±çš„ãªç½®æ›ã‚’ä½¿ç”¨ã—ã¦ã‚‚åŒã˜ p å€¤ãŒå¾—ã‚‰ã‚Œã¾ã™ãŒã€ãƒªã‚¹ãƒˆã•ã‚Œã‚‹ç½®æ›ã®æ•°ãŒå¢—åŠ ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã«ãã®ã‚ˆã†ãªãƒ™ã‚¯ãƒˆãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã€å‰Šé™¤ã—ã¦ãƒ†ã‚¹ãƒˆã‚’é«˜é€ŸåŒ–ã§ãã¾ã™ã€‚


ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•° `direction`ã€`equivalent`ã€`switch2rand`ã€`nperm`ã€`seed`ã€ãŠã‚ˆã³ `verbose` ã«ã¤ã„ã¦ã¯ã€[ã“ã¡ã‚‰](@ref "Common kwargs for univariate tests")ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[Cochran Q](https://en.wikipedia.org/wiki/Cochran's_Q_test) ãŠã‚ˆã³ [McNemar](https://en.wikipedia.org/wiki/McNemar's_test) ã®æ¼¸è¿‘çš„ãƒ†ã‚¹ãƒˆã¨ã¯å¯¾ç…§çš„ã«ã€ç½®æ›ãƒ†ã‚¹ãƒˆã§ã¯ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯å¤§ããã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å®Ÿéš›ã€å¤§ããªã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®å ´åˆã€Cochran Q ãŠã‚ˆã³ McNemar ãƒ†ã‚¹ãƒˆã¯ã‚ˆã‚ŠåŠ¹çŽ‡çš„ã§ã™ãŒã€æ­£ç¢ºãª p å€¤ã‚’æä¾›ã—ã¾ã›ã‚“ï¼ˆ$K=2$ ã®å ´åˆã®æ­£ç¢ºãªãƒ†ã‚¹ãƒˆã¯å°Žå‡ºå¯èƒ½ã§ã™ï¼‰ã€‚å…¨ä½“ã¨ã—ã¦ã€ã“ã®ç½®æ›ãƒ†ã‚¹ãƒˆã¯æ¨™æº–ã® Cochran Q ãŠã‚ˆã³ McNemar ãƒ†ã‚¹ãƒˆã¨æ¯”è¼ƒã—ã¦ã‚ã¾ã‚Šæœ‰ç”¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ãã®å¤šé‡æ¯”è¼ƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ãƒ‡ãƒ¼ã‚¿ã®ç½®æ›ã«ã‚ˆã£ã¦å®¶æ—å˜ä½ã®èª¤ã‚ŠçŽ‡ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

*æ–¹å‘æ€§ãƒ†ã‚¹ãƒˆ*

$$
ð¾=2
$$

ã®å ´åˆã®ã¿å¯èƒ½ã§ã€ã“ã®å ´åˆãƒ†ã‚¹ãƒˆã¯ MnNemar ãƒ†ã‚¹ãƒˆã«ç°¡ç•¥åŒ–ã•ã‚Œã€ãƒ†ã‚¹ãƒˆã®æ–¹å‘æ€§ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•° `direction` ã«ã‚ˆã£ã¦ä¸Žãˆã‚‰ã‚Œã¾ã™ã€‚é–¢æ•° [`mcNemarTest`](@ref) ãŠã‚ˆã³ãã®å¤šé‡æ¯”è¼ƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ [`mcNemarMcTest`](@ref) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

*ç½®æ›ã‚¹ã‚­ãƒ¼ãƒ :* ç¹°ã‚Šè¿”ã—æ¸¬å®šã® 1-way ANOVA ã® F çµ±è¨ˆé‡ã¯ã€Cochran Q ãƒ†ã‚¹ãƒˆã®åŒç­‰ã®ãƒ†ã‚¹ãƒˆçµ±è¨ˆé‡ã§ã‚ã‚Šã€ãã® ANOVA ã®ç½®æ›ã‚¹ã‚­ãƒ¼ãƒ ãŒé©ç”¨ã•ã‚Œã¾ã™ï¼ˆ[`anovaTestRM`](@ref) ã‚’å‚ç…§ï¼‰ã€‚$K=2$ ã®å ´åˆï¼ˆMcNemar ãƒ†ã‚¹ãƒˆï¼‰ã®ç½®æ›ã‚¹ã‚­ãƒ¼ãƒ ã¯åŒã˜ã§ã™ã€‚

*æ­£ç¢ºãªãƒ†ã‚¹ãƒˆã®ãŸã‚ã®ç½®æ›ã®æ•°:* $K!^N$ é€šã‚Šã®æ–¹æ³•ã§ã€ã™ã¹ã¦ã® $N$ è¦³å¯Ÿå˜ä½ã«ãŠã‘ã‚‹ $K$ æ¸¬å®šã‚’å†é…ç½®ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

*ã‚¨ã‚¤ãƒªã‚¢ã‚¹:* `qTest`, `mcNemarTest`

*å¤šé‡æ¯”è¼ƒãƒãƒ¼ã‚¸ãƒ§ãƒ³:* [`cochranqMcTest`](@ref), [`mcNemarMcTest`](@ref)

[UniTest](@ref) æ§‹é€ ã‚’è¿”ã—ã¾ã™ã€‚

*ä¾‹*

```julia
using PermutationTests
table=[1 1 0; 1 0 0; 1 1 1; 1 1 0; 1 0 1; 1 1 0]
t=qTest(table) # ãƒ†ã‚¹ãƒˆã¯åŒæ–¹å‘ã§ã™
```
