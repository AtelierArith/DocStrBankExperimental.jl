```julia
function chiSquaredTest(table::Matrix{I};
            direction::TestDir = Both(),
            equivalent::Bool = true,
            switch2rand::Int = Int(1e8),
            nperm::Int = 20_000, 
            seed::Int = 1234, 
            verbose::Bool = true,
            asPearson::Bool = true) where {I <: Int, TestDir <: TestDirection}

```

å˜å¤‰é‡ [ã‚«ã‚¤äºŒä¹—](https://en.wikipedia.org/wiki/Chi-squared_test) ($\chi^2$) ã®ç½®æ›æ¤œå®šã¯ã€$2 \cdot K$ ã®ã‚³ãƒ³ãƒ†ã‚£ãƒ³ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã—ã¦è¡Œã‚ã‚Œã€ã“ã“ã§ $K$ ã¯ â‰¥2 ã§ã™ã€‚å¸°ç„¡ä»®èª¬ã¯æ¬¡ã®å½¢ã‚’æŒã¡ã¾ã™ã€‚

$$
H_0: O=E
$$

,

ã“ã“ã§ $O$ ã¨ $E$ ã¯ã‚³ãƒ³ãƒ†ã‚£ãƒ³ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¦³æ¸¬é »åº¦ã¨æœŸå¾…é »åº¦ã§ã™ã€‚

`table` ã¯æ•´æ•°ã®è¡Œåˆ—ã®å½¢ã§ä¸Žãˆã‚‰ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚£ãƒ³ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã™ã€‚ä¾‹ãˆã°ã€æ¬¡ã®ã‚³ãƒ³ãƒ†ã‚£ãƒ³ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã¯

| 0 | 2 | 3 | å¤±æ•— 

| 3 | 1 | 0 | æˆåŠŸ

ã¨ã—ã¦ä¸Žãˆã‚‰ã‚Œã¾ã™ã€‚

```julia
table=[0 2 3; 3 1 0]
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•° `direction`ã€`equivalent`ã€`switch2rand`ã€`nperm`ã€`seed`ã€ãŠã‚ˆã³ `verbose` ã«ã¤ã„ã¦ã¯ã€[ã“ã¡ã‚‰](@ref "Common kwargs for univariate tests")ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

$$
K=2
$$

ã®å ´åˆã€ã“ã®é–¢æ•°ã¯ [`studentTestIS`](@ref) ã‚’å‘¼ã³å‡ºã—ã€å¼•æ•° `asPearson` ã‚‚æ¸¡ã—ã¾ã™ã€‚ãã‚Œä»¥å¤–ã®å ´åˆã¯ [`anovaTestIS`](@ref) ã‚’å‘¼ã³å‡ºã—ã€å¼•æ•° `asPearson` ã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚

ãƒ”ã‚¢ã‚½ãƒ³ã®æ¼¸è¿‘çš„ $\chi^2$ ã¨å¯¾ç…§çš„ã«ã€ç½®æ›æ¤œå®šã§ã¯ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯å¤§ããã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å®Ÿéš›ã€å¤§ããªã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®å ´åˆã€ãƒ”ã‚¢ã‚½ãƒ³ã®æ¤œå®šã®æ–¹ãŒåŠ¹çŽ‡çš„ã§ã™ã€‚å°ã•ãªã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®å ´åˆã€på€¤ã¯ã™ã¹ã¦ã®å¯èƒ½ãªç½®æ›ã‚’ä½¿ç”¨ã—ã¦å¾—ã‚‹ã“ã¨ãŒã§ãã€ã—ãŸãŒã£ã¦æ­£ç¢ºã§ã‚ã‚Šã€[ãƒ•ã‚£ãƒƒã‚·ãƒ£ãƒ¼ã®æ­£ç¢ºæ¤œå®š](https://en.wikipedia.org/wiki/Fisher%27s_exact_test)ã‚’ä½¿ç”¨ã—ã¦å¾—ã‚‰ã‚Œã‚‹på€¤ã¨åŒã˜ã«ãªã‚Šã¾ã™ã€‚

ã—ãŸãŒã£ã¦ã€ã“ã®ç½®æ›æ¤œå®šã¯æ¨™æº–ã® $\chi^2$ ãŠã‚ˆã³ãƒ•ã‚£ãƒƒã‚·ãƒ£ãƒ¼ã®æ­£ç¢ºæ¤œå®šã¨æ¯”è¼ƒã—ã¦ç‰¹ã«æœ‰ç”¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ãã®å¤šé‡æ¯”è¼ƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ãƒ‡ãƒ¼ã‚¿ã®ç½®æ›ã‚’é€šã˜ã¦å®¶æ—å…¨ä½“ã®èª¤ã‚ŠçŽ‡ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

*æ–¹å‘æ€§æ¤œå®š*

$$
ð¾=2
$$

ã®å ´åˆã®ã¿å¯èƒ½ã§ã‚ã‚Šã€ã“ã®å ´åˆã€æ¤œå®šã¯ãƒ•ã‚£ãƒƒã‚·ãƒ£ãƒ¼ã®æ­£ç¢ºæ¤œå®šã«ç°¡ç•¥åŒ–ã•ã‚Œã€æ¤œå®šã®æ–¹å‘æ€§ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•° `direction` ã«ã‚ˆã£ã¦ä¸Žãˆã‚‰ã‚Œã¾ã™ã€‚é–¢æ•° [`fisherExactTest`](@ref) ã¨ãã®å¤šé‡æ¯”è¼ƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ [`fisherExactMcTest`](@ref) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

*ç½®æ›ã‚¹ã‚­ãƒ¼ãƒ :* ã‚³ãƒ³ãƒ†ã‚£ãƒ³ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å„åˆ—ã®åˆè¨ˆã«å¿œã˜ãŸè¦³æ¸¬å€¤ã‚’ä¿æŒã™ã‚‹ $K$ ã®ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚ã“ã®å¤‰æ›ã¯å†…éƒ¨çš„ã«é–¢æ•° [`table2vec`](@ref) ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã™ã€‚ãƒ™ã‚¯ãƒˆãƒ«ã®è¦ç´ ã¯ã€å¯¾å¿œã™ã‚‹åˆ—ã®2ã¤ã®ã‚»ãƒ«ã®ã‚«ã‚¦ãƒ³ãƒˆã¨åŒã˜æ•°ã®ã‚¼ãƒ­ã¨1ã§ã™ã€‚ç‹¬ç«‹ã‚µãƒ³ãƒ—ãƒ«ã®1-way ANOVAã®Fçµ±è¨ˆé‡ã¯ã€$\chi^2$ ã®åŒç­‰ã®æ¤œå®šçµ±è¨ˆé‡ã¨ãªã‚Šã€ãã®ANOVAã®ç½®æ›ã‚¹ã‚­ãƒ¼ãƒ ãŒé©ç”¨ã•ã‚Œã¾ã™ï¼ˆ[`anovaTestIS`](@ref) ã‚’å‚ç…§ï¼‰ã€‚

*æ­£ç¢ºãªæ¤œå®šã®ãŸã‚ã®ç½®æ›ã®æ•°:* å¯èƒ½ãªç½®æ›ã®æ•°ã¯ $\frac{N!}{N_1 \cdot\ldots\cdot N_K}$ ã§ã‚ã‚Šã€ã“ã“ã§ $K$ ã¯ã‚³ãƒ³ãƒ†ã‚£ãƒ³ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆ—ã®æ•°ã€$N_k$ ã¯ $k^{th}$ åˆ—ã®åˆè¨ˆã§ã™ã€‚

*ã‚¨ã‚¤ãƒªã‚¢ã‚¹:* `Î§Â²Test`ã€[`fisherExactTest`](@ref)

*å¤šé‡æ¯”è¼ƒãƒãƒ¼ã‚¸ãƒ§ãƒ³:* [chiSquaredMcTest](@ref)

[UniTest](@ref) æ§‹é€ ã‚’è¿”ã—ã¾ã™ã€‚

*ä¾‹*

```julia
using PermutationTests
table=[0 2 2; 3 1 0]
t=Î§Â²Test(table) # æ¤œå®šã¯åŒæ–¹å‘ã§ã™
```

```julia
table=[6 1; 2 5]
tR=fisherExactTest(table; direction=Right()) 
# ã¾ãŸã¯ tR=Î§Â²Test(table; direction=Right())
```
