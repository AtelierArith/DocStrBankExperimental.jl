```
ticr!(net::HybridNetwork, df::DataFrame, optbl::Bool; quartetstat, test)
ticr!(net::HybridNetwork, dcf::DataCF,   optbl::Bool; quartetstat, test)
ticr(dcf::DataCF, quartetstat::Symbol, test::Symbol)
```

多種ネットワークコアレセントの適合度検定で、特定の集団または種のネットワークがクワーテットの一致係数データを適切に説明しているかどうかを確認します。方法についてはStenz et al 2015および[付録](http://www.stat.wisc.edu/~ane/publis/2015Stenz_TICR_addendum.pdf)を参照してください。TICRという頭字語は、Rを用いた木の不一致チェックを意味します。

木/ネットワークはコアレセント単位の枝長を持ち、レベル1でなければなりません。枝長が0であっても「主要な」クワーテットが明確に定義されるように、完全に解決されている必要があります。

ディリクレ分布は、観測されたクワーテット一致係数（CF）の分布をフィットさせるために使用され、集中パラメータはデータから推定されます。

4つのタクソンセットは、外れ値p値に応じてカテゴリにビン分けされます：`0-0.01`、`0.01-0.05`、`0.05-0.10`、および`0.10-1`。最後に、これらのビン分けされた頻度に対して片側の適合度検定が実施され、期待される5%のp値が0.05未満（5%を超える場合）から逸脱しているかどうかを判断します。デフォルトでは`test = :onesided`が使用されます。あるいは、`test = :goodness`オプションは、Stenz et al. (2015)によって提案された全体の適合度カイ二乗検定を実行し、すべての4つのビンにわたる期待される頻度（0.01、0.04、0.05、0.90）からの逸脱をテストします。

  * 最初のバージョンは、各行が特定の4タクソンセットに対応する`DataFrame`を受け取ります。このデータフレームは、各4タクソンセットに対応する外れ値p値を含む追加の列を持つように修正されます。
  * 2番目のバージョンは`DataCF`オブジェクトを受け取り、そのオブジェクトに格納されている期待される一致係数を更新することによって修正します。
  * 最後のバージョン（他のすべてが呼び出すもの）は、`DataCF`オブジェクト内の期待される一致係数がテストネットワークから正しく計算されていると仮定します。

# 引数

  * `optbl`: `false`の場合、`net`のloglikフィールドが更新されますが、枝長はそのまま使用されます。`true`の場合、テストを実施するために`net`のコピーが使用され、更新された枝長（コアレセント単位）と更新されたloglikが適用されます。このネットワークが返されます。
  * `quartetstat = :maxCF`: 各4タクソンセットの外れ値p値を取得するために使用される検定統計量。デフォルトでは、`quartetstat=:maxCF`の場合、観測されたCFと主要解像度の期待されるCF（最大CFを持つ）の絶対差です。もう一つのオプションは`quartetstat=:minpval`で、この場合、観測されたCFと期待されるCFの絶対差がすべての3つの解像度について計算され、3つの（非独立な）p値が得られます。特定の4タクソンセットの外れ値p値は、これら3つのp値の最小値として取られます。このオプションは、特定の4タクソンセットに対するネットワークモデルからのあらゆる種類の逸脱を検出できますが、非常にリベラルであるため推奨されません。
  * `test = :onesided`: ビン分けされたクワーテット外れ値p値の頻度に対して実施される全体の適合度検定；上記を参照してください。

# 出力

1. 全体の適合度検定のp値
2. 検定統計量（z値）
3. 各4つのカテゴリにおけるp値のカウントの辞書
4. ディリクレ分布のための2つの検定パラメータのベクトル：

      * 集中パラメータαの値
      * 擬似尤度の値（αで最適化）
5. 各4タクソンセットに対する外れ値p値のベクトル
6. ネットワーク（最初と2番目のバージョン）：`optbl`がfalseの場合はloglikフィールドが更新された`net`；`optbl`がtrueの場合は最適化された枝長とloglikを持つ`net`のコピー

# 参考文献

NWM Stenz, B Larget, DA Baum and C Ané (2015). ゲノム配列を使用して木のようなパターンと非木のようなパターンを探る：植物種*Arabidopsis thaliana* (L.) Heynh.の例。Systematic Biology, 64(5):809-823. doi: [10.1093/sysbio/syv039](https://doi.org/10.1093/sysbio/syv039)

この[付録](http://www.stat.wisc.edu/~ane/publis/2015Stenz_TICR_addendum.pdf)も参照してください。 ```
