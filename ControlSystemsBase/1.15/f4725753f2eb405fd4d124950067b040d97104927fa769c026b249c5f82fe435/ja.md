```
sysr, G, T = baltrunc(sys::StateSpace; atol = √ϵ, rtol=1e-3, n = nothing, residual = false)
```

システム sys のバランス実現を計算することによって状態次元を削減し、バランスされたシステムの可観測性および到達性グラミアンが等しく対角行列 `diagm(G)` であり、順序 `n` に切り詰められます。`n` が指定されていない場合、`atol` より小さい特異値および `rtol σmax` より小さい特異値に対応するすべての状態が削除されるように選択されます。

`T` は古い状態 `x` と新しい状態 `z` の間の射影行列であり、`z = Tx` となります。一般に、`T` は非正方行列です。

`residual = true` の場合、マッチした静的ゲインは「残差化」を通じて達成されます。すなわち、次のように設定されます。

$$
0 = A_{21}x_{1} + A_{22}x_{2} + B_{2}u
$$

ここで、インデックス 1/2 はそれぞれ残りの状態/切り詰められた状態に対応します。

`gram`、`balreal` も参照してください。

Glad, Ljung, Reglerteori: Flervariabla och Olinjära metoder.

より高度なモデル削減については、[RobustAndOptimalControl.jl - Model Reduction](https://juliacontrol.github.io/RobustAndOptimalControl.jl/dev/#Model-reduction) を参照してください。

# 拡張ヘルプ

注意: グラミアン計算は入力-出力スケーリングに敏感です。数値的バランスの結果、グラミアン計算または MIMO システムの切り詰めが意味を持つためには、システムの入力と出力が意味のある方法でスケーリングされている必要があります。一般的な（ただし唯一ではない）アプローチは次のとおりです。

  * 出力は、最大許容制御誤差、最大期待参照変動、または最大期待変動が単位1になるようにスケーリングされます。
  * 入力変数は、絶対値が1になるようにスケーリングされます。これは、各変数をその最大期待または許可された変化で割ることによって行われます。すなわち、$u_{scaled} = u / u_{max}$

このようなスケーリングがない場合、バランスの結果は入力および出力信号を測定するために使用される単位に依存します。たとえば、ある出力の単位をメートルからミリメートルに変更すると、この出力は1000倍重要になります。
