```
calculatesignal_graham_ode(α, TRF, TR, ω0, B1, m0s, R1f, R2f, Rx, R1s, T2s[; grad_list, Ncyc=2, output=:complexsignal])
```

グラハムのスペクトルモデルを用いて、スーパーローレンツィアンラインシェイプを仮定した信号または磁化の進化を計算します。

シミュレーションは、異なるフリップ角αとRFパルスの持続時間TRFを持つ矩形RFパルスのシーケンスを仮定しますが、繰り返し時間TRは固定されています。さらに、バランスの取れた勾配モーメントを仮定します。

# 引数

  * `α::Vector{Real}`: ラジアンでのフリップ角の配列
  * `TRF::Vector{Real}`: 秒単位のRFパルスの持続時間の配列
  * `TR::Real`: 秒単位の繰り返し時間
  * `ω0::Real`: オフレゾナンス周波数（rad/s）
  * `B1::Real`: 正規化された送信B1フィールド、すなわちB1 = 1は適切にキャリブレーションされたB1フィールドに対応
  * `m0s::Real`: セミソリッドプールの分数サイズ; 0から1の範囲であるべき
  * `R1f::Real`: 自由プールの縦緩和率（1/秒）
  * `R2f::Real`: 自由プールの横緩和率（1/秒）
  * `Rx::Real`: 2つのスピンプール間の交換率（1/秒）
  * `R1s::Real`: セミソリッドプールの縦緩和率（1/秒）
  * `T2s::Real`: セミソリッドプールの横緩和時間（秒）

オプション:

  * `grad_list=()`: 計算される勾配を指定するタプル; タプルは空の`()`で勾配なし、または`grad_list=(grad_m0s(), grad_R1s(), grad_R2f(), grad_Rx(), grad_R1s(), grad_T2s(), grad_ω0(), grad_B1())`の任意の部分集合/順序を含むことができます; 見かけの`R1a = R1f = R1s`に関する導関数は`grad_R1a()`で計算できます
  * `Ncyc=2`: 磁化は熱平衡で初期化され、その後Ncyc回実行され、最後のサイクルのみが保存されます。デフォルト値は通常、反周期境界条件の良い近似です。計算時間のコストで精度を高めるために数を増やしてください。
  * `output=:complexsignal`: デフォルトのキーワードは関数に複素値信号（`xf + 1im yf`）を出力させます; キーワード`output=:realmagnetization`は全体の（実値の）ベクトル`[xf, yf, zf, xs, zs]`の出力をトリガーします

# 例

```jldoctest
julia> calculatesignal_graham_ode(ones(100)*π/2, ones(100)*5e-4, 4e-3, 0, 1, 0.2, 0.3, 15, 20, 2, 10e-6)
100×1 Matrix{ComplexF64}:
   -0.00807345119181352 + 0.0im
   0.001268643290482942 - 0.0im
 -0.0061786944372399285 + 0.0im
  0.0024358658178670984 - 0.0im
  -0.004437476277201395 + 0.0im
   0.003516464649840319 - 0.0im
 -0.0028315542520438736 + 0.0im
   0.004523902250379144 - 0.0im
 -0.0013422299483389865 + 0.0im
   0.005454562034842185 - 0.0im
                        ⋮
   0.018148222040953822 - 0.0im
    0.01795769661414946 + 0.0im
   0.018204860876661903 - 0.0im
    0.01802936310261858 + 0.0im
    0.01825782014256292 - 0.0im
   0.018096168912467753 + 0.0im
   0.018307337729977783 - 0.0im
    0.01815844450117701 + 0.0im
   0.018353636229654767 - 0.0im

julia> calculatesignal_graham_ode(ones(100)*π/2, ones(100)*5e-4, 4e-3, 0, 1, 0.2, 0.3, 15, 20, 2, 10e-6; grad_list=(grad_R1f(), grad_T2s()), output=:realmagnetization)
100×15 transpose(::Matrix{Float64}) with eltype Float64:
 -0.0080756    0.0   0.000643162  …   0.0   -10.4986  -323.634  0.0
  0.00126867  -0.0  -0.00710692      -0.0   123.078   -316.358  0.0
 -0.00618067   0.0   0.00186482       0.0   -29.4458  -307.862  0.0
  0.00243634  -0.0  -0.0052899       -0.0    94.1692  -300.821  0.0
 -0.00443746   0.0   0.00298646       0.0   -46.1422  -294.116  0.0
  0.00351386  -0.0  -0.00361718   …  -0.0    68.262   -289.421  0.0
 -0.00282882   0.0   0.00402793       0.0   -61.0236  -285.242  0.0
  0.00451808  -0.0  -0.00206741      -0.0    44.7888  -282.867  0.0
 -0.00133608   0.0   0.00499316       0.0   -74.4075  -280.79   0.0
  0.00544896  -0.0  -0.00062663      -0.0    23.2536  -280.148  0.0
  ⋮                               ⋱
  0.0181755   -0.0   0.0179431       -0.0  -285.071   -337.48   0.0
  0.0179911    0.0   0.0181963        0.0  -289.591   -337.634  0.0
  0.0182343   -0.0   0.018019        -0.0  -286.777   -337.804  0.0
  0.0180645    0.0   0.0182531        0.0  -290.964   -337.948  0.0
  0.0182893   -0.0   0.0180898    …  -0.0  -288.383   -338.106  0.0
  0.0181329    0.0   0.0183062        0.0  -292.261   -338.241  0.0
  0.0183407   -0.0   0.0181559       -0.0  -289.895   -338.39   0.0
  0.0181968    0.0   0.0183559        0.0  -293.488   -338.516  0.0
  0.0183888   -0.0   0.0182175       -0.0  -291.318   -338.656  0.0
```
