```
calculatesignal_gbloch_ide(α, TRF, TR, ω0, B1, m0s, R1f, R2f, Rx, R1s, T2s[; grad_list, Ncyc=2, output=:complexsignal])
```

信号または磁化の進化を、スーパーローレンツ線形を仮定した完全一般化ブロッホモデルで計算します（遅い）。

シミュレーションは、異なるフリップ角αとRFパルスの持続時間TRFを持つ矩形RFパルスのシーケンスを仮定しますが、繰り返し時間TRは固定です。さらに、バランスの取れた勾配モーメントを仮定します。

# 引数

  * `α::Vector{Real}`: ラジアンでのフリップ角の配列
  * `TRF::Vector{Real}`: 秒単位のRFパルスの持続時間の配列
  * `TR::Real`: 秒単位の繰り返し時間
  * `ω0::Real`: オフ共鳴周波数（rad/s）
  * `B1::Real`: 正規化された送信B1フィールド、すなわちB1 = 1は適切にキャリブレーションされたB1フィールドに対応
  * `m0s::Real`: セミソリッドプールの分数サイズ；0から1の範囲である必要があります
  * `R1f::Real`: 自由プールの縦緩和率（1/秒）
  * `R2f::Real`: 自由プールの横緩和率（1/秒）
  * `Rx::Real`: 2つのスピンプール間の交換率（1/秒）
  * `R1s::Real`: セミソリッドプールの縦緩和率（1/秒）
  * `T2s::Real`: セミソリッドプールの横緩和時間（秒）

オプション:

  * `grad_list=()`: 計算される勾配を指定するタプル；タプルは空の`()`で勾配なし、または`grad_list=(grad_m0s(), grad_R1s(), grad_R2f(), grad_Rx(), grad_R1s(), grad_T2s(), grad_ω0(), grad_B1())`の任意の部分集合/順序を含むことができます；見かけの`R1a = R1f = R1s`に関する導関数は`grad_R1a()`で計算できます
  * `Ncyc=2`: 磁化は熱平衡で初期化され、その後Ncyc回実行され、最後のサイクルのみが保存されます。デフォルト値は通常、反周期境界条件の良い近似です。計算時間のコストで精度を高めるために数を増やしてください。
  * `output=:complexsignal`: デフォルトのキーワードは関数に複素値信号（`xf + 1im yf`）を出力させます；キーワード`output=:realmagnetization`は全体の（実値の）ベクトル`[xf, yf, zf, xs, zs]`の出力をトリガーします
  * `greens=(greens_superlorentzian, dG_o_dT2s_x_T2s_superlorentzian)`: グリーン関数`G(κ) = G((t-τ)/T2s)`とそのT2sに関する偏導関数のタプルで、T2sで掛けられます`∂G((t-τ)/T2s)/∂T2s * T2s`。このパッケージは、3つのグリーン関数`greens=(greens_superlorentzian, dG_o_dT2s_x_T2s_superlorentzian)`（デフォルト）、`greens=(greens_lorentzian, dG_o_dT2s_x_T2s_lorentzian)`、および`greens=(greens_gaussian, dG_o_dT2s_x_T2s_gaussian)`を提供します。

# 例

```jldoctest
julia> calculatesignal_gbloch_ide(ones(100)*π/2, ones(100)*5e-4, 4e-3, 0, 1, 0.2, 0.3, 15, 20, 2, 10e-6)
100×1 Matrix{ComplexF64}:
  -0.007966316445310092 + 0.0im
  0.0012590590420428192 - 0.0im
  -0.006088855588249714 + 0.0im
   0.002418738940913121 - 0.0im
  -0.004361339394954344 + 0.0im
  0.0034891358222515403 - 0.0im
 -0.0027633710605856443 + 0.0im
   0.004483217942995644 - 0.0im
 -0.0012812573504847747 + 0.0im
    0.00540885403652597 - 0.0im
                        ⋮
   0.017760808273166742 - 0.0im
    0.01757611897551337 + 0.0im
    0.01781395094611674 - 0.0im
    0.01764385633643124 + 0.0im
   0.017863575856212052 - 0.0im
   0.017706926034820797 + 0.0im
   0.017909914934264796 - 0.0im
    0.01776565037417232 + 0.0im
   0.017953184893722073 - 0.0im

julia> calculatesignal_gbloch_ide(ones(100)*π/2, ones(100)*5e-4, 4e-3, 0, 1, 0.2, 0.3, 15, 20, 2, 10e-6; grad_list=(grad_R1f(), grad_T2s()), output=:realmagnetization)
100×15 transpose(::Matrix{Float64}) with eltype Float64:
 -0.00796627   0.0   0.000637773  …   0.0   -10.8757  -335.26   0.0
  0.00125903  -0.0  -0.00700671      -0.0   125.882   -326.977  0.0
 -0.00608882   0.0   0.00185086       0.0   -30.4187  -317.56   0.0
  0.00241873  -0.0  -0.00520622      -0.0    96.1776  -309.906  0.0
 -0.00436133   0.0   0.00296471       0.0   -47.5803  -302.948  0.0
  0.003489    -0.0  -0.00354518   …  -0.0    69.5148  -298.697  0.0
 -0.00276366   0.0   0.00399588       0.0   -62.8453  -294.886  0.0
  0.00448273  -0.0  -0.00200673      -0.0    45.3179  -292.783  0.0
 -0.00128187   0.0   0.00495478       0.0   -76.6573  -290.321  0.0
  0.00540814  -0.0  -0.000578836     -0.0    23.1756  -289.245  0.0
  ⋮                               ⋱
  0.0177563   -0.0   0.0175372       -0.0  -290.779   -349.855  0.0
  0.0175716    0.0   0.0177845        0.0  -295.347   -350.002  0.0
  0.0178094   -0.0   0.0176073       -0.0  -292.44    -350.163  0.0
  0.0176393    0.0   0.0178359        0.0  -296.668   -350.3    0.0
  0.017859    -0.0   0.0176727    …  -0.0  -294.001   -350.451  0.0
  0.0177024    0.0   0.0178838        0.0  -297.914   -350.579  0.0
  0.0179053   -0.0   0.0177335       -0.0  -295.467   -350.72   0.0
  0.0177611    0.0   0.0179286        0.0  -299.09    -350.84   0.0
  0.0179486   -0.0   0.0177902       -0.0  -296.845   -350.972  0.0
```
