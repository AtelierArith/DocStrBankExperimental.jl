# 適用/期間変換

```julia
apply(ts::TSFrame,
      period::T,
      fun::V,
      index_at::Function=first;
      renamecols::Bool=true)
     where {T<:Dates.Period, V <: Function}
```

`fun`を`ts`オブジェクトに`period`に基づいて適用し、正しくインデックスされた行を返します。このメソッドは、時間の期間にわたる集約を行うためや、`ts`を低い周波数のオブジェクト（例：日次系列から月次）に変換するために使用されます。

`period`は`Dates`モジュール内の任意の`Period`型です。低い周波数から高い周波数への変換は、補間が現在このメソッドで処理されていないため、エラーをスローします。

デフォルトでは、このメソッドは期間内のインデックスの最初の値を使用して、結果の集約オブジェクトをインデックス付けします。この動作は、`index_at`引数によって制御でき、`first`または`last`を入力として受け取ることができます。

# キーワード引数

  * `renamecols::Bool=true`: 結果のオブジェクト内の列名を変更するかどうか。`false`の場合、列名は`fun`の名前に基づいて自動的に生成され、それ以外の場合は既存の列名が使用されます。

# 例

```jldoctest; setup = :(using TSFrames, DataFrames, Dates, Random, Statistics)
julia> using Random, Statistics;
julia> random(x) = rand(MersenneTwister(123), x);
julia> dates = collect(Date(2017,1,1):Day(1):Date(2018,3,10));

julia> ts = TSFrame(random(length(dates)), dates)
julia> show(ts[1:10])
(10 x 1) TSFrame with Date Index

 Index       x1
 Date        Float64
───────────────────────
 2017-01-01  0.768448
 2017-01-02  0.940515
 2017-01-03  0.673959
 2017-01-04  0.395453
 2017-01-05  0.313244
 2017-01-06  0.662555
 2017-01-07  0.586022
 2017-01-08  0.0521332
 2017-01-09  0.26864
 2017-01-10  0.108871

julia> apply(ts, Month(1), first)
(15 x 1) TSFrame with Date Index

 Index       x1_first
 Date        Float64
───────────────────────
 2017-01-01  0.768448
 2017-02-01  0.790201
 2017-03-01  0.467219
 2017-04-01  0.783473
 2017-05-01  0.651354
 2017-06-01  0.373346
 2017-07-01  0.83296
 2017-08-01  0.132716
 2017-09-01  0.27899
 2017-10-01  0.995414
 2017-11-01  0.214132
 2017-12-01  0.832917
 2018-01-01  0.0409471
 2018-02-01  0.720163
 2018-03-01  0.87459

# 交互月
julia> apply(ts, Month(2), first)
(8 x 1) TSFrame with Date Index

 Index       x1_first
 Date        Float64
───────────────────────
 2017-01-01  0.768448
 2017-03-01  0.467219
 2017-05-01  0.651354
 2017-07-01  0.83296
 2017-09-01  0.27899
 2017-11-01  0.214132
 2018-01-01  0.0409471
 2018-03-01  0.87459


julia> ts_weekly = apply(ts, Week(1), Statistics.std) # 週ごとの標準偏差
julia> show(ts_weekly[1:10])
(10 x 1) TSFrame with Date Index

 Index       x1_std
 Date        Float64
────────────────────────
 2017-01-01  NaN
 2017-01-02    0.28935
 2017-01-09    0.270842
 2017-01-16    0.170197
 2017-01-23    0.269573
 2017-01-30    0.326687
 2017-02-06    0.279935
 2017-02-13    0.319216
 2017-02-20    0.272058
 2017-02-27    0.23651


julia> ts_weekly = apply(ts, Week(1), Statistics.std, last) # 週の最終日でインデックス付け
julia> show(ts_weekly[1:10])
(10 x 1) TSFrame with Date Index

 Index       x1_std
 Date        Float64
────────────────────────
 2017-01-01  NaN
 2017-01-08    0.28935
 2017-01-15    0.270842
 2017-01-22    0.170197
 2017-01-29    0.269573
 2017-02-05    0.326687
 2017-02-12    0.279935
 2017-02-19    0.319216
 2017-02-26    0.272058
 2017-03-05    0.23651

```
