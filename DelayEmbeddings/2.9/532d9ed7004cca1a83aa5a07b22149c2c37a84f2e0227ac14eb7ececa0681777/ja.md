```
uzal_cost(Y::StateSpaceSet; kwargs...) → L
```

入力データセット `Y` に対して Uzal et al.[^Uzal2011] に基づき、ノイズ増幅、再構成されたアトラクタの複雑さ、および無関係性測定を構成する局所的なストレッチの直接的な測定に関する理論的な議論に基づいて、L統計量 `L` を計算します。これは状態空間の軌道/埋め込みのコスト関数として機能し、したがって「埋め込みの良さ」を推定し、パラメータ空間で `L` を最小化しながら適切な埋め込みパラメータを選択することを可能にします。局所コスト関数 `L_local`（状態空間の各点に対して - 平均化されていない）を受け取るには、`uzal_cost_local(...)` を使用します。

## キーワード引数

  * `samplesize = 0.5`: 条件付き分散と近傍サイズを平均化するために、入力状態空間軌道 `Y` の長さの割合として考慮される基準点の数 `v`。
  * `K = 3`: σ_k^2 を計算するために考慮される最近傍の数。ベクトルが与えられた場合、すべての `k ∈ K` に対して最小結果が返されます。
  * `metric = Euclidean()`: 入力状態空間軌道 `Y` で最近傍を見つけるために使用されるメトリック。
  * `w = 1`: テイラーウィンドウ（点に近いインデックス `w` の時間的近傍が真の近傍から除外されます）。`w=0` は点自体のみを除外し、時間的近傍は除外しません。
  * `Tw = 40`: E_k^2 が計算され、平均化されるまでの時間のホライズン（サンプリング単位で）。

## 説明

`L`-統計量は、ノイズ増幅、再構成されたアトラクタの複雑さ、および無関係性測定を構成する局所的なストレッチの直接的な測定に関する理論的な議論に基づいています。技術的には、`σ`-統計量と正規化統計量 `α` の積の対数です：

L = log10(σ*α)

`σ`-統計量は次のように計算されます。`σ = √σ² = √(E²/ϵ²)`。`E²` は、`K` 最近傍を使用して、状態空間の各点での条件付き分散を近似します。状態空間軌道の各基準点に対して、近傍は基準点自体とその `K+1` 最近傍から構成されます。`E²` は、`T` 時間ステップの間に近傍がどれだけ強く拡大するかを測定します。`E²` は、多くの時間ホライズン `T = 1:Tw` にわたって平均化されます。したがって、`ϵ²` は基準点自体の近傍のサイズであり、近傍の平均ペアワイズ距離として定義されます。最後に、`σ²` はアトラクタ上の一連の基準点にわたって平均化され、これは `samplesize` によって制御されます。これはパフォーマンス上の理由からであり、最も正確な結果は明らかに `samplesize=1.0` に設定したときに得られます。

`α`-統計量は正規化因子であり、異なる埋め込みからの `σ` を比較できるようにします。`α²` は、考慮されたすべての基準点のすべての `ϵ²` の逆数の合計の逆数として定義されます。

[^Uzal2011]: Uzal, L. C., Grinblat, G. L., Verdes, P. F. (2011). [Optimal reconstruction of dynamical systems: A noise amplification approach. Physical Review E 84, 016223](https://doi.org/10.1103/PhysRevE.84.016223).

```
