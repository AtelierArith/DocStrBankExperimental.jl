```
garcia_almeida_embedding(s; kwargs...) → Y, τ_vals, ts_vals, FNNs ,NS
```

ガルシアとアルメイダの論文に基づいて、時間系列（`Vector`型）または時間系列のセット（`Dataset`型）を適切に埋め込むための統一アプローチです[^Garcia2005a],[^Garcia2005b]。

## キーワード引数

  * `τs= 0:50`: 可能な遅延値 `τs`（サンプリング時間単位）。各 `τs` に対して N 統計量が計算されます。
  * `w::Int = 1`: タイラーウィンドウ（点に近いインデックス `w` の時間的隣接点で、真の隣接点から除外される）。`w=0` は点自体のみを除外し、時間的隣接点は除外しません。
  * `r1 = 10`: d_E1 統計量の許容される伸びのファクターを定義する閾値。
  * `r2 = 2`: 埋め込み次元を増加させる際に、最も近い隣接点間の距離の許容される相対的増加の閾値。
  * `fnn_thres= 0.05`: アルゴリズムが終了し、埋め込み手続きを停止するために十分に小さな偽の近隣点の割合を定義する閾値（`0 ≤ fnn_thres < 1`）。
  * `T::Int = 1`: `d_E2` 統計量を計算するための前方時間ステップ（サンプリング単位）。論文ではこれは自由なパラメータではなく、常に `T=1` に設定されています。
  * `metric = Euclidean()`: 入力フェーズ空間軌道 `Y` で最も近い隣接点を見つけるために使用されるメトリック。
  * `max_num_of_cycles = 50`: アルゴリズムは、そのサイクル数の後に停止します。

## 説明

このメソッドは反復的に動作し、最終的な埋め込みベクトル `Y` を徐々に構築します。`N` 統計量に基づいて、アルゴリズムは各埋め込みサイクルの最初の局所最小値として最適な遅延値 `τ` を選択します。多変量埋め込みの場合、すなわち時間系列のセット（`s::Dataset`）を埋め込む場合、最適な遅延値 `τ` は、各埋め込みサイクルのすべての考慮された `N` 統計量の最初の最小値として選択されます。考慮される遅延値の範囲は `τs` で決定され、最も近い隣接点の検索にはタイラーウィンドウ `w` を考慮します。各埋め込みサイクルの後、FNN 統計量 `FNNs` [^Hegger1999][^Kennel1992] がチェックされ、この統計量が閾値 `fnn_thres` を下回ると、アルゴリズムは終了します。メソッドの実用性を高めるために、FNN 統計量 `FNNs` が増加した場合にもアルゴリズムは終了します。最終的な埋め込みベクトルは `Y`（`Dataset`）に保存されます。各埋め込みサイクルのために選択された遅延値は `τ_vals` に保存され、対応する遅延値のために選択された時間系列番号は `ts_vals` に保存されます。単変量埋め込み（`s::Vector`）の場合、`ts_vals` は長さ `τ_vals` の 1 のベクトルになります。なぜなら、選択する時間系列は単に 1 つだけだからです。この関数は、各埋め込みサイクルの `N` 統計量 `NS` を `Vector` の `Array` としても返します。

私たちは、実装によって論文の図を再現することができなかったことに注意してください（それでも私たちはそれが正しいものであると信じています）。

[^Garcia2005a]: Garcia, S. P., Almeida, J. S. (2005). [Nearest neighbor embedding with different time delays. Physical Review E 71, 037204](https://doi.org/10.1103/PhysRevE.71.037204).

[^Garcia2005b]: Garcia, S. P., Almeida, J. S. (2005). [Multivariate phase space reconstruction by nearest neighbor embedding with different time delays. Physical Review E 72, 027205](https://doi.org/10.1103/PhysRevE.72.027205).
