`(Ω, weights) = window_quadrature_weights(pts::Vector{Float64}, g; kwargs...)`

重み {α*j}*{j=1}^n を計算します。これにより、

H_{α}(ω) ≈ G(ω)

が成り立ちます。|ω| ≤ Ω の場合、デフォルトの Ω は連続ナイキスト周波数の90%に設定され、これは n/(4*(b-a)) です。Ω = O(n) の場合、現在のルーチンではこの計算は O(n³) のスケールになります。Ω が固定されていて n と共に増加しない場合、O(n log n) のスケールになります。

オブジェクト `g::G` はウィンドウ関数を表す任意の構造体であることができます。これは `./src/window.jl` の先頭で説明されているメソッドを実装する必要があります。

キーワード引数は次の通りです：

  * `solver = default_solver(pts)`: 重みを取得するために使用される数値的手法。詳細については論文を参照してくださいが、これは解決する必要があるランク欠損設計行列を持つ非常に大きな最小二乗問題です。オプションは次の通りです：
  * `KrylovSolver(::KrylovPreconditioner, pre_kernel::Type{K}, perturbation::Float64)`: これはデフォルトで、`Krylov.lsmr` を使用して重みを完全に行列フリーの方法で計算します。`::KrylovPreconditioner` オブジェクトは、これが正確であるために重要です。小さなデータサイズ（おそらく n ~ 5k 以下）の場合、デフォルトの `CholeskyPreconditioner()` が最良の選択肢です。しかし、より大きなデータサイズの場合は、`HMatrices.jl` を追加して `HMatrixPreconditioner(atol, lu_atol)` を使用することを検討してください。これにより、*はるかに*良いスケーリングが得られます。第二引数 `pre_kernel` は、前処理された線形システムを組み立てる際の内部詳細である*型*です。一般的に、1D では `SincKernel` を、2D 以上では `KaiserKernel` を使用することをお勧めします。最後に、`perturbation` は前処理された線形システムの別の内部詳細です。高い値は特定の前処理器をより安定させますが、収束を遅くします。デフォルトの選択肢として `1e-8` をお勧めします。カスタム `KrylovSolver` を使用するデモについては、例のファイルを参照してください。
  * `DenseSolver()`: 非一様フーリエ行列に対して単純な `qr(F, ColumnNorm())` を使用します。これはほとんどの場合最速のオプションにはなりませんが、探索やデバッグを行う人のために提供しています。
  * `SketchSolver()`: これは `LowRankApprox.jl` を必要とする拡張です。Ω が小さいか固定されていて n を増やす場合、フーリエ行列は有界ランクを持ち、NUFFT とスケッチング手法を使用することで、部分QRで迅速に重みを取得できます。これは良い前処理器を持つ `KrylovSolver` よりも速い場合もあれば、そうでない場合もあります。このオプションを選ぶべき状況はおそらく稀です。
  * `Ω = default_Ω(pts, g)`: 重みが解決しようとする最高周波数です。これはほとんどのウィンドウに対してナイキスト周波数の80%にデフォルト設定されていますが、重みのノルムが高すぎる場合は適応的に減少することがあります。以下のオプションを参照してください。D 次元の場合、D > 1 では `Ω` は D-タプルである必要があります。
  * `max_wt_norm = Inf`: 重みベクトルの最大許容ノルムです。このノルムはエイリアスバイアスの大きさに大きな影響を与えるため、時には小さなノルムと引き換えに `Ω` を減少させることが有利な場合があります。これが有限の値に設定され、計算された重みがそれを超える場合、`Ω` は `Ω .*= reduction_factor` として減少し、重みが再計算されます。
  * `reduction_factor = 0.9`: この量は、計算された重みが `max_wt_norm` を超えた場合に `Ω` をどれだけ積極的に縮小するかを決定します。これを大きくすると、重みの再計算コストを節約できるかもしれませんが、最終的な `Ω` が本来可能だったよりも低くなる可能性があります。
  * `verbose = true`: 出力を印刷するかどうか。
