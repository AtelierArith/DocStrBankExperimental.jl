```
κ² = coherence(d; n = length(d)÷10, noverlap = n÷2, window=hamming, method=:welch)
```

コヒーレンス関数の二乗の大きさを計算します。κ²が1に近いほど、出力信号のエネルギーが入力信号のエネルギーによって良く説明されていることを示します。κ² << 1は、システムが非線形であるか、強いノイズが出力エネルギーに寄与していることを示します。

  * κ: [`FRD`](@ref)の形式の二乗コヒーレンス関数。
  * `method`: `:welch`または`:corr`。`:welch`はウェルチ法を使用してパワースペクトル密度を推定し、`:corr`はコレログラムアプローチを使用します。`method = :corr`の場合、追加のキーワード引数`σ`は、FFTの前に推定された相関関数に適用されるガウスウィンドウの幅を決定します。`σ`が大きいほど、スムージングが少なくなります。

さらに[`coherenceplot`](@ref)も参照してください。

# 拡張ヘルプ:

信号モデル$y = Gu + v$に対して、κ²は次のように定義されます。

$$
κ(ω)^2 = \dfrac{S_{uy}}{S_{uu} S_{yy}} = \dfrac{|G(iω)|^2S_{uu}^2}{S_{uu} (|G(iω)|^2S_{uu}^2 + S_{vv})} = \dfrac{1}{1 + \dfrac{S_{vv}}{S_{uu}|G(iω)|^2}}
$$

ここから、$0 ≤ κ² ≤ 1$であり、ノイズエネルギー$S_{vv}$が入力による出力エネルギー$S_{uu}|G(iω)|^2$に比べて小さい場合、κ²は1に近いことが明らかです。
