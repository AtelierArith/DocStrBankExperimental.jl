```
importance_weights(obs::AbstractVector, pred::AbstractMatrix, R::AbstractMatrix)
```

与えられた観測、予測、およびノイズ共分散から重要度重みを計算します。データ同化に使用される場合、このアルゴリズムは「粒子バッチスムーザー」としても知られています。この実装は、Kristoffer AalstadによるPython実装から適応されています：

https://github.com/ealonsogzl/MuSA/blob/0c02b8dc25a0f902bf63099de68174f4738705f0/modules/filters.py#L169

元のドキュメント文字列：

入力：     obs: 観測ベクトル (m x 1 配列)     pred: 予測観測アンサンブル行列 (m x N 配列)     R: 観測誤差共分散「行列」 (m x 1 配列、またはスカラー) 出力：     w: 事後重み (N x 1 配列)     Neff: 有効サンプルサイズ 次元：     Nはアンサンブルメンバーの数、mは観測の数です。

ここでは、粒子フィルターのバッチスムーザー版である粒子バッチスムーザーを実装しました（すなわち、再サンプリングなしの粒子フィルター）、Margulis et al. (2015, doi: 10.1175/JHM-D-14-0177.1)で説明されています。このため、このルーチンは逐次データ同化を伴う粒子フィルタリングにも使用できます。このスキームは、事前の粒子（ディラックデルタ関数の混合物）表現を使用し、これをベイズの定理に直接適用することによって得られます。言い換えれば、これは事前を提案密度（重要度分布）として使用した重要度サンプリングの適用に過ぎません。また、これは一般化尤度不確実性推定（GLUE）技術（正式なガウス尤度を伴う）と同じであり、水文学で広く使用されています。

この特定のスキームは、観測誤差が加法的ガウスホワイトノイズ（時間と空間で相関のない）であると仮定しています。「logsumexp」トリックは、非常に大きなオーダーの差がある尤度の比を扱う際に発生する浮動小数点演算の潜在的な数値問題に対処するために使用されます。
