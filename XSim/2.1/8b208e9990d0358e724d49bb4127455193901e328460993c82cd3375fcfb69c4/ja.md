# クイックスタート

`QTL`の数を割り当てることで簡単にセットアップできます。

```
build_phenome(n_qtls ::Int64;
              args...)
```

## 引数

  * `n_qtls` : シミュレーションされた`QTL`の数。
  * `vg` : `QTL`の遺伝的（共）分散。
  * `ve` : `QTL`の残差（共）分散。
  * `h2` : シミュレーションされた形質の遺伝率。これにより残差（共）分散が定義されます。

## 例

単一形質

```jldoctest
julia> build_phenome(10)
--------- フェノームサマリー ---------
形質の数      : 1
遺伝率 (h2)     : [0.5]
QTLの数        : [10;;]
遺伝的（共）分散
 1.0
残差（共）分散
 1.0
QTL効果（最初の30 QTLのみ表示）
 -1.112
 -0.724
 -0.29
 -0.737
 -0.216
 -1.267
 -1.566
  1.603
 -0.537
 -0.156
```

追加情報を持つ多重形質

```jldoctest

julia> build_phenome(5;
                     n_traits = 2,
                     vg = [1.0 0.5
                           0.5 1.0],
                     h2 = [.1, .8])
--------- フェノームサマリー ---------
形質の数      : 2
遺伝率 (h2)     : [0.1, 0.8]
QTLの数        : [5 5]
遺伝的（共）分散
 1.0  0.5
 0.5  1.0
残差（共）分散
 9.0  0.0
 0.0  0.25
QTL効果（最初の30 QTLのみ表示）
  0.255   1.552
  0.595   0.648
 -0.146  -1.169
 -0.35   -0.659
 -0.342   0.064
```

────────────────────────────────────────────────────────────────

# ファイルまたはDataFrameによるフェノームの定義

フォーマットされたデータフレームまたはファイルへのパスを提供することでゲノムを定義します。

```
build_phenome(dt       ::DataFrame; args...)
build_phenome(filename ::String;    args...)
```

## 引数

  * `dt` : マーカー効果を指定する`eff_`プレフィックスの必要な列を持つ`DataFrame`。
  * `filename` : フェノーム情報を含むファイルへのファイルパス。

## `DataFrame`の例

```
4×7 DataFrame
 Row │ id      chr    bp       cM       MAF      eff_1    eff_2
     │ String  Int64  Int64    Float64  Float64  Float64  Float64
─────┼────────────────────────────────────────────────────────────
   1 │ snp 1       1  1818249     50.8      0.5      0.1      0.0
   2 │ snp 2       1  6557697     80.3      0.5      0.0     -0.3
   3 │ snp_3       2  2298800     39.2      0.5      0.2      0.0
   4 │ snp 4       2  5015698     66.3      0.5      0.0      0.5
```

## 例

ファイルパスによる

```jldoctest
julia> path = PATH("map")
julia> build_phenome(path, h2 = [0.3, 0.5])
```

またはデータフレームによる

```jldoctest
julia> using DataFrames
julia> data = CSV.read(path, DataFrame)
julia> build_phenome(data, h2 = [0.3, 0.5])

Vgは提供されておらず、QTL効果の共分散に設定されます
Veは提供されておらず、Vgとh2に基づいて設定されます
--------- フェノームサマリー ---------
形質の数      : 2
遺伝率 (h2)     : [0.3, 0.5]
QTLの数        : [2 2]
遺伝的（共）分散
  0.009  -0.005
 -0.005   0.11
残差（共）分散
 0.021  0.0
 0.0    0.11
QTL効果（最初の30 QTLのみ表示）
 0.1   0.0
 0.0  -0.3
 0.2   0.0
 0.0   0.5
```

────────────────────────────────────────────────────────────────

# すべての遺伝子効果の行列を提供することでフェノームを明示的に定義します。

```
build_phenome(effects ::Union{Array{Float64}, SparseMatrixCSC}; args...)
```

## 引数

  * `effects` : 個体とマーカーの次元を持つマーカー効果を格納する行列。

## 例

```jldoctest
julia> effects = [0.1  0.0
                  0.0 -0.3
                  0.2  0.0
                  0.0  0.5]
julia> build_phenome(effects)
Vgは提供されておらず、QTL効果の共分散に設定されます
遺伝率は提供されておらず、0.5に設定されます
Veは提供されておらず、Vgとh2に基づいて設定されます
--------- フェノームサマリー ---------
形質の数      : 2
遺伝率 (h2)     : [0.5, 0.5]
QTLの数        : [2 2]
遺伝的（共）分散
  0.009  -0.005
 -0.005   0.11
残差（共）分散
 0.009  0.0
 0.0    0.11
QTL効果（最初の30 QTLのみ表示）
 0.1   0.0
 0.0  -0.3
 0.2   0.0
 0.0   0.5
```

遺伝率などの追加情報を追加することも可能です。

```jldoctest
julia> build_phenome(effects,
                     vg=[1.0 0.5
                         0.5 1.0])
遺伝率は提供されておらず、0.5に設定されます
Veは提供されておらず、Vgとh2に基づいて設定されます
--------- フェノームサマリー ---------
形質の数      : 2
遺伝率 (h2)     : [0.5, 0.5]
QTLの数        : [2 2]
遺伝的（共）分散
 1.0  0.5
 0.5  1.0
残差（共）分散
 1.0  0.0
 0.0  1.0
QTL効果（最初の30 QTLのみ表示）
 0.1   0.0
 0.0  -0.3
 0.2   0.0
 0.0   0.5
```
