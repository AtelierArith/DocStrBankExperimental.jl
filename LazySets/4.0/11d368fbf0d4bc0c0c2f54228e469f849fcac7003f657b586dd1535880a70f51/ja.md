```
intersection(cpa::Union{CartesianProduct,CartesianProductArray},
             P::AbstractPolyhedron)
```

有限個の多面体集合の直積と多面体の交差を計算します。

### 入力

  * `cpa` – 有限個の多面体集合の直積
  * `P`   – 多面体

### 出力

有限個の多面体集合の直積。構造の詳細については、以下の*アルゴリズム*セクションを参照してください。

### 注意事項

`cpa`における多面体集合への制限は、実際に`P`と交差するブロックにのみ適用されます（詳細については以下の*アルゴリズム*セクションを参照してください）。他のすべてのブロックは交差の対象とはならず、同一のままです。

### アルゴリズム

アルゴリズムの基本的なアイデアは、`P`の制約のない次元を利用することです。一般性を失わずに、`cpa`が構造$X × Y × Z$を持ち、$Y$の次元のみが$P$で制約されていると仮定します。$P$の$Y$の次元への適切な射影を$P|_Y$と表すと、次の同等性が成り立ちます：

$$
    (X × Y × Z) ∩ P = X × (Y ∩ P|_Y) × Z
$$

$$
Y
$$

は依然として多くのブロックで構成される可能性があります。しかし、直積の構造的制約により、$P|_Y$が$Y$のブロックのいくつかの次元で依然として制約がない場合でも、この集合をさらに分解することはできません。これは次元の再構成を必要とします。この例を考えてみましょう：

$$
    Y := [0, 1] × [1, 2] × [2, 3]
    P|_Y := x₁ + x₃ ≤ 2
    Y ∩ P|_Y = 0 ≤ x₁ ∧ 1 ≤ x₂ ≤ 2 ∧ 2 ≤ x₃ ∧ x₁ + x₃ ≤ 2
$$

次元$x₂$の制約が他の部分から切り離されているにもかかわらず、最後の制約のために、直積はこれ以上分解できません。特に、この実装における結果$Y ∩ P|_Y$は多面体です。

次に、上記のアイデアの実装を説明します。まず、`P`が制約されている次元を特定します。次に、$Y$が最小次元を持つように$X × Y × Z$のブロック次元を特定します。最後に、$Y$を多面体に変換し、`P`の適切な射影と交差させます。 ```
