```julia
differences_between_bins(raw_data)

```

[`Crispulator.sequencing`](@ref) からの生データは、2つの DataFrame を返します。

1. `guide_data`: この DataFrame には、各ガイドのペアワイズのビンの組み合わせ間の正規化された頻度の log2 フォールド変化を含む、ガイドごとのレベルデータが含まれています。したがって、`n` ビンがある場合、$\frac{n!}{2(n-2)!}$ の組み合わせの log2 フォールド変化を計算します。
2. `gene_data`: この DataFrame には、同じ情報が遺伝子ごとにグループ化されています。最初の DataFrame からの log2 フォールド変化データを使用して、遺伝子ごとの平均 log2 フォールド変化を計算し、負のコントロールガイドの集団に対してこの遺伝子のガイドがどれだけ一貫してシフトしているかを測定するために、[マン・ホイットニー U検定](https://en.wikipedia.org/wiki/Mann-Whitney_U_test)を使用して p 値を計算します。（詳細については以下を参照）

典型的な 2 ビンの `guide_data` DataFrame には、以下の列が含まれています。

| 列名                     | 意味                                                                                                                                             |
|:---------------------- |:---------------------------------------------------------------------------------------------------------------------------------------------- |
| `gene`                 | このガイドがターゲットとする遺伝子の ID                                                                                                                          |
| `knockdown`            | 0 から 1 のスケールでのガイドの活性度、1 は完全なノックアウトを示します                                                                                                        |
| `barcodeid`            | この特定のガイドの ID                                                                                                                                   |
| `theo_phenotype`       | このガイドの期待される表現型、一般的には -1 から 1 のスケール                                                                                                             |
| `behavior`             | ターゲット遺伝子が不完全なノックダウンに対して線形またはシグモイド応答を示すかどうか（詳細については [`Crispulator.Library`](@ref) を参照）                                                          |
| `class`                | ターゲット遺伝子がどの表現型分布から引き出されたか（詳細については [`Crispulator.Library`](@ref) を参照）。スクリーニングパフォーマンスが評価される「グラウンドトゥルース」ラベルとして機能します。例：[`Crispulator.auprc`](@ref) |
| `initial_freq`         | トランスフェクション後のガイドの頻度（[`Crispulator.transfect`](@ref) を参照）                                                                                        |
| `counts_bin1`          | 最初のビンにおける各ガイドの生のリード数                                                                                                                           |
| `freqs_bin1`           | このビンにおける総リード数で割った各ガイドのリード数                                                                                                                     |
| `rel_freqs_bin1`       | 各ガイドの頻度を負のコントロールガイドの中央値の頻度で割ったもの                                                                                                               |
| `counts_bin2`          | 2 番目のビンにおける各ガイドの生のリード数                                                                                                                         |
| `freqs_bin2`           | このビンにおける総リード数で割った各ガイドのリード数                                                                                                                     |
| `rel_freqs_bin2`       | このビンにおける各ガイドの頻度を負のコントロールガイドの中央値の頻度で割ったもの                                                                                                       |
| `log2fc_bin2_div_bin1` | `bin2` と `bin1` の間の相対ガイド頻度の log2 フォールド変化、`log2(rel_freqs_bin2/rel_freqs_bin1)` に相当します                                                          |

典型的な `gene_data` DataFrame には、以下のデータが含まれています。

| 列名                           | 意味                                                                                                                                                     |
|:---------------------------- |:------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `gene`                       | この遺伝子の ID                                                                                                                                              |
| `class`                      | 上記を参照                                                                                                                                                  |
| `behavior`                   | 上記を参照                                                                                                                                                  |
| `mean_bin2_div_bin1`         | この遺伝子をターゲットとするすべてのガイドの間で、`bin1` から `bin2` への相対頻度の平均 log2 フォールド変化。$\frac{1}{k}\sum_k \text{log2fc_bin2_div_bin1}_k$ として計算されます。各遺伝子をターゲットとする $k$ ガイドのために |
| `pvalue_bin2_div_bin1`       | 非パラメトリックなマン・ホイットニー U 検定によって計算された、この遺伝子をターゲットとするすべてのガイドの log2 フォールド変化の -log10 p 値。log2 フォールド変化の一貫性の尺度[^1]                                               |
| `absmean_bin2_div_bin1`      | 遺伝子ごとの `mean_bin2_div_bin1` の絶対値                                                                                                                       |
| `pvalmeanprod_bin2_div_bin1` | 遺伝子ごとの `mean_bin2_div_bin1` と `pvalue_bin2_div_bin1` の積                                                                                                |

# さらなる読み物

[^1]: Kampmann M, Bassik MC, Weissman JS. 統合プラットフォームによる全ゲノムスクリーニングと哺乳類細胞における高密度遺伝的相互作用マップの構築。*Proc Natl Acad Sci U S A*. 2013;110:E2317–26.
