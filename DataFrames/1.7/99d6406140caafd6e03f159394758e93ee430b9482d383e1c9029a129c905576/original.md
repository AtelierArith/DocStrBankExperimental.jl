```
insertcols(df::AbstractDataFrame[, col], (name=>val)::Pair...;
           after::Bool=false, makeunique::Bool=false, copycols::Bool=true)
```

Insert a column into a copy of `df` data frame using the [`insertcols!`](@ref) function and return the newly created data frame.

If `col` is omitted it is set to `ncol(df)+1` (the column is inserted as the last column).

# Arguments

  * `df` : the data frame to which we want to add columns
  * `col` : a position at which we want to insert a column, passed as an integer or a column name (a string or a `Symbol`); the column selected with `col` and columns following it are shifted to the right in `df` after the operation
  * `name` : the name of the new column
  * `val` : an `AbstractVector` giving the contents of the new column or a value of any type other than `AbstractArray` which will be repeated to fill a new vector; As a particular rule a values stored in a `Ref` or a `0`-dimensional `AbstractArray` are unwrapped and treated in the same way
  * `after` : if `true` columns are inserted after `col`
  * `makeunique` : defines what to do if `name` already exists in `df`; if it is `false` an error will be thrown; if it is `true` a new unique name will be generated by adding a suffix
  * `copycols` : whether vectors passed as columns should be copied

If `val` is an `AbstractRange` then the result of `collect(val)` is inserted.

If `df` is a `SubDataFrame` then it must have been created with `:` as column selector (otherwise an error is thrown). In this case the `copycols` keyword argument is ignored (i.e. the added column is always copied) and the parent data frame's column is filled with `missing` in rows that are filtered out by `df`.

If `df` isa `DataFrame` that has no columns and only values other than `AbstractVector` are passed then it is used to create a one-element column. If `df` isa `DataFrame` that has no columns and at least one `AbstractVector` is passed then its length is used to determine the number of elements in all created columns. In all other cases the number of rows in all created columns must match `nrow(df)`.

Metadata: this function preserves table-level and column-level `:note`-style metadata.

See also [`insertcols!`](@ref).

# Examples

```jldoctest
julia> df = DataFrame(a=1:3)
3×1 DataFrame
 Row │ a
     │ Int64
─────┼───────
   1 │     1
   2 │     2
   3 │     3

julia> insertcols(df, 1, :b => 'a':'c')
3×2 DataFrame
 Row │ b     a
     │ Char  Int64
─────┼─────────────
   1 │ a         1
   2 │ b         2
   3 │ c         3

julia> insertcols(df, :c => 2:4, :c => 3:5, makeunique=true)
3×3 DataFrame
 Row │ a      c      c_1
     │ Int64  Int64  Int64
─────┼─────────────────────
   1 │     1      2      3
   2 │     2      3      4
   3 │     3      4      5

julia> insertcols(df, :a, :d => 7:9, after=true)
3×2 DataFrame
 Row │ a      d
     │ Int64  Int64
─────┼──────────────
   1 │     1      7
   2 │     2      8
   3 │     3      9
```
