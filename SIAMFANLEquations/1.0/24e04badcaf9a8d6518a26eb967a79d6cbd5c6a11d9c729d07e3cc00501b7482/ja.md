ptcsolsc(f, x0, fp=difffp; rtol=1.e-6, atol=1.e-12, maxit=100,         delta0=1.e-6, dx=1.e-7, pdata=nothing, printerr = true, keepsolhist=true)

C. T. Kelley, 2022

スカラー擬似過渡継続ソルバー。PTCは、次の安定した定常状態の解を見つけるために設計されています。

dx/dt = - f(x)

スカラーコードは、システム用のPTCソルバーであるptcsol.jlへの呼び出しの単純なラッパーです。

–> PTCは絶対に一般目的の非線形ソルバーではありません。

入力:

f: 関数

x: 初期反復/データ

fp: 導関数。導関数がfpである場合、その名前を教えてください。たとえば、fp=foobarは、foobarが導関数のための関数であることを示します。デフォルトは、私が提供する前方差分ヤコビアンです。

キーワード引数:

rtol, atol: 実数および絶対誤差許容値

maxit: 非線形反復の最大数の上限。これはdelta0に結びついています。delta0の選択が小さすぎる（保守的）場合、収束するために多くの反復が必要になり、maxitの値を大きくする必要があります。

delta0: 初期擬似時間ステップ。デフォルト値の1.e-3は少し保守的で、実際に試すべきオプションの1つです。私が1.0に設定した例を見てください！

dx: デフォルト = 1.e-7

有限差分導関数における差分増分       h=dx*norm(x)+1.e-6

pdata:

関数/導関数のための事前計算データ。このオプションを使用すると、関数/導関数内のグローバル変数にデータを隠すよりも、うまくいきます。このオプションを使用する場合、関数と導関数はpdataを2番目の引数として受け取る必要があります。例: f(x,pdata) および fp(x,pdata)

printerr: デフォルト = true

ソルバーが失敗したときに役立つメッセージを印刷します。そのメッセージを抑制するには、printerrをfalseに設定します。

keepsolhist: trueの場合、出力タプルに反復の履歴が得られます。これはスカラー方程式の場合はデフォルトでオンで、システムの場合はオフです。データが本当に大きくなる可能性があるため、データを使用する必要がある場合のみオンにしてください。

出力: タプル (solution, functionval, history, idid, errcode, solhist) で、historyは残差ノルムと時間ステップの絶対関数値 |f(x)| の配列です。何かが悪くなければ、deltaはおおよそ |f(x_0)|/|f(x)| です。

idid=true は反復が成功した場合、false はそうでない場合です。

errcode = 0 は反復が成功した場合         = -1 は初期反復が終了基準を満たす場合         = 10 はmaxit反復後に収束しなかった場合

solhist=反復の全履歴（keepsolhist=trueの場合）

ptcsolscは、Toolsディレクトリの関数を使用してsolhistを構築します。システムの場合、solhistはN x Kの配列で、Nはxの長さ、Kは反復数+1です。したがって、スカラー方程式（N=1）の場合、solhistは行ベクトルです。したがって、以下の例では [ptcout.solhist' ptcout.history] を使用します。

反復が失敗した場合は、許容値、delta0、およびmaxitを調整する時です。方程式に安定した解がない場合、失敗することは確実です。

### ptcsolscの例

```jldoctest
julia> ptcout=ptcsolsc(sptest,.2;delta0=2.0,rtol=1.e-3,atol=1.e-3);

julia> [ptcout.solhist' ptcout.history]
7×2 Array{Float64,2}:
 2.00000e-01  9.20000e-02
 9.66666e-01  4.19962e-01
 8.75086e-01  2.32577e-01
 7.99114e-01  1.10743e-01
 7.44225e-01  4.00926e-02
 7.15163e-01  8.19395e-03
 7.07568e-01  4.61523e-04
```
