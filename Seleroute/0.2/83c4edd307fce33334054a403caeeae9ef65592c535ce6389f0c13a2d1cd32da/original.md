Return values: `result`, `n_new_paths`, `candidate_matrix`.
