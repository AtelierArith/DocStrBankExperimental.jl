```
rafterydiag(
    x::AbstractVector{<:Real}; q=0.025, r=0.005, s=0.95, eps=0.001, range=1:length(x)
)
```

RafteryとLewisの診断を計算します[^Raftery1992]。この診断は、指定された分位数`q`を所望の精度で推定するために必要な反復回数を決定するために使用されます。この診断は、指定された分位数$\theta_q$を推定するために必要な自己相関サンプルの数を決定するように設計されており、$\Pr(\theta \le \theta_q) = q$が所望の精度であることを保証します。特に、$\hat{\theta}_q$が推定量であり、$\Pr(\theta \le \hat{\theta}_q) = \hat{P}_q$が推定された累積確率である場合、精度は`r`と`s`の観点で指定され、$\Pr(q - r < \hat{P}_q < q + r) = s$となります。診断の計算においては、基礎となる仮定を満たすために間引きが使用される場合があります。ただし、ユーザーは、情報の損失を引き起こすため、事後要約統計を推定する際に同じ（または任意の）間引きを適用したくない場合があります。したがって、診断によって推定されるサンプルサイズは保守的（大きすぎる）傾向があります。

さらに、引数`r`は推定された累積確率の誤差範囲を指定し、`s`は誤差範囲の確率を指定します。`eps`は、初期反復から保持された反復への遷移確率がチェーンの平衡確率内にある許容範囲を指定します。この引数は、バーンインシーケンスとして破棄するサンプルの数を決定し、通常はデフォルト値のままにされます。

[^Raftery1992]: A L Raftery and S Lewis. Bayesian Statistics, chapter How Many Iterations in the Gibbs Sampler? Volume 4. Oxford University Press, New York, 1992.
