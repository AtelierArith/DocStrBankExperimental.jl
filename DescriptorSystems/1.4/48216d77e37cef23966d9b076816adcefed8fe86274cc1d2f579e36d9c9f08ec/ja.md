```
gnehari(sys[, γ]; fast = true, offset = β, 
                atol = 0, atol1 = atol, atol2 = atol, rtol = n*ϵ) -> (sysx, σ1)
```

記述子システム `sys = (A-λE,B,C,D)` に対して、伝達関数行列 `G(λ)` を用いて最適または準最適なネハリ近似 `sysx = (Ax-λEx,Bx,Cx,Dx)` を計算します。この伝達関数行列は `X(λ)` です。最適なネハリ近似 `X(λ)` は次の条件を満たします。

$$
     \| G(\lambda) - X(\lambda) \|_\infty = \| G^{*}_u(\lambda) \|_H := \sigma_1,
$$

ここで、${\small G_u(\lambda)}$ は `G(λ)` の適切な反安定部分です。得られた $σ_1$ は ${\small G^{*}_u(\lambda)}$ のハンケルノルム（最適近似誤差の L∞-ノルムでもあります）です。与えられた $γ > σ_1$ に対して、準最適近似は次の条件を満たします。

$$
     \| G(\lambda) - X(\lambda) \|_\infty \leq \gamma .
$$

ネハリ近似は、`G(λ)` が安定領域 `Cs` の境界上に極を持たない場合に安定です。連続時間の場合、`Cs` は実部が負の複素数の集合であり、その境界は拡張された虚軸（無限大の点も含む）です。一方、離散時間の場合、`Cs` は絶対値が1未満の複素数の集合であり、その境界は原点を中心とした単位円です。

`Cs` における極の存在を評価するために、キーワードパラメータ `offset = β` を介して境界オフセット `β` を指定できます。したがって、連続時間システムの場合、`Cs` の安定極は実部が `β` 以下であり、離散時間システムの場合は絶対値が `1+β` 以下です。`β` に使用されるデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。`β` の負の値（例：`β = -sqrt(ϵ)`）の場合、`Cs` の閉包に対応する拡張安定領域が使用されます。

キーワード引数 `atol1`、`atol2`、および `rtol` は、それぞれ、`A` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、`A` および `E` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `ϵ` は作業機械エプシロンで、`n` はシステム `sys` の次数です。キーワード引数 `atol` を使用して、`atol1 = atol` および `atol2 = atol` を同時に設定できます。

有限および無限の固有値の分離は、`fast = true` の場合は列ピボットを伴うランクを明らかにする QR 分解に基づくランク決定を使用し、`fast = false` の場合はより信頼性の高い SVD 分解を使用して行われます。

*方法:* `G(λ) = Gs(λ) + Gu(λ)` を `G(λ)` の加法分解とし、`Gs(λ)` が `Cs` の閉包（または `β < 0` の場合はその閉包）にのみ極を持ち、`Gu(λ)` が不安定な極のみを持つ反安定部分であるとします。記述子システムの拡張を伴うハンケルノルム近似法 [1] および [2] を使用して、不安定部分 `Gu(λ)` の安定なネハリ近似 `Gn(λ)` を計算し、得られた解は `X(λ) = Gs(λ) + Gn(λ)` として計算されます。

*参考文献:*

[1] K. Glover. All optimal Hankel-norm approximations of linear        multivariable systems and their L∞ error bounds,        Int. J. Control, vol. 39, pp. 1115-1193, 1984.

[2] M. G. Safonov, R. Y. Chiang, and D. J. N. Limebeer.         Optimal Hankel model reduction for nonminimal systems.         IEEE Trans. Automat. Control, vol. 35, pp. 496–502, 1990.
