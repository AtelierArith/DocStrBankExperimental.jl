```
giofac(sys; atol = 0, atol1 = atol, atol2 = atol, atol3 = atol, rtol, 
       fast = true, minphase = true, offset = sqrt(ϵ)) -> (sysi, syso, info)
```

記述子システム `sys = (A-λE,B,C,D)` の伝達関数行列 `G(λ)` に対して、平方内因子 `sysi = (Ai-λEi,Bi,Ci,Di)` の伝達関数行列 `Gi(λ)` と、最小位相準外因子またはフル行ランク因子 `syso = (Ao-λEo,Bo,Co,Do)` の伝達関数行列 `Go(λ)` を計算します。これにより、

```
 G(λ) = Gi[:,1:r](λ)*Go(λ)    (*),
```

となります。ここで `r` は `G(λ)` の通常のランクです。得られた適切で安定な内因子は `Gi'(λ)*Gi(λ) = I` を満たします。もし `sys` が安定（適切）であれば、得られた `syso` も安定（適切）です。得られた因子 `Go(λ)` はフル行ランク `r` を持ちます。選択された因子分解オプションに応じて、`minphase = true` の場合、`Go(λ)` は最小位相であり、適切な安定性領域 `Cs` の境界上にゼロが存在する可能性を除きます。`minphase = false` の場合、`Go(λ)` は `G(λ)` のすべてのゼロを含み、この場合 (*) は `G(λ)` の拡張QR類似因子分解です。連続時間システム `sys` に対して、安定性領域 `Cs` は実部が最大 `-β` である複素数の集合として定義され、離散時間システム `sys` に対しては、`Cs` は絶対値が最大 `1-β` である複素数の集合（すなわち、原点を中心とした半径 `1-β` の円の内部）です。ゼロの安定性とその数を評価するために使用される境界オフセット `β` は、キーワードパラメータ `offset = β` を介して指定できます。したがって、連続時間システムの場合、`Cs` の境界には実部が区間 `[-β,β]` にある複素数が含まれ、離散時間システムの場合、`Cs` の境界には絶対値が区間 `[1-β,1+β]` にある複素数が含まれます。`β` に使用されるデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。

得られた名前付き三重項 `info` には `(nrank, nfuz, niuz)` が含まれ、`info.nrank = r` は `G(λ)` の通常のランク、`info.nfuz` は `Cs` の境界上にある `syso` の有限ゼロの数、`info.niuz` は `syso` の無限ゼロの数です。`info.nfuz` は `minphase = false` の場合、`missing` に設定されます。

*注意:* `syso` は一般に *自由内因子* を含む可能性があり、有限の観測不可能な固有値を削除することで排除できます。

キーワード引数 `atol1`、`atol2`、`atol3`、および `rtol` は、それぞれ、`A` および `B` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、`C` および `D` の非ゼロ要素の絶対許容誤差、`A`、`E`、`B`、`C` および `D` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `ϵ` は作業機械エプシロンで、`n` はシステム `sys` の次数です。キーワード引数 `atol` を使用すると、`atol1 = atol`、`atol2 = atol`、`atol3 = atol` を同時に設定できます。

ゼロの評価のために、システムペンシル `[A-λE B; C D]` は特別なクロンカー類似形式に削減されます（[2]を参照）。この削減では、実行されたランク決定は、`fast = true` の場合は列ピボットを伴うランクを明らかにするQR分解に基づき、`fast = false` の場合はより信頼性の高いSVD分解に基づきます。

*メソッド:* 連続時間システムの場合、[1] の因子分解アルゴリズムが使用され、離散時間システムの場合も [1] の因子分解アルゴリズムが使用されます。

*参考文献:*

[1] C. Oara and A. Varga.     Computation of the general inner-outer and spectral factorizations.     IEEE Trans. Autom. Control, vol. 45, pp. 2307-2325, 2000.

[2] C. Oara.     Constructive solutions to spectral and inner–outer factorizations      respect to the disk. Automatica,  41, pp. 1855–1866, 2005.  ```
