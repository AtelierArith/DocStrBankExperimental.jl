```
grange(sys; zeros = "none", atol = 0, atol1 = atol, atol2 = atol, rtol, 
       fast = true, offset = sqrt(ϵ)) -> (sysr, sysx, info)
```

記述子システム `sys = (A-λE,B,C,D)` に対して、伝達関数行列 `G(λ)` を用いて、完全列ランクの伝達関数行列 `R(λ)` を持つ適切な記述子システム `sysr = (Ar-λEr,Br,Cr,Dr)` を計算します。これにより `Range(G(λ)) = Range(R(λ))` が成り立ち、完全行ランクの伝達関数行列 `X(λ)` を持つ記述子システム `sysx = (A-λE,B,Cx,Dx)` が得られます。この関係は次のように表されます。

```
 G(λ) = R(λ)*X(λ) ,
```

これは `G(λ)` の完全ランク因子分解を表しています。`R(λ)` の列数は `G(λ)` の通常のランク `r` です。`R(λ)` の列は、伝達行列 `G(λ)` の範囲（または画像）空間の有理基底を形成します。`G(λ)` の選択されたゼロが `R(λ)` のゼロとして含まれます。

結果として得られる名前付き三重項 `info` には `(nrank, nfuz, niuz)` が含まれ、ここで `info.nrank = r` は `G(λ)` の通常のランク、`info.nfuz` は安定性領域 `Cs` の境界上にある `sys` の有限ゼロの数、`info.niuz` は連続時間の場合の `sys` の無限ゼロの数であり、離散時間の場合は `0` に設定されます。

キーワードパラメータ `zeros` の値に応じて、`G(λ)` のゼロを `R(λ)` に含めるための以下のオプションが選択できます。

```
 "none"       - ゼロを含めない（デフォルト） 
 "all"        - `sys` のすべてのゼロを含める
 "unstable"   - `sys` のすべての不安定ゼロを含める
 "s-unstable" - `sys` のすべての厳密に不安定なゼロを含める（有限および無限）
 "stable"     - `sys` のすべての安定ゼロを含める
 "finite"     - `sys` のすべての有限ゼロを含める
 "infinite"   - `sys` のすべての無限ゼロを含める
```

`inner = true` の場合、得られた基底 `R(λ)` は *内側* であり、すなわち `R(λ)'*R(λ) = I` となります。ここで、連続時間システムの場合は `λ = s` に対して `R(s)' = transpose(R(-s))`、離散時間システムの場合は `λ = z` に対して `R(z)' = transpose(R(1/z))` です。このオプションは `zeros = "none"` または `zeros = "unstable"` と併用する場合にのみ使用できます。

連続時間システム `sys` に対して、安定性領域 `Cs` は実部が最大で `-β` である複素数の集合として定義されます。一方、離散時間システム `sys` に対しては、`Cs` は最大で `1-β` の絶対値を持つ複素数の集合です（すなわち、原点を中心とした半径 `1-β` の円の内部）。ゼロの安定性とその数を評価するために使用される境界オフセット `β` は、キーワードパラメータ `offset = β` を介して指定できます。したがって、連続時間システムの場合、`Cs` の境界には実部が区間 `[-β,β]` にある複素数が含まれ、離散時間システムの場合、`Cs` の境界には絶対値が区間 `[1-β,1+β]` にある複素数が含まれます。`β` のデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。

キーワード引数 `atol1`、`atol2` および `rtol` は、それぞれ `A`、`B`、`C` および `D` の非ゼロ要素に対する絶対許容誤差、`E` の非ゼロ要素に対する絶対許容誤差、`A`、`E`、`B`、`C` および `D` の非ゼロ要素に対する相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `ϵ` は作業機械エプシロン、`n` はシステム `sys` の次数です。キーワード引数 `atol` は、`atol1 = atol`、`atol2 = atol` を同時に設定するために使用できます。

ゼロの評価のために、システムペンシル `[A-λE B; C D]` は特別なクロンカー様形式に削減されます（[2]を参照）。この削減では、実行されるランク決定は、`fast = true` の場合は列ピボットを伴うランクを明らかにするQR分解に基づき、`fast = false` の場合はより信頼性の高いSVD分解に基づきます。

*メソッド:* 範囲計算メソッドは [1] に記載されており、[2] の削減アルゴリズムに基づいており、いくつかのゼロ選択オプションに対処するように適応されています。関与するクロンカー様形式の計算は [3] のアルゴリズムに基づいています。

*参考文献:*

[1] Varga, A.     有理行列の範囲を計算することに関するノート。      arXiv:1707.0048, [https://arxiv.org/abs/1707.0048](https://arxiv.org/abs/1707.004), 2017.

[2] C. Oara.     ディスクに関するスペクトルおよび内外因子分解への構成的解法。      Automatica,  41, pp. 1855–1866, 2005. 

[3] C. Oara and P. Van Dooren.      システムペンシルの構造的不変量の計算および関連する幾何学的側面のための改良されたアルゴリズム。      Syst. Control Lett., 30:39–48, 1997. ```
