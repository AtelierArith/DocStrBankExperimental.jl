```
stepresp(sys[, tfinal]; x0 = zeros(sys.nx), ustep = ones(sys.nu), timesteps = 100, 
         state_history = false, fast = true, atol = 0, atol1 = atol, atol2 = atol, rtol = n*ϵ) -> (y, tout, x)
```

Compute the step response of a proper descriptor system `sys = (A-λE,B,C,D)` to step input signals.  The final time `tfinal`, if not specified, is set to 10 for a continuous-time system or to `abs(sys.Ts)*timesteps` for a discrete-time system, where the keyword argument `timesteps` specifies the number of desired simulation time steps (default: `timesteps = 100`).  The keyword argument `ustep` is a vector with as many components  as the inputs of `sys` and specifies the desired amplitudes of step inputs (default: all components are set to 1).    The keyword argument `x0` is a vector which specifies the initial state vector at time `0`  and is set to zero when omitted. 

If `ns` is the total number of simulation values, `n` the number of state components,  `p` the number of system outputs and `m` the number of system inputs, then the resulting `ns×p×m` array `y` contains the resulting time histories of the outputs of `sys`, such  that `y[:,:,j]` is the time response for the `j`-th input set to `ustep[j]` and the rest of inputs set to zero.   The vector `tout` contains the corresponding values of the time samples. The `i`-th row `y[i,:,j]` contains the output values at time `tout[i]` of the `j`-th step response.   If the keyword parameter value `state_history = true` is used, then the resulting `ns×n×m` array`x` contains  the resulting time histories of the state vector and  the `i`-th row `x[i,:,j]` contains the state values at time `tout[i]` of the `j`-th step response.   By default, the state history is not computed and `x = nothing`.

By default, the uncontrollable infinite eigenvalues and simple infinite eigenvalues of the pair `(A,E)`  are eliminated.  The underlying pencil manipulation algorithms employ rank determinations based on either the use of  rank revealing QR-decomposition with column pivoting, if `fast = true` (default), or the SVD-decomposition, if `fast = false`. The rank decision based on the SVD-decomposition is generally more reliable,  but the involved computational effort is higher.

The keyword arguments `atol1`, `atol2` and `rtol` specify, respectively,  the absolute tolerance for the nonzero elements of `A`, `B`, `C`, `D`, the absolute tolerance for the nonzero elements of `E`,  and the relative tolerance for the nonzero elements of `A`, `B`, `C`, `D` and `E`.   The default relative tolerance is `n*ϵ`, where `n` is the order of the square matrices `A` and `E`, and  `ϵ` is the working machine epsilon.  The keyword argument `atol` can be used to simultaneously set `atol1 = atol` and `atol2 = atol`. 
