```
stepresp(sys[, tfinal]; x0 = zeros(sys.nx), ustep = ones(sys.nu), timesteps = 100, 
         state_history = false, fast = true, atol = 0, atol1 = atol, atol2 = atol, rtol = n*ϵ) -> (y, tout, x)
```

適切な記述子システム `sys = (A-λE,B,C,D)` のステップ応答をステップ入力信号に対して計算します。 最終時間 `tfinal` は、指定されていない場合、連続時間システムの場合は10に、離散時間システムの場合は `abs(sys.Ts)*timesteps` に設定されます。ここで、キーワード引数 `timesteps` は希望するシミュレーション時間ステップの数を指定します（デフォルト: `timesteps = 100`）。キーワード引数 `ustep` は、`sys` の入力と同じ数の成分を持つベクトルで、ステップ入力の希望する振幅を指定します（デフォルト: すべての成分は1に設定されます）。キーワード引数 `x0` は、時間 `0` における初期状態ベクトルを指定するベクトルで、省略した場合はゼロに設定されます。

`ns` がシミュレーション値の総数、`n` が状態成分の数、`p` がシステム出力の数、`m` がシステム入力の数である場合、結果として得られる `ns×p×m` 配列 `y` には、`sys` の出力の時間履歴が含まれ、`y[:,:,j]` は `j` 番目の入力が `ustep[j]` に設定され、他の入力がゼロに設定されたときの時間応答です。ベクトル `tout` には、対応する時間サンプルの値が含まれます。`i` 番目の行 `y[i,:,j]` には、`j` 番目のステップ応答の時間 `tout[i]` における出力値が含まれます。キーワードパラメータ値 `state_history = true` が使用されると、結果として得られる `ns×n×m` 配列 `x` には状態ベクトルの時間履歴が含まれ、`i` 番目の行 `x[i,:,j]` には `j` 番目のステップ応答の時間 `tout[i]` における状態値が含まれます。デフォルトでは、状態履歴は計算されず、`x = nothing` となります。

デフォルトでは、制御不能な無限固有値と単純な無限固有値のペア `(A,E)` は排除されます。基礎となるペンシル操作アルゴリズムは、`fast = true`（デフォルト）の場合は列ピボッティングを伴うランクを明らかにするQR分解を使用するか、`fast = false` の場合はSVD分解に基づくランク決定を行います。SVD分解に基づくランク決定は一般的により信頼性が高いですが、関与する計算努力は高くなります。

キーワード引数 `atol1`、`atol2` および `rtol` は、それぞれ `A`、`B`、`C`、`D` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、および `A`、`B`、`C`、`D` および `E` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `n` は正方行列 `A` と `E` の次数で、`ϵ` は作業用マシンエプシロンです。キーワード引数 `atol` を使用して、同時に `atol1 = atol` および `atol2 = atol` を設定できます。
