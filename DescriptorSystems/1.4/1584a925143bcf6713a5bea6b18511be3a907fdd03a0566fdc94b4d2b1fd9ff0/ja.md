```
gcrange(sys; zeros = "none", coinner = false, atol = 0, atol1 = atol, atol2 = atol, rtol, 
        fast = true, offset = sqrt(ϵ)) -> (sysr, sysx, info)
```

記述子システム `sys = (A-λE,B,C,D)` に対して、伝達関数行列 `G(λ)` を用いて、完全行ランクの伝達関数行列 `R(λ)` を持つ適切な記述子システム `sysr = (Ar-λEr,Br,Cr,Dr)` を計算します。ここで、`Coimage(G(λ)) = Coimage(R(λ))` となり、完全列ランクの伝達関数行列 `X(λ)` を持つ記述子システム `sysx = (A-λE,B,Cx,Dx)` が満たされます。

```
 G(λ) = X(λ)*R(λ) ,
```

これは `G(λ)` の完全ランク因子分解を表します。`R(λ)` の行数は `G(λ)` の通常ランク `r` です。`R(λ)` の行は、有理行列 `G(λ)` のコイメージ空間の有理基底を形成します。選択された `G(λ)` のゼロの集合は、`R(λ)` のゼロとして含まれます。

結果として得られる名前付き三重項 `info` には `(nrank, nfuz, niuz)` が含まれ、ここで `info.nrank = r` は `G(λ)` の通常ランク、`info.nfuz` は安定性領域 `Cs` の境界上の `sys` の有限ゼロの数、`info.niuz` は連続時間の場合の `sys` の無限ゼロの数であり、離散時間の場合は `0` に設定されます。

`R(λ)` に含める `G(λ)` のゼロを選択するために、キーワードパラメータ `zeros` を介して以下のオプションを選択できます：

```
 "none"       - ゼロを含めない（デフォルト） 
 "all"        - `sys` のすべてのゼロを含める
 "unstable"   - `sys` のすべての不安定ゼロを含める
 "s-unstable" - `sys` のすべての厳密に不安定なゼロを含める（有限および無限）
 "stable"     - `sys` のすべての安定ゼロを含める
 "finite"     - `sys` のすべての有限ゼロを含める
 "infinite"   - `sys` のすべての無限ゼロを含める
```

`coinner = true` の場合、結果として得られる基底 `R(λ)` は *coinner* であり、すなわち `R(λ)*R(λ)' = I` となります。ここで、連続時間システムの場合は `λ = s` に対して `R(s)' = transpose(R(-s))`、離散時間システムの場合は `λ = z` に対して `R(z)' = transpose(R(1/z))` です。このオプションは、`zeros = "none"` または `zeros = "unstable"` と併用する場合にのみ使用できます。

連続時間システム `sys` に対して、安定性領域 `Cs` は実部が最大 `-β` である複素数の集合として定義されます。一方、離散時間システム `sys` に対して、`Cs` は絶対値が最大 `1-β` である複素数の集合です（すなわち、原点を中心とした半径 `1-β` の円の内部）。ゼロの安定性とその数を評価するために使用される境界オフセット `β` は、キーワードパラメータ `offset = β` を介して指定できます。したがって、連続時間システムの場合、`Cs` の境界には実部が区間 `[-β,β]` にある複素数が含まれ、離散時間システムの場合、`Cs` の境界には絶対値が区間 `[1-β,1+β]` にある複素数が含まれます。`β` に使用されるデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。

キーワード引数 `atol1`、`atol2` および `rtol` は、それぞれ `A`、`B`、`C` および `D` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、`A`、`E`、`B`、`C` および `D` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `ϵ` は作業機械エプシロン、`n` はシステム `sys` の次数です。キーワード引数 `atol` は、`atol1 = atol` および `atol2 = atol` を同時に設定するために使用できます。

ゼロの評価のために、双対システムペンシル `transpose([A-λE B; C D])` は特別なクロンカーのような形に縮約されます（[2]を参照）。この縮約では、実行されたランク決定は、`fast = true` の場合は列ピボットを伴うランクを明らかにするQR分解に基づき、`fast = false` の場合はより信頼性の高いSVD分解に基づきます。

*メソッド:*  [1] に記載された範囲計算メソッドが、有理行列 `G(λ)` の転置に対応する双対記述子システムの実現に適用されます。[2] の基礎となるペンシル縮約アルゴリズムは、いくつかのゼロ選択オプションに対処するように適応されています。関与するクロンカーのような形の計算は、[3] のアルゴリズムに基づいています。

*参考文献:*

[1] Varga, A.     有理行列の範囲を計算することに関するノート。      arXiv:1707.0048, [https://arxiv.org/abs/1707.0048](https://arxiv.org/abs/1707.0048), 2017.

[2] C. Oara.     ディスクに関するスペクトルおよび内外因子分解への構成的解法。 Automatica,  41, pp. 1855–1866, 2005. 

[3] C. Oara と P. Van Dooren.      システムペンシルの構造的不変量の計算および関連する幾何学的側面のための改良されたアルゴリズム。      Syst. Control Lett., 30:39–48, 1997. ```
