```
gbalmr(sys, balance = false, matchdc = false, ord = missing, offset = √ϵ,
       atolhsv = 0, rtolhsv = nϵ, atolmin = atolhsv, rtolmin = rtolhsv, 
       atol = 0, atol1 = atol, atol2 = atol, rtol, fast = true) -> (sysr, hs)
```

適切で安定した記述子システム `sys = (A-λE,B,C,D)` のために、伝達関数行列 `G(λ)` を持つ、縮小された次数の実現 `sysr = (Ar-λEr,Br,Cr,Dr)` と、システム `sys` の減少順に並べられたハンケル特異値のベクトル `hs` を計算します。 `balance = true` の場合、バランシングに基づくアプローチが使用され、形式 `sysr = (Ar-λI,Br,Cr,Dr)` の縮小次数の最小実現が決定されます。連続時間システム `sys` の場合、結果として得られる実現 `sysr` はバランスが取れており、すなわち制御可能性および可観測性のグラミアンが等しく対角です。さらに `matchdc = true` の場合、結果として得られる `sysr` は状態残差化の公式（*特異摂動近似*としても知られる）を使用して計算され、これにより `sys` のDCゲインが保持されます。この場合、結果として得られる実現 `sysr` は（連続時間および離散時間システムの両方に対して）バランスが取れています。 `balance = false` の場合、強化された精度のバランシングフリーアプローチが使用され、縮小次数のシステム `sysr` が決定されます。

`ord = nr` の場合、結果として得られる `sysr` の次数は `min(nr,nrmin)` であり、ここで `nrmin` は、ハンケル特異値が `max(atolmin,rtolmin*HN)` を超える数として決定される `sys` の最小実現の次数です。ここで `HN` は `G(λ)` のハンケルノルムです。 `ord = missing` の場合、結果として得られる次数は、ハンケル特異値が `max(atolhsv,rtolhsv*HN)` を超える数として選択されます。

ペンシル `A-λE` の固有値の安定性を確認するために、連続時間システムの場合は固有値の実部が `-β` より小さくなければならず、離散時間システムの場合は固有値の絶対値が `1-β` より小さくなければなりません。ここで `β` は安定性領域の境界オフセットです。使用するオフセット `β` はキーワードパラメータ `offset = β` を介して指定できます。 `β` に使用されるデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。

キーワード引数 `atol1`、`atol2`、および `rtol` は、それぞれ、`A`、`B`、`C`、`D` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、および `A`、`B`、`C`、`D` および `E` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `nϵ` であり、ここで `ϵ` は作業 *機械イプシロン* で、`n` はシステム `sys` の次数です。キーワード引数 `atol` は、`atol1 = atol` および `atol2 = atol` を同時に設定するために使用できます。

`E` が特異な場合、ペア `(A,E)` の制御不可能な無限固有値と非動的モードは、最小実現技術を使用して排除されます。実施された削減におけるランクの決定は、`fast = true` の場合は列ピボットを伴うランクを明らかにするQR分解に基づき、`fast = false` の場合はより信頼性の高いSVD分解に基づきます。

メソッド: 標準システムの次数削減には、[1] のバランシングフリー法または [2] のバランシングに基づく方法が使用されます。記述子システムの場合、[3] のバランシング関連の次数削減方法が使用されます。元のシステムのDCゲインを保持するために、[4] の特異摂動近似法が [5] のバランシングに基づくまたはバランシングフリーのアプローチと組み合わせて使用されます。

参考文献

[1] A. Varga.      効率的な最小実現手続きに基づくバランシング.     A. El Moudni, P. Borne, および S.G. Tzafestas (編),      IMACSシンポジウムのモデリングと制御に関する予稿, フランス、リール, vol. 2, pp.42-47, 1991.

[2] M. S. Tombs および I. Postlethwaite.      安定な非最小状態空間システムの切り捨てバランス実現. Int. J. Control, vol. 46, pp. 1319–1330, 1987.

[3] T. Stykel.      記述子システムのためのグラミアンに基づくモデル削減.      制御、信号、およびシステムの数学, 16:297–319, 2004.

[4] Y. Liu Y. および B.D.O. Anderson      バランスシステムの特異摂動近似,     Int. J. Control, Vol. 50, pp. 1379-1405, 1989.

[5] Varga A.     特異摂動近似を計算するためのバランシングフリー平方根アルゴリズム.     Proc. 30-th IEEE CDC,  ブライトン, 1991年12月11-13日, Vol. 2, pp. 1062-1065.
