```
ginv(sys; type = "1-2", mindeg = false, fast = true, atol = 0, atol1 = atol, atol2 = atol, rtol, 
          offset = sqrt(ϵ)) -> (sysinv, info)
```

記述子システム `sys = (A-λE,B,C,D)` の伝達関数行列 `G(λ)` に対して、次の *ムーア・ペンローズ条件* のうち2つ以上を満たす一般化逆システム `sysinv = (Ai-λEi,Bi,Ci,Di)` と伝達関数行列 `Gi(λ)` を計算します：

```
     (1) G(λ)*Gi(λ)*G(λ) = G(λ);        
     (2) Gi(λ)*G(λ)*Gi(λ) = Gi(λ);
     (3) G(λ)*Gi(λ) = (G(λ)*Gi(λ))';
     (4) Gi(λ)*G(λ) = (Gi(λ)*G(λ))'.
```

計算された一般化逆の望ましいタイプは、キーワードパラメータ `type` を使用して次のように指定できます：

```
  "1-2"     - 条件 (1) と (2) を満たす一般化逆（デフォルト）;
  "1-2-3"   - 条件 (1)、(2) および (3) を満たす一般化逆;
  "1-2-4"   - 条件 (1)、(2) および (4) を満たす一般化逆;
  "1-2-3-4" - 条件 (1)-(4) をすべて満たすムーア・ペンローズ擬似逆。
```

キーワード引数として指定されたベクトル `poles` は、計算された一般化逆の極の望ましい安定度 `sdeg` を強制することと併せて、望ましい固有値を指定するために使用できます。

キーワード引数 `mindeg` は、`mindeg = true` の場合は最小次数の一般化逆を決定するオプションを指定するために使用され、`mindeg = false` の場合は（デフォルト）おそらく非最小次数の特定の一般化逆を指定するために使用されます。

安定領域 `Cs` の境界上のゼロの存在を評価するために、境界オフセット `β` をキーワードパラメータ `offset = β` を介して指定できます。したがって、連続時間設定の場合、`Cs` の境界には実部が区間 `[-β,β]` にある複素数が含まれ、離散時間設定の場合、`Cs` の境界には絶対値が区間 `[1-β,1+β]` にある複素数が含まれます。`β` に使用されるデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。

返される名前付きタプル `info` には、`info.nrank`、`info.nfp`、`info.fnorm` および `info.tcond` のコンポーネントが含まれます。ここで、`info.nrank` は `G(λ)` の通常のランク、`info.nfp` は逆 `Gi(λ)` の自由に割り当て可能な極の数、`info.fnorm` は使用されたフィードバックゲインのノルムの最大値（極の割り当てにも使用）であり、`info.tcond` は使用された非直交変換の条件数の最大値です（以下を参照）。

実行された削減におけるランクの決定は、`fast = true` の場合は列ピボットを用いたランクを明らかにするQR分解に基づいており、`fast = false` の場合はより信頼性の高いSVD分解に基づいています。最小次数の逆の計算は、適切な最小動的カバー問題を解くことによって行われます。これらの計算には、最大条件数が `info.tcond` に返される非直交変換を使用し、フィードバックゲイン（極の割り当ても含む）を使用し、その最大ノルムが `info.fnorm` に返されます。これらの量の高い値は、計算の数値安定性の潜在的な喪失を示します。

キーワード引数 `atol1`、`atol2` および `rtol` は、それぞれ、`A`、`B`、`C` および `D` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、および `A`、`E`、`B`、`C` および `D` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `ϵ` は作業機械エプシロンで、`n` はシステム `sys` の状態、入力および出力ベクトルの最大次元です。キーワード引数 `atol` は、`atol1 = atol` および `atol2 = atol` を同時に設定するために使用できます。

*メソッド:*  [1] で提案されたメソッドは、[2] のアプローチを使用して計算されたフルランク因子分解と併用されます。

*参考文献:*

[1] A. Varga. 行列ペンシル法を用いた一般化逆システムの計算.     Int. J. of Applied Mathematics and Computer Science, vol. 11, pp. 1055-1068, 2001.

[2] Varga, A. 有理行列の範囲空間基底の計算に関するノート.         arXiv:1707.0048, [https://arxiv.org/abs/1707.00489](https://arxiv.org/abs/1707.00489), 2017.
