```
psa_compute(T,npts,ax,eigA,opts,S=I) -> (Z,x,y,levels,info,Tproj,eigAproj,algo)
```

行列の擬似スペクトルを計算します。

[^\Trefethen1999]のコードの修正バージョンを使用しています。行列 `T` が上三角行列（例えば、シュール分解からのもの）である場合、ソルバーはそれ以外の場合よりもはるかに効率的です。

# 引数

  * `T`:      入力行列、通常は `schur()` から
  * `npts`:   グリッドは `npts × npts` ノードを持ちます
  * `ax`:     プロットする軸 `[min_real, max_real, min_imag, max_imag]`
  * `eigA`:   行列の固有値、通常は `schur()` によっても生成されます。未知の場合は空のベクトルを渡してください。
  * `S`:    2番目の行列、元の長方形行列から生じる一般化問題の場合。
  * `opts`: オプションを保持する `Dict{Symbol,Any}`。ここで使用されるキーは次のとおりです：

| キー                  | 型              | デフォルト             | 説明                                                                        |
|:------------------- |:-------------- |:----------------- |:------------------------------------------------------------------------- |
| `:levels`           | `Vector{Real}` | 自動                | 希望する ϵ レベルのための `log10(ϵ)`                                                 |
| `:recompute_levels` | `Bool`         | true              | ϵ レベルを自動的に再計算しますか？                                                        |
| `:real_matrix`      | `Bool`         | `eltype(A)<:Real` | 元の行列は実数ですか？（そうであればポートレートは対称です。）これは、`A` が実数であっても `T` が複素数である可能性があるため、必要です。 |
| `:proj_lev`         | `Real`         | ∞                 | 投影の前にすべての方向に軸を拡張する割合。負の場合は、逆の割合よりも小さい固有値の部分空間を除外します。∞ は投影なしを意味します。        |
| `:scale_equal`      | `Bool`         | false             | グリッドを等方的にしますか？                                                            |
| `:threaded`         | `Bool`         | false             | Julia スレッドに計算を分散させますか？                                                    |

# 注意事項：

  * 投影は正方形の密な行列に対してのみ行われます。スパース行列の投影は、`psa_compute` を呼び出す前に行列を投影されたヘッセンベルグ形式に縮小するクリロフ法によって処理される場合があります。
  * この関数は、一般化された擬似スペクトルを直接計算するものではありません。前処理および後処理によって処理される場合があります。

# 出力：

  * `Z`:         グリッド上の特異値
  * `x`:         グリッド線の x 座標
  * `y`:         グリッド線の y 座標
  * `levels`:   等高線プロットに使用されるレベル（自動的に計算された場合）
  * `Tproj`:     投影された行列（投影が行われなかった場合は `T` のエイリアス）
  * `eigAproj`:  投影された固有値
  * `algo`: 使用されたアルゴリズムを示すシンボル
  * `info`: 自動レベル作成が失敗した場所を示すフラグ：

| info | 意味                                                  |
|:---- |:--------------------------------------------------- |
| 0    | エラーなし                                               |
| -1   | 指定された範囲にレベルがありません（手動で、または行列がレベルを表示するにはあまりにも正規である場合） |
| -2   | 行列が非常に非正規であるため、ゼロの特異値のみが見つかりました                     |
| -3   | 計算がキャンセルされました                                       |

[^Trefethen1999]: L.N.Trefethen, "擬似スペクトルの計算," Acta Numerica 8, 247-295 (1999).
