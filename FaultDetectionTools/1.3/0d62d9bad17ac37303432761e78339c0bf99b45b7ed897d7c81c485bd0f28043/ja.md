```
 fdif2ngap(sysr::FDIFilterIF, SFDI, freq; atol = √ϵ) -> (gap, β, γ)
```

故障検出および隔離フィルタ内部形式オブジェクト `sysr::FDIFilterIF` に関連する安定なグローバルトランスファ関数行列 `Rf(λ)` および `Rw(λ)` の故障入力から残差へのトランスファチャネルとノイズ入力から残差へのトランスファチャネルに関連する `N × mf` バイナリ構造行列 `SFDI` に対して、故障からノイズのギャップ `gap`（および関連する量 `β` と `γ`）を計算します。フィルタ `sysr` は `N` 個の個別の FDI フィルタ `sysr.sys[i]` で構成されており、`i = 1, ..., N` の範囲で、`sysr.sys[i][:,sysr.faults]` は `i` 番目のフィルタの故障から残差へのチャネルであり、対応するトランスファ関数行列は `Rfi(λ)` で、`sysr.sys[i][:,sysr.noise]` は `i` 番目のフィルタのノイズから残差へのチャネルであり、対応するトランスファ関数行列は `Rwi(λ)` です。グローバルトランスファ関数行列 `Rf(λ)` および `Rw(λ)` は、`N` 個の個別フィルタのトランスファ関数行列の行の連結によって形成されます。すなわち、`Rf(λ) := [ Rf1(λ); Rf2(λ); ...; RfN(λ)]` および `Rw(λ) := [ Rw1(λ); Rw2(λ); ...; RwN(λ)]` とします。`Rffi(λ)` を `SFDI[i,j] = 1` である `Rfi(λ)` の `j` 番目の列から形成されたトランスファ関数行列とし、`Rdfi(λ)` を `SFDI[i,j] = 0` である `Rfi(λ)` の `j` 番目の列から形成されたトランスファ関数行列とします。ベクトル `gap`、`β` および `γ` の `i` 番目の要素には次の量が含まれます： `β[i]` - `Rffi(λ)` の H∞-インデックス、`γ[i]` - `[Rdfi(λ) Rwi(λ)]` の H∞-ノルム、そして故障からノイズのギャップ `gap` は `gap[i] := β[i]/γ[i]` として評価されます。`[Rdfi(λ) Rwi(λ)] = 0` の場合、`gap[i] = ∞` となり、`Rffi(λ) = 0` の場合、`gap[i] = 0` となります。`freq` が実数の周波数値のベクトルである場合、`β[i]` および `γ[i]` は `freq` に含まれる周波数に対して評価されます。`atol` はノルム `Rwi(λ)` の絶対許容誤差であり、ノルム値が `atol` 以下の場合はゼロと見なされます（デフォルト： `√ϵ`、ここで `ϵ` は作業機械精度です。） ```
