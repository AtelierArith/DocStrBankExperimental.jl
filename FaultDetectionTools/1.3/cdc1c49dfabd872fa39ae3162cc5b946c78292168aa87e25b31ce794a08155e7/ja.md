```
S = mdgenspec(sysm::MDMModel; emtest = false, fast = true, MDtol, MDGainTol, MDfreq, 
              sdeg, atol, atol1, atol2, atol3, rtol)
```

与えられた複数合成モデル `sysm::MDMModel` に対して、安定したモデル検出フィルタのセットに対応する内部形式の達成可能なバイナリ構造行列 `S` を生成します。これは、`i` 番目の残差がすべての制御および外乱入力に対して `i` 番目のモデルに対して鈍感であるように選ばれます。もし `N` がコンポーネントモデルの数であれば、`S` は `N×N` のバイナリ行列であり、その `(i,i)` 番目の要素は `i = 1, ..., N` の場合にゼロであり、`(i,j)` 番目の要素は、対応する `i` 番目の残差が特定の制御入力に対して `j` 番目のモデルに敏感であるようなモデル検出フィルタが存在する場合に非ゼロになります（`emtest = false` の場合）または特定の制御および外乱入力に対して（`emtest = true` の場合）。

`MDFreq = freq` は、強いモデル検出可能性チェックのための実数周波数値のベクトルまたはスカラー実数周波数値を指定します（デフォルト: `MDFreq = missing`）。

`MDtol = tol1` は、モデル検出可能性チェックのための閾値 `tol1` を指定します（デフォルト: `tol1 = 0.0001`）。

`MDGainTol = tol2` は、強いモデル検出可能性チェックのための閾値 `tol2` を指定します（デフォルト: `tol2 = 0.01`）。

キーワード引数 `sdeg = β` は、内部生成された候補フィルタの極のための所定の安定度 `β` を指定します。これは、連続時間の場合にはフィルタの極の実部が `β` 以下でなければならず、離散時間の場合にはフィルタの極の大きさが `β` 以下でなければなりません。もし `sdeg = missing` であれば、`FDFreq = missing` の場合には安定化は行われません。もし `sdeg = missing` で `FDFreq = freq` の場合、次のデフォルト値が使用されます: 連続時間の場合には `β = -0.05`、離散時間の場合には `β = 0.95`。

実行された削減におけるランクの決定は、`fast = true` の場合（デフォルト）には列ピボッティングを伴うランクを明らかにするQR分解に基づき、`fast = false` の場合にはより信頼性の高いSVD分解に基づきます。

キーワード引数 `atol1`、`atol2` および `rtol` は、それぞれ、状態空間行列（以下参照） `Ai`、`Bi`、`Ci` および `Di` の非ゼロ要素の絶対許容誤差、`Ei` の非ゼロ要素の絶対許容誤差、および上記のすべての行列の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `ni*ϵ` であり、ここで `ϵ` は作業用マシンエプシロンで、`ni` はシステム `sysm.sys[i]` の次数です。キーワード引数 `atol` は、`atol1 = atol` および `atol2 = atol` を同時に設定するために使用できます。

*メソッド:* `N` 個の安定したコンポーネントモデルを含む複数合成モデル `sysm` に対して、`i` 番目のコンポーネントシステム `sysm.sys[i]` は、次の形式の記述子実現を持ちます: `sysm.sys[i] = (Ai-λEi,Bi,Ci,Di)` そして対応する入力-出力形式は

```
  yi = Gui(λ)*u + Gdi(λ)*di + Gwi(λ)*wi + Gvi(λ)*vi
```

であり、ラプラス変換またはZ変換されたプラント出力 `yi`、制御入力 `u`、外乱入力 `di`、ノイズ入力 `wi`、および補助入力 `vi` と、対応する伝達関数行列 `Gui(λ)`、`Gdi(λ)`、`Gwi(λ)` および `Gvi(λ)` を持ちます。

達成可能な構造行列 `S` を生成するために、`N` 個のモデル検出フィルタ `Q_i(λ)` が使用されると仮定します。ここで `i = 1, ..., N` の場合、`i` 番目のモデル検出フィルタ `Q_i(λ)` は `i` 番目の残差を生成します

```
        r_i = Q_i(λ)*| y |
                     | u |
```

そして、これはヌルスペース合成条件を満たすように決定されます

```
        Q_i(λ)*|Gui(λ) Gdi(λ)| = 0.
               |  I     0    |
```

`S` の `i` 番目の行の要素を生成するために、`j = 1, ..., N` の場合に対応する `i` 番目のフィルタの内部形式が決定されます

```
   | Ruij(λ) Rdij(λ) | := Q_i(λ)*| Guj(λ) Gdj(λ) | 
                                 |   I      0    |
```

そして `S[i,j]` は次のように設定されます:

  * `MDfreq = missing` かつ `emtest = false` の場合、`Ruij(λ) ̸= 0` の場合に `S[i,j] = 1`、または `Ruij(λ) = 0` の場合に `S[i,j] = 0`；
  * `MDfreq = missing` かつ `emtest = true` の場合、`[Ruij(λ) Rdij(λ)] ̸= 0` の場合に `S[i,j] = 1`、または `[Ruij(λ) Rdij(λ)] = 0` の場合に `S[i,j] = 0`；
  * `MDfreq = freq` かつ `emtest = false` の場合、任意の `λs ∈ freq` に対して `Ruij(λs) ̸= 0` の場合に `S[i,j] = 1`、またはすべての `λs ∈ freq` に対して `Ruij(λs) = 0` の場合に `S[i,j] = 0`；
  * `MDfreq = freq` かつ `emtest = true` の場合、任意の `λs ∈ freq` に対して `[Ruij(λs) Rdij(λs)] ̸= 0` の場合に `S[i,j] = 1`、またはすべての `λs ∈ freq` に対して `[Ruij(λs) Rdij(λs)] = 0` の場合に `S[i,j] = 0`。

*参考文献:*

[1] A. Varga, Solving Fault Diagnosis Problems - Linear Synthesis Techniques.                Springer Verlag, 2017; sec. 5.2.

[2] A. Varga, Least order fault and model detection using multi-models.         IEEE CDC'09, Shanghai, China, 2009.
