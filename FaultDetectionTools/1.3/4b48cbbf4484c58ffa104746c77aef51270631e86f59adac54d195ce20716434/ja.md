```
S = fditspec(sysr::FDIFilterIF; FDfreq = missing, poleshift = false, 
             FDtol, FDStol, atol = 0, atol1 = atol, atol2 = atol, rtol, fast = true)
```

故障検出および隔離フィルタ内部形式オブジェクト `sysr::FDIFilterIF` の故障入力から残差への伝達チャネルのグローバルトランスファ関数行列 `Rf(λ)` の弱または強バイナリ構造行列 `S` を計算します。フィルタ `sysr` は `N` 個の個別のFDIフィルタ `sysr.sys[i]` から構成され、`i = 1, ..., N` の場合、`sysr.sys[i][:,sysr.faults]` の故障から残差へのチャネルは `qi` 残差出力と `mf` 故障入力を持ち、記述子システム表現 `sysr.sys[i][:,sysr.faults] := (Afi-lambda*Efi,Bfi,Cfi,Dfi)` を持ち、`Rfi(λ)` は対応する `qi x mf` トランスファ関数行列です。グローバルトランスファ関数行列 `Rf(λ)` は、`N` 個の個別フィルタのトランスファ関数行列の行の連結によって形成されます。すなわち、`Rf(λ) := [ Rf1(λ); Rf2(λ); ...; RfN(λ)]` です。強構造行列の評価のために、安定なトランスファ関数行列 `M(λ)*Rf(λ)` の構造行列が決定され、`M(λ)` はブロック対角行列 `M(λ) = block-diag(M1(λ), M2(λ), ..., MN(λ))` であり、ここで `Mi(λ)` は適切な正方形で可逆なトランスファ関数行列です（以下を参照）。

`FDtol = tol1` は、システム行列 `Bf` および `Df` の非ゼロ要素の大きさに対する絶対閾値 `tol1` を指定し、弱構造行列を決定するために使用されます。デフォルト値は `tol1 = 0.0001*max(1, norm(Bf,1), norm(Df,1))` です。

`FDStol = tol2` は、システム行列 `Af`, `Ef`, `Bf`, `Cf` および `Df` の非ゼロ要素の大きさに対する絶対閾値 `tol2` を指定し、強構造行列を決定するために使用されます。デフォルト値は `tol2 = epsm*max(1, norm(Ef,1), norm(Af,1), norm(Bf,1), norm(Cf,Inf), norm(Df,1)))` であり、ここで `epsm` は作業機械精度です。

`FDfreq = missing`（デフォルト）の場合、`S` には `Rf(λ)` の弱構造行列が含まれます。`S` は `N x mf` のバイナリ行列として決定され、その `(i,j)`-th 要素は `S[i,j] = 1` であり、`Rfi(λ)` の `j`-th 列が非ゼロである場合、そうでなければ `S[i,j] = 0` です。

`FDfreq = freq` が、持続的な故障信号のクラスを特徴づける `nf` 個の実周波数のベクトル `freq` を指定する場合、適切な正則かつ可逆な `M(λ)` に対して（以下を参照）、`S` には `nf` 個の複素周波数 `Ω` に関する `M(λ)*Rf(λ)` の強構造行列が含まれます。これは次のように定義されます：もし `f` が `freq` の実周波数であれば、対応する複素周波数 `Ω` においては `λ := im*f`（連続時間システムの場合）または `λ := exp(im*f*abs(Ts))`（サンプリング時間 `Ts` を持つ離散時間システムの場合）です。

`S` は `N x mf` のバイナリ行列として決定され、その `(i,j)`-th 要素は `S[i,j] = 1` であり、すべての周波数 `Ω` に対して `Mi(λ)*Rfi(λ)` の `j`-th 列が非ゼロである場合、そうでなければ `S[i,j] = 0` です。`poleshift = true` の場合、`Mi(λ)` は `Mi(λ)*Rfi(λ)` が `Ω` において極を持たないように選択され、`poleshift = false`（デフォルト）の場合、`Mi(λ) = I` が使用され、任意の `Rfi(λ)` が `Ω` において極を持つ場合はエラーが発生します。

キーワード引数 `atol1`, `atol2`, および `rtol` は、それぞれ、行列 `Af`, `Bf`, `Cf`, `Df` の非ゼロ要素に対する絶対許容誤差、行列 `Ef` の非ゼロ要素に対する絶対許容誤差、および行列 `Af`, `Bf`, `Cf`, `Df` および `Ef` の非ゼロ要素に対する相対許容誤差を指定します。キーワード引数 `atol` は、同時に `atol1 = atol` および `atol2 = atol` を設定するために使用できます。

*メソッド:* 構造行列の定義については [1] を参照してください。弱構造行列の決定のために、`Rfi(λ)` の各列に対して最小実現が決定され、非ゼロ列が特定されます（[1] の補題 7.1 を参照）。強構造行列の決定のために、`Mi(λ)*Rfi(λ)` の各列に対して最小実現が決定され、対応するシステム行列のフルランクがすべての周波数 `Ω` に対してチェックされます（[1] の補題 7.2 を参照）（すなわち、すべての周波数 `Ω` においてゼロがないこと）。

*参考文献:*

[1] Varga A. Solving Fault Diagnosis Problems - Linear Synthesis Techniques. Springer Verlag, 2017; sec.3.4. ```
