```
efdsyn(sysf::FDIModel; rdim, nullspace = true, simple = false, minimal = true, 
                       sdeg, smarg, poles, HDesign, FDtol, FDGainTol, FDfreq, 
                       tcond, offset, atol, atol1, atol2, atol3, rtol, fast = true) 
                       -> (Q::FDFilter, R::FDFilterIF, info)
```

与えられた合成モデル `sysf` に対して *正確な故障検出問題* (EFDP) を解決します。計算された安定で適切なフィルタオブジェクト `Q` と `R` には、EFDPの解を表す故障検出フィルタが含まれています。

返される名前付きタプル `info` には、`info.tcond`、`info.degs`、`info.S`、および `info.HDesign` のコンポーネントが含まれており、追加の合成関連情報が含まれています（以下を参照）。

連続時間または離散時間システム `sysf.sys` は、標準または記述子状態空間形式 `sysf.sys = (A-λE,B,C,D)` にあり、これは入力-出力形式に対応します。

```
   y = Gu(λ)*u + Gd(λ)*d + Gf(λ)*f + Gw(λ)*w + Ga(λ)*aux,
```

ラプラス変換またはZ変換されたプラント出力 `y`、制御入力 `u`、外乱入力 `d`、故障入力 `f`、ノイズ入力 `w`、および補助入力 `aux` があり、`Gu(λ)`、`Gd(λ)`、`Gf(λ)`、`Gw(λ)`、および `Ga(λ)` は対応する伝達関数行列です。制御、外乱、故障、ノイズ、および補助入力のインデックスは、それぞれ関連する整数ベクトル `sysf.controls`、`sysf.disturbances`、`sysf.faults`、`sysf.noise` および `sysf.aux` に含まれています。

故障検出フィルタオブジェクト `Q` には、`Q.sys` に結果のフィルタが含まれており、標準状態空間形式で残差信号 `r` を生成します。対応する入力-出力（実装）形式は次のとおりです。

```
        r = Qy(λ)*y + Qu(λ)*u
```

ここで、`Qy(λ)` と `Qu(λ)` は出力および制御入力から残差への伝達関数行列です。出力および制御入力のインデックスは、それぞれ整数ベクトル `Q.outputs` と `Q.controls` に含まれています。

内部形式オブジェクト `R` の故障検出フィルタには、`R.sys` に結果の内部形式のフィルタが含まれており、標準状態空間形式で残差信号 `r` を生成し、入力-出力形式に対応します。

```
   r = Ru(λ)*u + Rd(λ)*d + Rf(λ)*f + Rw(λ)*w + Ra(λ)*aux ,
```

ここで、

```
   | Ru(λ) Rd(λ) Rf(λ) Rw(λ) Ra(λ) | = |Qy(λ) Qu(λ)|*| Gu(λ) Gd(λ) Gf(λ) Gw(λ) Ga(λ) |. 
                                                     |  I     0     0     0     0    |
```

EFDPの解は、`Ru(λ) = 0`、`Rd(λ) = 0`、および `Rf(λ)` のすべての列が非ゼロであることを保証します。結果のフィルタ `R.sys` の入力 `u`、`d`、`f`、`w` および `aux` のインデックスは、それぞれ整数ベクトル `R.controls`（空）、`R.disturbances`（空）、`R.faults`、`R.noise` および `R.aux` に含まれています。

結果のフィルタ `Q.sys` と `R.sys` は、可観測な状態空間実現 `(AQ,BQ,CQ,DQ)` および `(AQ,BR,CQ,DR)` を持ち、したがって可観測なペア `(AQ,CQ)` を共有します。

さまざまなユーザーオプションは、キーワード引数を介して次のように指定できます。

`minimal = true`（デフォルト）の場合、最小次数フィルタ合成が行われますが、`minimal = false` の場合はフルオーダー合成が行われます。

`HDesign = H` の場合、フル行ランク設計行列 `H` が使用され、`rdim = q` の左ヌル空間基底ベクトルの線形結合が構築されます（デフォルト: `HDesign = missing`）

`rdim = q` は、`Q` と `R` のための残差出力の希望する数 `q` を指定します。デフォルト値の `q` は次のように選択されます: `HDesign = missing` の場合、`q = 1`（`minimal = true` の場合）、または `minimal = false` の場合は初期合成に使用されるヌル空間基底ベクトルの数; `HDesign = H` がフル行ランク設計行列 `H` を指定する場合、`q` は `H` の行次元です。

`FDfreq = freq` は、強い検出可能性チェックのための実数周波数値のベクトルまたはスカラー実数周波数値を指定します（デフォルト: `FDfreq = missing`）。

`nullspace = true`（デフォルト）の場合、故障検出フィルタの合成に最小適切ヌル空間基底が使用されます。`nullspace = false` の場合、フルオーダーオブザーバベースのヌル空間基底が使用されます。このオプションは、外乱入力のない適切なシステムにのみ使用できます。

`simple = true` の場合、合成に単純な適切ヌル空間基底が使用されます。基底ベクトルの次数は `info.deg` に提供されます。`simple = false`（デフォルト）の場合、単純な基底は計算されません。

`offset = β` は、極の安定性を評価するための境界オフセット `β` を指定します。したがって、連続時間システムの安定性のためには、すべての極の実部が最大で `-β` でなければならず、離散時間システムの安定性のためには、すべての極の絶対値が最大で `1-β` でなければなりません。`β` に使用されるデフォルト値は `sqrt(ϵ)` であり、ここで `ϵ` は作業機械精度です。

`smarg = α` は、極の安定性領域 `Cs` を定義する安定性マージンを指定します。連続時間システムの場合、`Cs` は実部が最大で `α` の複素数の集合であり、離散時間システムの場合、`Cs` は絶対値が最大で `α < 1` の複素数の集合です（すなわち、原点を中心とした半径 `α` の円の内部）。`smarg` が指定されていない場合、使用されるデフォルト値は、連続時間システムの場合は `α = -β`、離散時間システムの場合は `α = 1-β` であり、ここで `β` はキーワード引数 `offset = β` によって指定された境界オフセットです。

`sdeg = γ` は、フィルタ `Q` と `R` の極のための指定された安定性次数です（デフォルト: 連続時間システムの極の実部に対して `γ = -0.05`、離散時間システムの極の絶対値に対して `γ = 0.95`）。

`poles = v` は、フィルタ `Q` と `R` に割り当てる希望する極の複素共役セットを含む複素ベクトル `v` を指定します（デフォルト: `poles = missing`）。

`tcond = tcmax` は、使用される非直交変換の最大許容条件数 `tcmax` を指定します（デフォルト: `tcmax = 1.e4`）。

`FDtol = tol1` は、故障検出可能性チェックのためのしきい値 `tol1` を指定します（デフォルト: `tol1 = 0.0001`）。

`FDGainTol = tol2` は、強い故障検出可能性チェックのためのしきい値 `tol2` を指定します（デフォルト: `tol2 = 0.01`）。

実行された削減におけるランクの決定は、`fast = true` の場合は列ピボットを伴うランクを明らかにするQR分解に基づいており、`fast = false` の場合はより信頼性の高いSVD分解に基づいています。

キーワード引数 `atol1`、`atol2`、および `rtol` は、それぞれ `A`、`B`、`C`、`D` の非ゼロ要素の絶対許容誤差、`E` の非ゼロ要素の絶対許容誤差、および `A`、`B`、`C`、`D` および `E` の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は `n*ϵ` であり、ここで `ϵ` は作業機械エプシロンで、`n` はシステム `sysf.sys` の次数です。キーワード引数 `atol3` は可観測性テストのための絶対許容誤差です（デフォルト: 内部で決定された値）。キーワード引数 `atol` は、同時に `atol1 = atol`、`atol2 = atol` および `atol3 = atol` を設定するために使用できます。

結果の名前付きタプル `info` には `(tcond, degs, S, HDesign)` が含まれており、次のようになります。

`info.tcond` は、使用された非直交変換行列の条件数の最大値です。`info.tcond >= tcmax` の場合は警告が発行されます。

`info.degs` は、左最小多項式ヌル空間基底の次数を増加順に含む整数ベクトルです。`G(λ) := [ Gu(λ) Gd(λ); I 0]` の場合（`[Gu(λ) Gd(λ)]` の状態空間実現が最小の場合）。

`info.S` は、計算された左ヌル空間基底に対応するバイナリ構造行列です。

`info.HDesign` は、故障検出フィルタの合成に使用された設計行列 `H` です。

*方法:* 正確な故障検出問題を解決するために、[1] の手順 EFD が実装されています。故障検出フィルタの最小次数合成の詳細については、[2] を参照してください。

*参考文献:*

[1] A. Varga, Solving Fault Diagnosis Problems - Linear Synthesis Techniques.                Springer Verlag, 2017; sec. 5.2.

[2] A. Varga, On computing least order fault detectors using rational nullspace bases.  IFAC SAFEPROCESS'03 Symposium, Washington DC, USA, 2003. ```
