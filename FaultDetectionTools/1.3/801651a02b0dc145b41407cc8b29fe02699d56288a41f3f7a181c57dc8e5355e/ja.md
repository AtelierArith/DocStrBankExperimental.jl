```
 S = fdisspec(sysr::FDFilterIF, freq; block = false, stabilize = false, FDGainTol = 0.01, 
                 atol = 0, atol1 = atol, atol2 = atol, rtol, fast = true)
```

与えられた実周波数のセット `freq` に対して、安定な伝達関数行列 `M(λ)*Rf(λ)` の強いバイナリ構造行列 `S` を計算します。ここで、`Rf(λ)` は故障入力から故障検出フィルタ内部形式オブジェクト `sysr::FDFilterIF` の残差への伝達関数行列であり、`M(λ)` は適切な安定化伝達関数行列です（以下を参照）。`q` 残差出力と `mf` 故障入力を持つフィルタ `sysr` に対して、`Rf(λ)` は故障入力チャネルの `q x mf` 伝達関数行列であり、記述子システム表現は `sysr.sys[:,sysr.faults] := (Af-lambda*Ef,Bf,Cf,Df)` です。

`freq` には、持続的な故障信号のクラスを特徴づける実周波数値または `nf` 実周波数のベクトルが含まれている必要があります（デフォルト: `freq = 0`、すなわち定常故障を特徴づける）。`S` には、複素周波数 `Ω` のセットに関する `M(λ)*Rf(λ)` の強い構造行列が含まれ、次のように定義されます: `f` が `freq` の実周波数である場合、対応する複素周波数 `Ω` は、連続時間システムの場合は `λ := im*f`、離散時間システムの場合はサンプリング時間 `Ts` に対して `λ := exp(im*f*abs(Ts))` です。

`FDGainTol = tol` は、周波数応答ゲインの非ゼロの大きさに対する絶対閾値 `tol` を指定します（デフォルト: `tol = 0.01`）。

`block = false` の場合、`stabilize = true` であれば、`M(λ)` は `M(λ)*Rf(λ)` が安定な極のみを持つように対角に選択され、`stabilize = false`（デフォルト）の場合は `M(λ) = I` が使用され、`Rf(λ)` が `Ω` に極を持つ場合はエラーが発生します。`S` は `q x mf` バイナリ行列として決定され、その `(i,j)`-th 要素は、`M(λ)*Rf(λ)` の `(i,j)`-th 要素が `freq` のすべての周波数で `tol` 以上であれば `S[i,j] = 1`、そうでなければ `S[i,j] = 0` です。

`block = true` の場合、`stabilize = true` であれば、`M(λ)` は `M(λ)*Rf(λ)` が安定な極のみを持つように選択され、`stabilize = false`（デフォルト）の場合は `M(λ) = I` が使用され、`Rf(λ)` が `Ω` に極を持つ場合はエラーが発生します。`S` は `1 x mf` バイナリ行列として決定され、その `(1,j)`-th 要素は、`M(λ)*Rf(λ)` の `j`-th 列が `Ω` のすべての周波数で `tol` 以上であれば `S[1,j] = 1`、そうでなければ `S[1,j] = 0` です。

キーワード引数 `atol1`、`atol2`、`atol3`、および `rtol` は、それぞれ行列 `Af`、`Bf`、`Cf`、`Df` の非ゼロ要素に対する絶対許容誤差、`Ef` の非ゼロ要素に対する絶対許容誤差、`Cf` の非ゼロ要素に対する絶対許容誤差、`Af`、`Bf`、`Cf`、`Df` および `Ef` の非ゼロ要素に対する相対許容誤差を指定します。キーワード引数 `atol` は、`atol1 = atol`、`atol2 = atol` および `atol3 = atol` を同時に設定するために使用できます。

個々の入力出力チャネルの最小実現の計算は、ペンシル操作アルゴリズムに依存しており、`fast = true` の場合は列ピボットを用いたランク明示化QR分解を使用し、そうでない場合はSVD分解を使用します。SVD分解に基づくランク決定は一般的により信頼性がありますが、関与する計算コストは高くなります。

*方法:* `S` は [1] における強い構造行列の定義を使用して評価されます。

*参考文献:*

[1] Varga A. Solving Fault Diagnosis Problems - Linear Synthesis Techniques. Springer Verlag, 2017; sec. 3.4. ```
