```
 S = fdisspec(sysr::FDIFilterIF, freq; stabilize = false, FDGainTol = 0.01, 
                 atol = 0, atol1 = atol, atol2 = atol, rtol, fast = true)
```

与えられた実周波数のセット `freq` に対して、安定な伝達関数行列 `M(λ)*Rf(λ)` の強いバイナリ構造行列 `S` を計算します。ここで、`Rf(λ)` は故障入力から故障検出および隔離フィルタ内部形式オブジェクト `sysr::FDIFilterIF` の残差への伝達チャネルのグローバル伝達関数行列であり、`M(λ)` は適切なブロック対角の適切かつ可逆な安定化伝達関数行列です（以下参照）。フィルタ `sysr` は `N` 個の個別の FDI フィルタ `sysr.sys[i]` から構成され、`i = 1, ..., N` の範囲で、`i` 番目のフィルタの故障から残差へのチャネル `sysr.sys[i][:,sysr.faults]` は `qi` 残差出力と `mf` 故障入力を持ち、記述子システム表現 `sysr.sys[i][:,sysr.faults] := (Afi-lambda*Efi,Bfi,Cfi,Dfi)` を持ち、`Rfi(λ)` は対応する `qi x mf` 伝達関数行列です。グローバル伝達関数行列 `Rf(λ)` は、`N` 個の個別フィルタの伝達関数行列の行の連結によって形成されます。すなわち、`Rf(λ) := [ Rf1(λ); Rf2(λ); ...; RfN(λ)]` です。`M(λ) = block-diag(M1(λ), M2(λ), ..., MN(λ))` であり、ここで `Mi(λ)` は正方形で可逆であり、`Mi(λ)Rfi(λ)` が安定であるように選ばれます（以下参照）。

`freq` には、持続的な故障信号のクラスを特徴づける実周波数値または `nf` 個の実周波数のベクトルが含まれている必要があります（デフォルト: `freq = 0`、すなわち、定常故障を特徴づける）。`S` には、複素周波数のセット `Ω` に関する `M(λ)*Rf(λ)` の強い構造行列が含まれ、次のように定義されます。`f` が `freq` の実周波数である場合、対応する複素周波数 `Ω` における `λ` は、連続時間システムの場合は `λ := im*f`、離散時間システムの場合はサンプリング時間 `Ts` に対して `λ := exp(im*f*abs(Ts))` です。

`FDGainTol = tol` は、周波数応答ゲインの非ゼロの大きさに対する絶対しきい値 `tol` を指定します（デフォルト: `tol = 0.01`）。

`stabilize = true` の場合、`Mi(λ)` は `Mi(λ)*Rfi(λ)` が安定な極のみを持つように選ばれ、`stabilize = false`（デフォルト）の場合は `Mi(λ) = I` が使用され、任意の `Rfi(λ)` が `Ω` に極を持つ場合はエラーが発生します。

`S` は `N x mf` のバイナリ行列として決定され、その `(i,j)` 番目の要素は、`Mi(λ)*Rfi(λ)` の `j` 番目の列のノルムが `Ω` のすべての周波数に対して `tol` 以上であれば `S[i,j] = 1`、そうでなければ `S[i,j] = 0` です。

キーワード引数 `atol1`、`atol2`、`atol3`、および `rtol` は、それぞれ行列 `Afi`、`Bfi`、`Cfi`、`Dfi` の非ゼロ要素に対する絶対許容誤差、`Efi` の非ゼロ要素に対する絶対許容誤差、`Cfi` の非ゼロ要素に対する絶対許容誤差、`Afi`、`Bfi`、`Cfi`、`Dfi` および `Efi` の非ゼロ要素に対する相対許容誤差を指定します。キーワード引数 `atol` を使用して、`atol1 = atol`、`atol2 = atol` および `atol3 = atol` を同時に設定できます。

個々の入力出力チャネルの最小実現の計算は、ランク決定に基づくペンシル操作アルゴリズムに依存しており、`fast = true` の場合は列ピボットを伴うランクを明らかにする QR 分解を使用し、そうでない場合は SVD 分解を使用します。SVD 分解に基づくランク決定は一般的により信頼性がありますが、関与する計算コストは高くなります。

*メソッド:* `S` は [1] における強い構造行列の定義を使用して評価されます。

*参考文献:*

[1] Varga A. Solving Fault Diagnosis Problems - Linear Synthesis Techniques. Springer Verlag, 2017; sec. 3.4. ```
