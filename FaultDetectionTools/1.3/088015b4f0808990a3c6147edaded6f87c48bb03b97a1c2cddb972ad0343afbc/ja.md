```
S = fditspec(sysr::FDFilterIF; FDfreq = missing, block = false, poleshift = false, 
             FDtol, FDStol, atol = 0, atol1 = atol, atol2 = atol, rtol, fast = true)
```

故障検出フィルタ内部形式オブジェクト `sysr::FDFilterIF` から残差への故障入力の伝達チャネルの伝達関数行列 `Rf(λ)` の弱いまたは強いバイナリ構造行列 `S` を計算します。残差出力が `q` で故障入力が `mf` のフィルタ `sysr` に対して、`Rf(λ)` は、記述子システム表現 `sysr.sys[:,sysr.faults] := (Af-lambda*Ef,Bf,Cf,Df)` を持つ故障入力チャネルの `q x mf` 伝達関数行列です。

`FDfreq = missing`（デフォルト）の場合、`S` には `Rf(λ)` の弱い構造行列が含まれます。`block = false` の場合、`S` は `q x mf` バイナリ行列（BitMatrix）として決定され、その `(i,j)`-th 要素は `S[i,j] = 1` であり、`Rf(λ)` の `(i,j)`-th 要素が非ゼロである場合、そうでなければ `S[i,j] = 0` です。`block = true` の場合、`S` は `1 x mf` バイナリ行列として決定され、その `(1,j)`-th 要素は `S[1,j] = 1` であり、`Rf(λ)` の `j`-th 列が非ゼロである場合、そうでなければ `S[1,j] = 0` です。

`FDfreq = freq` が持続的故障信号のクラスを特徴づける `nf` の実周波数のベクトル `freq` を指定する場合、適切な正則かつ可逆な `M(λ)`（以下参照）に対して、`S` には `M(λ)*Rf(λ)` の強い構造行列が含まれ、`nf` の複素周波数の集合 `Ω` に関して定義されます。もし `f` が `freq` の実周波数であれば、対応する複素周波数 `Ω` は、連続時間システムの場合 `λ := im*f`、離散時間システムでサンプリング時間 `Ts` の場合 `λ := exp(im*f*abs(Ts))` です。

`FDtol = tol1` は、システム行列 `Bf` と `Df` の非ゼロ要素の大きさに対する絶対閾値 `tol1` を指定し、弱い構造行列を決定するために使用されます。デフォルト値は `tol1 = 0.0001*max(1, norm(Bf,1), norm(Df,1))` です。

`FDStol = tol2` は、システム行列 `Af`、`Ef`、`Bf`、`Cf`、`Df` の非ゼロ要素の大きさに対する絶対閾値 `tol2` を指定し、強い構造行列を決定するために使用されます。デフォルト値は `tol2 = epsm*max(1, norm(Ef,1), norm(Af,1), norm(Bf,1), norm(Cf,Inf), norm(Df,1)))` であり、ここで `epsm` は作業機械精度です。

`block = false` の場合、`poleshift = true` の場合、`M(λ)` は `M(λ)*Rf(λ)` が `Ω` に極を持たないように対角行列として選択され、`poleshift = false`（デフォルト）の場合、`M(λ) = I` が使用され、`Rf(λ)` が `Ω` に極を持つ場合はエラーが発生します。`S` は `q x mf` バイナリ行列として決定され、その `(i,j)`-th 要素は、すべての周波数に対して評価された `M(λ)*Rf(λ)` の `(i,j)`-th 要素が非ゼロである場合 `S[i,j] = 1`、そうでなければ `S[i,j] = 0` です。

`block = true` の場合、`poleshift = true` の場合、`M(λ)` は `M(λ)*Rf(λ)` が `Ω` に極を持たないように選択され、`poleshift = false`（デフォルト）の場合、`M(λ) = I` が使用され、`Rf(λ)` が `Ω` に極を持つ場合はエラーが発生します。`S` は `1 x mf` バイナリ行列として決定され、その `(1,j)`-th 要素は、すべての周波数に対して評価された `M(λ)*Rf(λ)` の `j`-th 列が非ゼロである場合 `S[1,j] = 1`、そうでなければ `S[1,j] = 0` です。

キーワード引数 `atol1`、`atol2`、および `rtol` は、それぞれ行列 `Af`、`Bf`、`Cf`、`Df` の非ゼロ要素に対する絶対許容誤差、行列 `Ef` の非ゼロ要素に対する絶対許容誤差、行列 `Af`、`Bf`、`Cf`、`Df` および `Ef` の非ゼロ要素に対する相対許容誤差を指定します。キーワード引数 `atol` は、同時に `atol1 = atol` および `atol2 = atol` を設定するために使用できます。

*メソッド:* 構造行列の定義については [1] を参照してください。弱い構造行列の決定には、`block = true` の場合は `Rf(λ)` の各列に対して、`block = false` の場合は `Rf(λ)` の各要素に対して最小実現が決定され、各列の非ゼロ列または要素が特定されます（[1] の補題 7.1 を参照）。強い構造行列の決定には、`block = true` の場合は `M(λ)*Rf(λ)` の各列に対して、`block = false` の場合は `M(λ)*Rf(λ)` の各要素に対して最小実現が決定され、`FDfreq` のすべての周波数に対して対応するシステム行列のフルランクがチェックされます（[1] の補題 7.2 を参照）（すなわち、すべての周波数におけるゼロの欠如）。

*参考文献:*

[1] Varga A. Solving Fault Diagnosis Problems - Linear Synthesis Techniques. Springer Verlag, 2017; sec.3.4.
