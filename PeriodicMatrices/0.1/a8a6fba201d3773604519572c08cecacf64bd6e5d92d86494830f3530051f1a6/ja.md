```
 hr2bt(Ahr::HarmonicArray, N; P, nperiod]) -> Abt::Matrix
```

周期行列の調和（フーリエ）配列表現のブロック・トプリッツ行列を構築します。

周期行列 `Ahr(t)` の周期 `T` の調和表現オブジェクト `Ahr` は、部分周期 `T′ = T/k` の形で次のように表されます。

```
                 p
 Ahr(t) = A_0 +  ∑ ( Ac_i*cos(i*t*2*π/T′)+As_i*sin(i*2*π*t/T′) ) ,
                i=1
```

ここで `k ≥ 1` は部分周期の数です。`Ahr(t)` はフーリエ級数表現の形で同等に表現できます。

```
            p
 Ahr(t) =   ∑ A_i*exp(im*i*ωh*t) ,
           i=-p
```

ここで `ωh = 2π/T′`、`A_i = (Ac_i-im*As_i)/2` および `A_{-i} = (Ac_i+im*As_i)/2` です。`N` は近似に使用される選択された調和成分（またはフーリエモード）の数です。キーワードパラメータ `P` は考慮される完全な周期の数（デフォルト: `P = 1`）であり、`nperiod` は考慮される部分周期の数で、`1 ≤ nperiod ≤ k`（デフォルト: `nperiod = k`）です。

与えられた数 `N ≥ p` に対して、周期の数が `P = 1` で部分周期の数が `nperiod = 1` の場合、*バンド*ブロック・トプリッツ行列 `Abt` は `(2N+1)×(2N+1)` ブロックで構築されます。

```
       ( A_0  A_{-1} …  A_{-p}        0    )
       ( A_1   A_0             ⋱           )
       (  ⋮         ⋱            ⋱         )
 Abt = ( A_p             ⋱          A_{-p} )
       (        ⋱           ⋱         ⋮    )
       (  0        A_p      …         A_0  )
```

もし `N < p` であれば、最初の `N` 調和成分を使用して切り捨てられた*完全*ブロック・トプリッツ行列が構築されます。

一般に、与えられた `P ≥ 1` および `nperiod ≥ 1` に対して、ブロック・トプリッツ行列 `Abt` は `(2N*np+1)×(2N*np+1)` ブロックで構築され、`np = P*nperiod` であり、各 `A_i` はその列の前に `np-1` のゼロブロックがあり、各 `A_{-i}` はその行の前に `np-1` のゼロブロックがあり、すべての対角ブロックは `A_0` に等しいです。
