```
reallssolve(f, b, algorithm, [λ::Real = 0])
```

問題 `f(x) ≈ b` に対する最小二乗解 `x` を計算します。ここで `f` は実線形写像をエンコードしており、すなわち `norm(b - f(x))` を最小化する解 `x` です。近似解 `x` と `ConvergenceInfo` 構造体を返します。

!!! note "実線形写像に関する注意"
    関数 `f` は、`f(add(x,y)) = add(f(x), f(y))` および `f(scale(x, α)) = scale(f(x), α)` を満たす場合、実線形写像を実装していると言います。ここで、`x` と `y` はベクトル、`α::Real` はスカラーです。これは、ベクトルが複素数演算を使用して表現されている場合でも可能です。例えば、写像 `f=x-> x + conj(x)` は、複素スカラー `α` に対して `f(scale(x, α)) = scale(f(x), α)` を満たさないため、（複素）線形ではない実線形写像を表します。複素線形写像は常に実線形写像であるため、この文脈で使用できますが、その場合 `lssolve` と `reallssolve` は同じ解を対象とします。しかし、それでも異なる演算を使用してその解を計算するため、その場合 `lssolve` の方が効率的である可能性があります。

    ベクトル `x` と `y` を実ベクトル空間の要素として解釈するために、標準内積は `real(inner(x,y))` に置き換えられます。これは、最初からベクトル `x` と `y` が実数演算を使用して表現されていた場合には影響がなく、複素ベクトルもシームレスに使用できるようにします。


### 引数:

実線形写像は通常、関数または呼び出し可能なオブジェクトであり、行列は複素線形写像しか表現できないため、`lssolve` と組み合わせて単純に使用できます。最小二乗問題を解決するためには、写像の作用とその随伴が必要であるため、`f` は二つの呼び出し可能なオブジェクトのタプル（それぞれが単一の引数を受け取る）であるか、または二つの入力引数を受け取る単一の呼び出し可能なオブジェクトであり、第二の引数は随伴または実線形写像の通常の作用を計算する必要があるかどうかを示す `Val{true}` または `Val{false}` 型のフラグです。後者の形式は、次のように Julia の `do` ブロック構文ともうまく組み合わせることができます。

```julia
x, info = reallssolve(b; kwargs...) do x, flag
    if flag === Val(true)
        # y = 随伴写像の x に対する作用を計算
    else
        # y = 線形写像の x に対する作用を計算
    end
    return y
end
```

実線形写像 `A` または `f` に非自明な零空間がある場合、すなわち異なる最小化者が存在する場合、返される解は `norm(x)` が最小となるようにします。あるいは、オプション引数 `λ` に非ゼロの値を提供することで、スカラーを表し、最小化問題 `norm(b - A * x)^2 + λ * norm(x)^2` を解くこともできます。

### 戻り値:

戻り値は常に `x, info = reallssolve(...)` の形式であり、

  * `x`: 上記で定義された問題に対する最小二乗解
  * `info`: [`ConvergenceInfo`] 型のオブジェクトで、以下のフィールドを持ちます

      * `info.converged::Int`: 解が要求された許容誤差まで収束したかどうかに応じて 0 または 1 の値を取ります
      * `info.residual`: 近似解 `x` の残差 `b - A*x`
      * `info.normres::Real`: 正規方程式の残差のノルム、すなわち収束した解を得るために要求された許容誤差 `tol` よりも小さくする必要がある量 `norm(A'*(b - A*x) - λ^2 * x)`
      * `info.numops::Int`: 線形写像が適用された回数、すなわち `f` が呼び出された回数、またはベクトルが `A` または `A'` と掛けられた回数
      * `info.numiter::Int`: アルゴリズムの総反復回数

### アルゴリズム

デフォルト値やキーワード引数なしの最終的な（専門的な）メソッドが最終的に呼び出され、直接使用することもできます。ここでは、アルゴリズムを明示的に指定します。現在、利用可能で選択されているのは [`LSMR`](@ref) のみです。 ```
