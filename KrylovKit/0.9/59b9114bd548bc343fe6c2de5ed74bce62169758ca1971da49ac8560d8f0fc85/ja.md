```
function expintegrator(A, t::Number, u₀, u₁, …; kwargs...)
function expintegrator(A, t::Number, (u₀, u₁, …); kwargs...)
function expintegrator(A, t::Number, (u₀, u₁, …), algorithm)
```

$$
y = ϕ₀(t*A)*u₀ + t*ϕ₁(t*A)*u₁ + t^2*ϕ₂(t*A)*u₂ + …
$$

を計算します。ここで、`A` は一般的な線形写像、すなわち `AbstractMatrix` または一般的な関数または呼び出し可能なオブジェクトであり、`u₀`、`u₁` はベクトルのような振る舞いを持つ任意のJulia型です。ここで、$ϕ₀(z) = exp(z)$ および $ϕⱼ₊₁ = (ϕⱼ(z) - 1/j!)/z$ です。特に、$y = x(t)$ は常微分方程式 $ẋ(t) = A*x(t) + ∑ⱼ t^j/j! uⱼ₊₁$ の解を表し、$x(0) = u₀$ です。

!!! note
    入力ベクトル `u₀` と `u₁` のみがある場合、`t` は `Inf` に等しくなることができ、その場合、アルゴリズムは固定点 `y = - A \ u₁ + P₀ u₀` まで進化しようとします。ここで、`P₀` は `A` の固有値ゼロの固有空間への射影子です（存在する場合）。ただし、`A` に実部がゼロより大きい固有値がある場合、常微分方程式の解は発散します。すなわち、固定点は安定ではありません。


### 引数:

線形写像 `A` は `AbstractMatrix`（密または疎）またはベクトルに対する線形写像の作用を実装する一般的な関数または呼び出し可能なオブジェクトであることができます。`A` が `AbstractMatrix` の場合、`x` は `AbstractVector` であることが期待されます。そうでない場合、`x` はベクトルとして振る舞い、必要なメソッドをサポートする任意の型であることができます（KrylovKit ドキュメントを参照）。

時間パラメータ `t` は実数または複素数であり、`t` を虚数にし、`A` をエルミートに選択する方が良いです。その場合、虚数単位を反エルミートの `A` に吸収します。前者の場合、Lanczos スキームを使用して Krylov 部分空間を構築し、線形写像の指数作用の近似を得ます。引数 `u₀`、`u₁`、… は任意の型であり、`A` の定義域にあるべきです。

### 戻り値:

戻り値は常に `y, info = expintegrator(...)` の形であり、

  * `y`: 計算の結果、すなわち $y = ϕ₀(t*A)*u₀ + t*ϕ₁(t*A)*u₁ + t^2*ϕ₂(t*A)*u₂ + …$
  * `info`: [`ConvergenceInfo`] 型のオブジェクトで、以下のフィールドを持ちます

      * `info.converged::Int`: 時間 `t` における解 `y` が要求された許容誤差以下で見つかった場合は 0 または 1、すなわち `info.normres <= tol * abs(t)` の場合
      * `info.residual::Nothing`: 値 `nothing`、この場合の残差の概念はありません
      * `info.normres::Real`: 解に蓄積された総誤差の（粗い）推定
      * `info.numops::Int`: 線形写像が適用された回数、すなわち `f` が呼び出された回数、またはベクトルが `A` と掛けられた回数
      * `info.numiter::Int`: Krylov 部分空間が再起動された回数（以下を参照）

### キーワード引数:

キーワード引数とそのデフォルト値は次の通りです：

  * `verbosity::Int = 0`: 冗長性レベル、すなわち 

      * 0（すべてのメッセージを抑制）
      * 1（警告のみ）
      * 2（最後に収束情報を含むメッセージを1つ）
      * 3（各反復後の進捗情報）
      * 4+（上記すべておよび Lanczos または Arnoldi 反復に関する追加情報）
  * `krylovdim = 30`: 構築される Krylov 部分空間の最大次元。ベクトル空間の次元は知られていないか、チェックされません。たとえば、`x₀` は必ずしも `Base.length` 関数をサポートする必要はありません。実際の問題の次元がデフォルト値より小さいことがわかっている場合は、`krylovdim` の値を減らすことが有用ですが、原則としてこれは検出されるべきです。
  * `tol = 1e-12`: 単位時間あたりの要求された精度、すなわち、最終結果に対して特定の精度 `ϵ` を望む場合は、`tol = ϵ/abs(t)` を設定します。たとえば、単精度（`Float32`）で作業する場合は、デフォルト値を変更する必要があります。
  * `maxiter::Int = 100`: Krylov 部分空間を再構築できる回数；アルゴリズムの詳細については以下を参照してください。
  * `issymmetric`: 線形写像が対称である場合、`T<:Real` の場合のみ意味があります
  * `ishermitian`: 線形写像がエルミートである場合。最後の2つのデフォルト値はメソッドに依存します。`AbstractMatrix` が使用される場合、`issymmetric` と `ishermitian` はその行列に対してチェックされます。そうでない場合、デフォルト値は `issymmetric = false` および `ishermitian = T <: Real && issymmetric` です。
  * `eager::Bool = false`: 真の場合、Krylov 部分空間の各拡張後に収束をテストするために結果を計算しようとします。そうでない場合、Krylov 部分空間が次元 `krylovdim` になるまで待ちます。これにより、進化の総時間が非常に小さい場合などに、より早く戻ることができますが、各拡張ステップ後により多くの計算が行われるため、オーバーヘッドも発生します。

### アルゴリズム

キーワード引数なしで、異なるベクトル `u₀`、`u₁`、… をタプルで持つ最後のメソッドが最終的に呼び出され、直接使用することもできます。ここでは、アルゴリズムを明示的に [`Lanczos`](@ref)（実対称または複素エルミート線形写像用）または [`Arnoldi`](@ref)（一般的な線形写像用）として指定します。これらの名前は Krylov 部分空間を構築するプロセスを指し、実対称マップと組み合わせて複素時間ステップを使用することもできます。 ```
