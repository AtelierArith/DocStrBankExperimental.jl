```
lssolve(A::AbstractMatrix, b::AbstractVector, [λ::Real = 0]; kwargs...)
lssolve(f, b, [λ = 0]; kwargs...)
# エキスパートバージョン:
lssolve(f, b, algorithm, [λ = 0])
```

最小二乗解 `x` を問題 `A * x ≈ b` または `f(x) ≈ b` に対して計算します。ここで `f` は線形写像をエンコードしており、すなわち `norm(b - f(x))` を最小化する解 `x` です。近似解 `x` と `ConvergenceInfo` 構造体を返します。

### 引数:

線形写像は `AbstractMatrix`（密または疎）または一般的な関数または呼び出し可能なオブジェクトであることができます。最小二乗問題を解決するためには、線形写像の作用とその随伴が必要であるため、`f` は二つの呼び出し可能なオブジェクトのタプル（それぞれが単一の引数を受け取る）であるか、または二つの入力引数を受け取る単一の呼び出し可能なオブジェクトである必要があります。後者の形式は、線形写像の随伴または通常の作用を計算する必要があるかどうかを示す `Val{true}` または `Val{false}` 型のフラグが第二引数として渡されます。この形式は、次のように Julia の `do` ブロック構文ともうまく組み合わせることができます。

```julia
x, info = lssolve(b; kwargs...) do x, flag
    if flag === Val(true)
        # y = 随伴写像の x に対する作用を計算
    else
        # y = 線形写像の x に対する作用を計算
    end
    return y
end
```

線形写像 `A` または `f` に非自明な零空間がある場合、すなわち異なる最小化者が存在する場合、返される解は `norm(x)` が最小となるように選ばれます。あるいは、オプション引数 `λ` に非ゼロの値を提供することで、最小化問題 `norm(b - A * x)^2 + λ * norm(x)^2` を解くこともできます。

!!! info "初期推測"
    `lssolve` は解の初期推測 `x₀` を指定することを許可しないことに注意してください。初期推測は常に線形写像の定義域における零ベクトルであると仮定され、これは線形写像の随伴作用を `b` に適用し、その結果に `zerovector` を適用することで得られます。良い初期推測 `x₀` がある場合、ユーザーは修正された右辺 `b - f(x₀)` で `lssolve` を呼び出し、`lssolve` によって返された解に `x₀` を加えることができます。得られたベクトル `x` は元の問題に対する最小二乗解ですが、`norm(x - x₀)` が最小であるか、または `norm(b - A * x)^2 + λ * norm(x-x₀)^2` が最小化されます。


### 戻り値:

戻り値は常に `x, info = lssolve(...)` の形式であり、

  * `x`: 上記で定義された問題に対する最小二乗解
  * `info`: [`ConvergenceInfo`] の型のオブジェクトで、以下のフィールドを持ちます

      * `info.converged::Int`: 解が要求された許容誤差まで収束したかどうかに応じて 0 または 1 の値を取ります
      * `info.residual`: 近似解 `x` の残差 `b - A*x`
      * `info.normres::Real`: 正規方程式の残差のノルム、すなわち収束した解を得るために要求された許容誤差 `tol` よりも小さくする必要がある量 `norm(A'*(b - A*x) - λ^2 * x)`
      * `info.numops::Int`: 線形写像が適用された回数、すなわち `f` が呼び出された回数、またはベクトルが `A` または `A'` と掛けられた回数
      * `info.numiter::Int`: アルゴリズムの総反復回数

!!! warning "収束の確認"
    収束した解が見つからなかった場合、警告は表示されないため、常に `info.converged == 1` を確認してください。


### キーワード引数:

キーワード引数は次のように指定されます。

  * `verbosity::Int = 0`: 冗長性レベル、すなわち 

      * 0（すべてのメッセージを抑制）
      * 1（警告のみ）
      * 2（開始時と終了時の情報）
      * 3（各反復後の進捗情報）
  * `atol::Real`: 残差のノルムに対する要求された精度、すなわち絶対許容誤差。
  * `rtol::Real`: 右辺 `b` のノルムに対する残差のノルムの要求された精度。
  * `tol::Real`: 実際にアルゴリズムによって使用される残差のノルムに対する要求された精度; デフォルトは `max(atol, rtol*norm(b))` です。したがって、`atol` と `rtol` のいずれかを使用するか、または直接 `tol` を使用します（この場合、`atol` と `rtol` の値は無視されます）。
  * `maxiter::Integer`: アルゴリズムの反復回数。各反復は線形写像の一回の適用と線形写像の随伴の一回の適用を含みます。

デフォルト値は `atol = KrylovDefaults.tol`、`rtol = KrylovDefaults.tol`、`tol = max(atol, rtol*norm(b))`、`maxiter = KrylovDefaults.maxiter` によって与えられます。詳細については [`KrylovDefaults`](@ref) を参照してください。

### アルゴリズム

最終的な（エキスパート）メソッドは、デフォルト値とキーワード引数なしで呼び出され、直接使用することもできます。ここでは、アルゴリズムを明示的に指定します。現在、利用可能で選択されているのは [`LSMR`](@ref) のみです。 ```
