```
surface_basis(Rs, n; cartesian=true)
```

3D格子 `Rs` から、法線ベクトル `n`（または `cartesian=false` の場合はミラー指数）で指定された表面に対して、表面セルの基底を計算します。

## 出力

この関数は、以下に説明する要素を持つタプル `(rs³ᴰ, rs′²ᴰ, P)` を返します。

  * `rs³ᴰ`: 表面の平面内に最初の2つの基底ベクトルがあり、3番目のベクトルが（正の方向に）表面の法線と整列した `DirectBasis{3}` です。すべての基底ベクトルは元の直接格子の点に対応しています。
  * `rs′²ᴰ`: 表面単位セルの局所座標系で与えられた基底ベクトルを持つ `DirectBasis{2}` です。実際には、これは `n` を $\hat{\mathbf{z}}$ に持っていく回転の後の `rs³ᴰ` の $(x,y)$ 成分です。最初の基底ベクトルは、局所座標系の $\hat{\mathbf{x}}$ 方向に整列しています。
  * `P`: `rs³ᴰ` を `rs′²ᴰ` の局所 `n`-to-$\hat{\mathbf{z}}$ 回転座標系に持っていく回転行列です。特に、`rs′³ᴰ = transform.(DirectPoint.(rs³ᴰ), Ref(P))` を定義すると、次のことが成り立ちます： 	- `rs′³ᴰ[i] ≈ [rs′²ᴰ[i]..., 0]` で `i ∈ 1:2`、 	- `rs′³ᴰ[3]` は（正の方向に） `[0,0,1]` と整列しています。逆に、すなわち表面局所から格子全体の座標に変換するには、単に `P⁻¹ = transpose(P)` を使用します。

返される基底は右手系です。

## キーワード引数

  * `cartesian :: Bool = true`: 表面法線 `n` がデカルト座標系で指定されているか (`true`) または逆格子ベクトルの基底で指定されているか (`false`) です。すなわち、デカルトベクトル `n[1]*Gs[1] + n[2]*Gs[2] + n[3]*Gs` に対応し、`Gs` は逆格子ベクトルのデカルト表現を示します。すなわち、`Gs = dualbasis(Rs)` です。後者の場合 (`false`) は、ミラー指数に基づく表面の仕様です：`n` の座標は、`Rs` によって張られる各軸との表面の切片の逆として同等に解釈できます。

## 例

```jldoctest
julia> sgnum = 195; # P23, 立方格子

julia> Rs = directbasis(sgnum, 3)
DirectBasis{3} (cubic):
 [1.0, 0.0, 0.0]
 [0.0, 1.0, 0.0]
 [0.0, 0.0, 1.0]

julia> n = [1,1,1]; # 111方向に投影

julia> rs³ᴰ, rs′²ᴰ, P = surface_basis(Rs, n; cartesian=true);

julia> rs³ᴰ # 元の座標系における表面基底
DirectBasis{3} (hexagonal):
 [1.0, -1.5700924586837747e-16, -0.9999999999999998]
 [-0.9999999999999998, 0.9999999999999997, 0.0]
 [1.0, 1.0, 1.0]

julia> rs′²ᴰ # 局所「表面座標系」における面内ベクトル
DirectBasis{2} (hexagonal):
 [1.414213562373095, 0.0]
 [-0.7071067811865475, 1.2247448713915887]

julia> DirectBasis(transform.(DirectPoint.(rs³ᴰ), Ref(P))) # rs³ᴰ から rs′²ᴰ 座標への変換 
DirectBasis{3} (hexagonal):
 [1.414213562373095, -1.1102230246251563e-16, 0.0]
 [-0.7071067811865476, 1.2247448713915885, 0.0]
 [0.0, -1.1102230246251563e-16, 1.7320508075688772]
```

!!! warning
    この関数は将来的に Crystalline から Bravais.jl に移動される可能性があります。

