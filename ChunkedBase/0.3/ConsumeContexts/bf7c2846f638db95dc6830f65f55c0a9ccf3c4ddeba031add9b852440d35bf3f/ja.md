```
setup_tasks!(consume_ctx::AbstractConsumeContext, chunking_ctx::ChunkingContext, ntasks::Int)
```

パーサー/消費タスクが完了する必要がある作業単位の数を設定します（例えば、`task_done!`を介して完了として報告される）現在の入力データのチャンクが完全に処理されたと見なされる前に。

この関数は、現在のデータチャンク内の改行位置の検出が完了した直後に呼び出され、検出された改行のパーティションをパース/消費タスクに提出しようとしています。

`ntasks`は、入力のサイズに応じて`parse_file`への`nworkers`引数の間で1からの値です。ほとんどの場合、値は`nworkers`が使用されますが、バッファサイズが小さい場合や小さなファイル、またはファイルの最後のバイトを処理する場合、`ntasks`は小さくなり、入力のバイト数の最小平均タスクサイズが少なくとも16.000 KiBになるようにします。`:serial`パースモードでは、`ntasks`は常に1です。

チャンク内の同時作業の量をさらに細分化する場合、このメソッドをオーバーライドする必要があります。例えば、`@spawn`タスクで各列を別々に処理したい場合、その場合はチャンクごとに`ntasks * (1 + length(parsing_ctx.schema))`の作業単位があると期待されます（この場合、列処理タスク内で手動で`task_done!`を呼び出す必要があります）。

[`consume!`](@ref)、[`setup_tasks!`](@ref)、[`task_done!`](@ref)、[`cleanup`](@ref)も参照してください。
