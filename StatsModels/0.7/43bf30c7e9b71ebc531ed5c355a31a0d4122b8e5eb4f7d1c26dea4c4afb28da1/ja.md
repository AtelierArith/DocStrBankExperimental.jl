```
@formula(ex)
```

数式表現を `Formula` 構造体としてキャプチャし、解析します。

数式は、回帰モデルなどの *左辺* と *右辺* の変数間の依存関係の抽象的な仕様です。各側は、表形式のデータをモデル化に適した数値行列に変換する方法を高レベルで指定します。この仕様は、Julia コードのように見え、Julia の `Expr` として表現されますが、特別な構文を使用します。`@formula` マクロは、`y ~ 1 + a*b` のような式を受け取り、数式構文ルールに従って低下した形式（`y ~ 1 + a + b + a&b` のような）に変換し、元の式、低下した式、左辺および右辺をキャプチャする `Formula` 構造体を構築します。

この構文で特別な解釈を持つ演算子は次のとおりです。

  * `~` は数式の区切りであり、二項演算子です（最初の引数が左辺、2 番目が右辺です）。
  * `+` はモデル行列を生成する際に変数を列として連結します。
  * `&` は 2 つ以上の変数間の *相互作用* を表し、これは個々の項の行ごとのクロネッカー積（または、すべての関与する項が連続/スカラーの場合は要素ごとの積）に対応します。
  * `*` はすべての主効果と相互作用に展開されます：`a*b` は `a+b+a&b` と同等であり、`a*b*c` は `a+b+c+a&b+a&c+b&c+a&b&c` と同等です。
  * `1`、`0`、および `-1` は、切片列の存在（`1` の場合）または不在（`0` および `-1` の場合）を示します。

適用されるルールは次のとおりです。

  * 結合則（`+`、`&`、および `*` のネストされた呼び出しをアンネストします）。
  * 分配則（相互作用 `&` は連結 `+` に分配されます）。
  * `*` ルールは `a*b` を `a+b+a&b` に展開します（再帰的に）。
  * 減算は加算と否定に変換されるため、`x-1` は `x + -1` になります（リテラル 1 の減算にのみ適用されます）。
  * 単一引数の `&` 呼び出しは削除されるため、`&(x)` は主効果 `x` になります。
