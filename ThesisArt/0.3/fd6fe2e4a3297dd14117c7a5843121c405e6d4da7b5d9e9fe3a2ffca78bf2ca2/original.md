Code written mostly by Julius Krumbiegel with some modifications by Benedikt Ehinger

# Important: Don't provide a closed path, it can lead to infinite loops
