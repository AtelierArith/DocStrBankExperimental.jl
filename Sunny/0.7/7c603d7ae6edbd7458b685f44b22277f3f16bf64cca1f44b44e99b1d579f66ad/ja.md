```
set_onsite_coupling!(sys::System, op, i::Int)
```

すべての単位セルの`i`番目の原子およびすべての対称的に等価な原子に対して、単一イオン異方性を設定します。演算子`op`は、局所スピン演算子の抽象関数、[`spin_matrices`](@ref)の多項式、または[`stevens_matrices`](@ref)の線形結合として提供できます。

# 例

```julia
# z方向の簡単な軸異方性
set_onsite_coupling!(sys, S -> -D*S[3]^3, i)

# 立方体点群対称性を持つサイトのためのユニークな四次単一イオン異方性
set_onsite_coupling!(sys, S -> 20*(S[1]^4 + S[2]^4 + S[3]^4), i)

# 定数シフトを除いたこの四次異方性の同等の表現
O = stevens_matrices(spin_label(sys, i))
set_onsite_coupling!(sys, O[4,0] + 5*O[4,4], i)
```

!!! warning "量子スピン演算子から生じる制限"
    単一イオン異方性は、量子スピン$s = 1/2$の局所モーメントに対して物理的に不可能です。例えば、任意のパウリ行列の二乗は単位行列を与えることを考慮してください。一般的に、$s < k/2$のとき、$k$次のスティーブンス演算子`O[k, q]`はゼロであることを確認できます。したがって、スピン演算子における四次の異方性には$s ≥ 2$が必要であり、六次の異方性には$s ≥ 3$が必要です。この物理的制限を回避するために、Sunnyは量子スピン演算子を古典的なモーメントに単純に置き換えるモード`:dipole_uncorrected`を提供します。詳細については、ドキュメントページ[Interaction Renormalization](@ref)を参照してください。

