```
MultiPhaseTPFlash(;kwargs...)
```

非反応性多相（`np` 相）、多成分（`nc` 成分）フラッシュ問題を解決するためのメソッドです。

フラッシュアルゴリズムは、安定性テストを繰り返し行い新しい相を見つけ（[1]）、次に `nc * np * ss_iters` 回の反復でラチフォード-ライス法と逐次代入法を用いてシステムを解こうとします。

ラチフォード-ライスの逐次代入法が収束しない場合、変数として lnK-β-ρ を使用して VT 空間でギブス最小化を行うことでシステムを解決します（[3]）。

アルゴリズムは、SS またはギブス最小化が収束し、すべての結果相が安定するまで終了しません。

相平衡の結果が安定でない場合、最大 `phase_iters` 回の反復で再度相を追加/削除することになります。

### キーワード引数:

  * `K0`（オプション）、定数 K の初期推定値
  * `x0`（オプション）、相 x の組成の初期推定値
  * `y0`（オプション）、相 y の組成の初期推定値
  * `n0`（オプション）、すべての組成の初期推定値。行列またはベクトルのベクトルであることができます。
  * `K_tol = sqrt(eps(Float64))`、計算を停止するための許容誤差（`norm(lnK,1) < K_tol`）
  * `ss_iters = 4`、実行する逐次代入の反復回数
  * `nacc = 3`、nacc ステップごとに逐次代入法を加速します。3より大きい整数である必要があります。加速しない場合は 0 に設定します。
  * `second_order = true`、解析ヘッセ行列を使用してギブスエネルギー最小化を解くかどうか。`false` に設定すると、ギブス最小化は L-BFGS を使用して行われます。
  * `full_tpd` = false、単純な K スプリットから始めるか、最初に集中的な TPD 検索を使用するかどうか。
  * `max_phases = typemax(Int)`、`min(max_phases,nc)` 相を超えるとアルゴリズムは停止します。
  * `phase_iters = 20`、相を解決・追加/削除する最大反復回数

## 参考文献

1. Thermopack - 新しいフレームワークで再実装された熱力学的平衡アルゴリズム。 (2020年9月8日)。 https://github.com/thermotools/thermopack. 2024年5月4日取得、 https://github.com/thermotools/thermopack/blob/main/docs/memo/flash/flash.pdf
2. Okuno, R., Johns, R. T. T., & Sepehrnoori, K. (2010). 多相組成シミュレーションのためのラチフォード-ライスの新しいアルゴリズム。SPE Journal, 15(02), 313–325. [doi:10.2118/117752-pa](https://doi.org/10.2118/117752-pa)
3. Adhithya, T. B., & Venkatarathnam, G. (2021). 等温-等圧フラッシュ計算のための新しい圧力および密度ベースの手法。Fluid Phase Equilibria, 537(112980), 112980. [doi:10.1016/j.fluid.2021.112980](https://doi.org/10.1016/j.fluid.2021.112980)
