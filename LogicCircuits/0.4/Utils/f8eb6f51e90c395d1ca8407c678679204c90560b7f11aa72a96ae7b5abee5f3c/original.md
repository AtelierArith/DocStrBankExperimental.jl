Reuse a given array if it has the right type and size, otherwise make a new one
