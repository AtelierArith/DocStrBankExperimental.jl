```julia
mutable struct Recenter <: Conditioner
    metric 
    eVar 
    w 
    âœ“w 
    init 
    tol 
    verbose 
    forcediag 
    threaded 
    ## Fitted parameters
    Z 
    iZ 
```

**å†ä¸­å¿ƒåŒ–**ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼ã®ãŸã‚ã®å¯å¤‰æ§‹é€ ä½“ã€‚

æ­£å®šå€¤è¡Œåˆ—ã®ãƒžãƒ‹ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã«ãŠã‘ã‚‹ `nÂ·n` ç‚¹ã®é›†åˆ $ð$ ãŒä¸Žãˆã‚‰ã‚ŒãŸã¨ãã€æ¬¡ã®ã‚ˆã†ã«é›†åˆã‚’å¤‰æ›ã—ã¾ã™ã€‚

$$
ZP_jZ^T, \ j=1,...,k
$$

,

ã“ã“ã§ $Z$ ã¯ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼ã«ã‚ˆã£ã¦æŒ‡å®šã•ã‚ŒãŸ $ð$ ã®ãƒãƒªã‚»ãƒ³ã‚¿ãƒ¼ã®ãƒ›ãƒ¯ã‚¤ãƒˆãƒ‹ãƒ³ã‚°è¡Œåˆ—ã§ã™ã€‚ã™ãªã‚ã¡ã€$G$ ãŒ $ð$ ã®ãƒãƒªã‚»ãƒ³ã‚¿ãƒ¼ã§ã‚ã‚‹å ´åˆã€$ZGZ^T=I$ ã¨ãªã‚Šã¾ã™ã€‚

å†ä¸­å¿ƒåŒ–ã®å¾Œã€ãƒãƒªã‚»ãƒ³ã‚¿ãƒ¼ã¯å˜ä½è¡Œåˆ—ã«ãªã‚Šã€ãƒ›ãƒ¯ã‚¤ãƒˆãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸè¡Œåˆ—ã®å›ºæœ‰å€¤ã®å¹³å‡ã¯ 1 ã«ãªã‚Šã¾ã™ã€‚æ­£å®šå€¤è¡Œåˆ—ã®ãƒžãƒ‹ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã«ãŠã„ã¦ã€å†ä¸­å¿ƒåŒ–ã¯ã™ã¹ã¦ã®ç‚¹ã‚’å˜ä½ãƒãƒªã‚»ãƒ³ã‚¿ãƒ¼ã«å¹³è¡Œè¼¸é€ã™ã‚‹ã“ã¨ã«ç›¸å½“ã—ã¾ã™ã€‚

[`Recenter`](@ref) ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ `eVar` å€¤ã«å¿œã˜ã¦ã€è¡Œåˆ— $Z$ ã¯å…¥åŠ›ç‚¹ã®æ¬¡å…ƒå‰Šæ¸›ã‚’æ±ºå®šã™ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã®å ´åˆã€$Z$ ã¯æ­£æ–¹è¡Œåˆ—ã§ã¯ãªãã€æ¬¡å…ƒ $pÂ·n$ ã®ãƒ¯ã‚¤ãƒ‰è¡Œåˆ—ã§ã‚ã‚Šã€$p<n$ ã§ã™ã€‚

ã“ã®ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼ã¯ **æ•™å¸«ã‚ã‚Š** ã®æ–¹æ³•ã§å‹•ä½œã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°æ™‚ã«ã‚¯ãƒ©ã‚¹ãƒ©ãƒ™ãƒ«ã‚’æä¾›ã™ã‚‹ã¨ï¼ˆ[`fit!`](@ref) ã‚’å‚ç…§ï¼‰ã€ã‚¯ãƒ©ã‚¹ã¯ãƒãƒªã‚»ãƒ³ã‚¿ãƒ¼ $G$ ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ç­‰ã—ãé‡ã¿ä»˜ã‘ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€æŽ¥ç©ºé–“ãƒžãƒƒãƒ”ãƒ³ã‚°ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒªã‚»ãƒ³ã‚¿ãƒ¼ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã® [`tsWeights`](@ref) ã¨åŒæ§˜ã§ã™ã€‚ã‚¯ãƒ©ã‚¹ãŒãƒãƒ©ãƒ³ã‚¹ã—ã¦ã„ã‚‹å ´åˆã€é‡ã¿ä»˜ã‘ã¯å½±éŸ¿ã‚’ä¸Žãˆã¾ã›ã‚“ã€‚

ã“ã®ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼æ§‹é€ ä½“ã«ã¯æ¬¡ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Šã¾ã™ï¼š

  * `.metric` ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦æŒ‡å®šã•ã‚Œã‚‹ [Metric](https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1) åž‹ã§ã™ã€‚ã‚¯ãƒ©ã‚¹ã®å¹³å‡ã¨å¹³å‡ã¸ã®è·é›¢ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«æŽ¡ç”¨ã•ã‚Œã‚‹ãƒ¡ãƒˆãƒªãƒƒã‚¯ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `PosDefManifold.Euclidean` ã§ã™ã€‚
  * `.eVar` ã¯ã€ãƒ›ãƒ¯ã‚¤ãƒˆãƒ‹ãƒ³ã‚°ã®ãŸã‚ã®å¸Œæœ›ã™ã‚‹èª¬æ˜Žã•ã‚ŒãŸåˆ†æ•£ã§ã™ã€‚Realã€Intã€ã¾ãŸã¯ `nothing` ã§ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Diagonalizations.jl ã®ãƒ¡ã‚½ãƒƒãƒ‰ [whitening](https://marco-congedo.github.io/Diagonalizations.jl/dev/whitening/#Diagonalizations.whitening) ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ 0.9999 ã§ã™ã€‚
  * ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ `.w`ã€`.âœ“w`ã€`.init`ã€ãŠã‚ˆã³ `.tol` ã¯ã€ãƒãƒªã‚»ãƒ³ã‚¿ãƒ¼ $G$ ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã« PosDefManifold.jl ã® [mean](https://marco-congedo.github.io/PosDefManifold.jl/latest/riemannianGeometry/#Statistics.mean) ãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã•ã‚Œã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯ã€ãã“ã«ã‚ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
  * `.verbose` ã¯ã€`fit!` ãŠã‚ˆã³ `transform!` ã‚’ä½¿ç”¨ã™ã‚‹éš›ã« REPL ã«æƒ…å ±ã‚’å°åˆ·ã™ã‚‹ã‹ã©ã†ã‹ã‚’æ±ºå®šã™ã‚‹ãƒ–ãƒ¼ãƒ«å€¤ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ false ã§ã™ã€‚
  * `.forcediag` ã¯ã€å¯¾è§’åŒ–ã‚’å¼·åˆ¶ã™ã‚‹ãŸã‚ã®ãƒ–ãƒ¼ãƒ«å€¤ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ true ã§ã™ã€‚false ã®å ´åˆã€ãƒ›ãƒ¯ã‚¤ãƒˆãƒ‹ãƒ³ã‚°ã¯æ¬¡å…ƒå‰Šæ¸›ãŒå¿…è¦ãªå ´åˆã«ã®ã¿å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ `eVar` ã«ã‚ˆã£ã¦æ±ºå®šã•ã‚Œã¾ã™ã€‚
  * `.threaded` ãŒ true ã®å ´åˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã€ã™ã¹ã¦ã®æ“ä½œã¯ãƒžãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ã€`metric` ã¯å¼•æ•°ã§ã‚ã‚Šã€`eVar`ã€`w`ã€`âœ“w`ã€`init`ã€`tol`ã€`verbose`ã€`forcediag`ã€ãŠã‚ˆã³ `threaded` ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã§ã™ã€‚

**ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**

ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼ãŒãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã‚‹ã¨ã€æ¬¡ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ›¸ãè¾¼ã¾ã‚Œã¾ã™ï¼š

  * `.Z` ã¯ã€ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸã‚»ãƒƒãƒˆ $P_j, \ j=1,...,k$ ã®ãƒ›ãƒ¯ã‚¤ãƒˆãƒ‹ãƒ³ã‚°è¡Œåˆ—ã§ã‚ã‚Šã€$ZP_jZ^T$ ãŒãƒ›ãƒ¯ã‚¤ãƒˆãƒ‹ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚
  * `.iZ` ã¯ã€$Z$ ã®å·¦é€†è¡Œåˆ— $Z^*$ ã§ã‚ã‚Šã€æ¬¡å…ƒå‰Šæ¸›ãŒè¡Œã‚ã‚Œãªã„å ´åˆã€$Z^*Z=I$ï¼ˆå˜ä½è¡Œåˆ—ï¼‰ã¨ãªã‚Šã¾ã™ã€‚

æ¬¡å…ƒå‰Šæ¸›ãŒè¡Œã‚ã‚Œã‚‹å ´åˆã€$Z^*Zâ‰ I$ ã¯ãƒ©ãƒ³ã‚¯ $p$ ã«ãªã‚Šã¾ã™ã€‚

**ä¾‹**ï¼š

```julia
using PosDefManifoldML, PosDefManifold

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼ã‚’ä½œæˆ
R = Recenter(PosDefManifold.Euclidean)

# ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ãƒ¡ãƒˆãƒªãƒƒã‚¯ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒˆãƒªãƒƒã‚¯ã§ã‚ã‚‹ãŸã‚ã€
# ã“ã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ç­‰ä¾¡ã§ã™
R = Recenter()

# æ¬¡å…ƒå‰Šæ¸›ã‚’è¡Œã‚ãªã„
R = Recenter(PosDefManifold.Fisher; eVar=nothing)

# æ¬¡å…ƒã‚’ 10 ã«å‰Šæ¸›
R = Recenter(PosDefManifold.Fisher; eVar=10)

# åˆ†æ•£ã®å°‘ãªãã¨ã‚‚ 90% ã‚’èª¬æ˜Žã™ã‚‹æ¬¡å…ƒã‚’æ±ºå®š
R = Recenter(PosDefManifold.Fisher; eVar=0.9)

# ã‚¯ãƒ©ã‚¹ãƒ©ãƒ™ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã‚¯ãƒ©ã‚¹é–“ã®é‡ã¿ã‚’ãƒãƒ©ãƒ³ã‚¹ã•ã›ã‚‹
# ï¼ˆ`y` ãŒã‚¯ãƒ©ã‚¹ãƒ©ãƒ™ãƒ«ã‚’ä¿æŒã™ã‚‹æ•´æ•°ã®ãƒ™ã‚¯ã‚¿ãƒ¼ã§ã‚ã‚‹ã¨ã—ã¾ã™ï¼‰
R = Recenter(PosDefManifold.Fisher; labels=y)

```

**é–¢é€£é …ç›®**: [`fit!`](@ref), [`transform!`](@ref), [`crval`](@ref)
