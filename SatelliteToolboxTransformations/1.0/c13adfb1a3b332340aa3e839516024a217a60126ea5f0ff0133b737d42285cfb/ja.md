```
sv_eci_to_ecef(sv::OrbitStateVector, ECI, ECEF[, jd_utc][, eop]) -> OrbitStateVector
```

地球中心慣性（`ECI`）参照フレームから地球中心固定（`ECEF`）参照フレームへの軌道状態ベクトル `sv` を、ユリウス日 `jd_utc` [UTC] で計算します。エポック `jd_utc` が提供されていない場合、アルゴリズムは軌道状態ベクトル `sv` のエポック（`sv.t`）を使用します。アルゴリズムは、ソースおよび宛先フレームに応じて、地球の姿勢パラメータ（EOP） `eop` を必要とする場合があります。

入力の速度と加速度は `sv` において ECI フレームの観測者によって取得されたものと仮定されています。したがって、出力には ECEF フレームの観測者によって測定された速度と加速度が含まれます。

!!! note
    原点と宛先の参照フレームを指定する方法を含む詳細については、**拡張ヘルプ**を参照してください。


# 戻り値

  * `OrbitStateVector`: `ECI` 参照フレームに変換された軌道状態ベクトル `sv`。

# 拡張ヘルプ

## 変換モデル

回転を計算するために使用されるモデルは、原点と宛先フレームの選択に基づいて自動的に推測されます。**IAU-76/FK5 と IAU-2006/2010 フレームを混合することはサポートされていないことに注意してください。**

## サポートされている ECI 参照フレーム

ECI フレームはパラメータ `ECI` によって選択されます。可能な値は次のとおりです。

  * `TEME()`: ECI は真の赤道平均春分点（TEME）参照フレームとして選択されます。
  * `TOD()`: ECI は日付の真（TOD）として選択されます。
  * `MOD()`: ECI は日付の平均（MOD）として選択されます。
  * `J2000()`: ECI は J2000 参照フレームとして選択されます。
  * `GCRF()`: ECI は地心天体参照フレーム（GCRF）として選択されます。
  * `CIRS()`: ECEF は天体中間参照系（CIRS）として選択されます。
  * `ERS()`: ECI は地球参照系（ERS）として選択されます。
  * `MOD06()`: ECI は IAU-2006/2010 理論の定義に従って日付の平均（MOD）として選択されます。
  * `MJ2000()`: ECI は J2000 平均赤道フレーム（MJ2000）として選択されます。

!!! note
    フレーム `MOD()` と `MOD06()` は実質的に同じです。ただし、IAU-76/FK5 と IAU-2006/2010 のフレーム間の変換を混合する際には注意が必要であるため、どの理論が使用されているかを明確にするために異なる名前を選択しました。


## サポートされている ECEF 参照フレーム

ECEF フレームはパラメータ `ECEF` によって選択されます。可能な値は次のとおりです。

  * `ITRF()`: ECEF は国際地球参照フレーム（ITRF）として選択されます。
  * `PEF()`: ECEF は擬似地球固定（PEF）参照フレームとして選択されます。
  * `TIRS()`: ECEF は地球中間参照系（TIRS）として選択されます。

## 地球の姿勢パラメータ（EOP）

フレーム間の変換は EOP に依存する場合があります（[`fetch_iers_eop`](@ref) および [`read_iers_eop`](@ref) を参照）。IAU-76/FK5 モデルが使用される場合、`eop` の型は [`EopIau1980`](@ref) でなければなりません。そうでない場合、IAU-2006/2010 モデルが使用される場合、`eop` の型は [`EopIau2000A`](@ref) でなければなりません。以下の表は、選択されたフレームに応じた EOP データの要件を示しています。

| モデル                  | ECI      | ECEF   | EOP データ      |
|:-------------------- |:-------- |:------ |:------------ |
| IAU-76/FK5           | `GCRF`   | `ITRF` | EOP IAU1980  |
| IAU-76/FK5           | `J2000`  | `ITRF` | EOP IAU1980  |
| IAU-76/FK5           | `MOD`    | `ITRF` | EOP IAU1980  |
| IAU-76/FK5           | `TOD`    | `ITRF` | EOP IAU1980  |
| IAU-76/FK5           | `TEME`   | `ITRF` | EOP IAU1980  |
| IAU-76/FK5           | `GCRF`   | `PEF`  | EOP IAU1980  |
| IAU-76/FK5           | `J2000`  | `PEF`  | 不要¹          |
| IAU-76/FK5           | `MOD`    | `PEF`  | 不要¹          |
| IAU-76/FK5           | `TOD`    | `PEF`  | 不要¹          |
| IAU-76/FK5           | `TEME`   | `PEF`  | 不要¹          |
| IAU-2006/2010 CIOベース | `CIRS`   | `ITRF` | EOP IAU2000A |
| IAU-2006/2010 CIOベース | `GCRF`   | `ITRF` | EOP IAU2000A |
| IAU-2006/2010 CIOベース | `CIRS`   | `TIRS` | 不要¹          |
| IAU-2006/2010 CIOベース | `GCRF`   | `TIRS` | 不要¹ ²        |
| IAU-2006/2010 春分点ベース | `ERS`    | `TIRS` | EOP IAU2000A |
| IAU-2006/2010 春分点ベース | `MOD06`  | `ITRF` | EOP IAU2000A |
| IAU-2006/2010 春分点ベース | `MJ2000` | `ITRF` | EOP IAU2000A |
| IAU-2006/2010 春分点ベース | `ERS`    | `TIRS` | 不要¹ ³        |
| IAU-2006/2010 春分点ベース | `MOD06`  | `TIRS` | 不要¹ ³        |
| IAU-2006/2010 春分点ベース | `MJ2000` | `TIRS` | 不要¹ ³        |

`¹`: この場合、UTC はグリニッジ平均恒星時を計算するために UT1 と等しいと仮定されます。これは近似ですが、一部のアプリケーションには十分に正確であるはずです。EOP データが提供されている場合、UT1 は正確に計算されます。

`²`: この場合、自由コア揺動および天体中間極（CIP）位置の時間依存効果に関する項は利用できず、精度が低下します。

`³`: この場合、自由コア揺動による傾斜および経度の揺動を修正する項は利用できず、精度が低下します。

!!! info
    この関数では、EOP 補正が提供されていない場合、MOD および TOD フレームは元の IAU-76/FK5 理論を考慮して計算されます。そうでない場合、補正されたフレームが使用されます。


## 例

```julia-repl
julia> eop_iau1980 = fetch_iers_eop(Val(:IAU1980));

julia> jd_utc = date_to_jd(2004, 4, 6, 7, 51, 28.386009);

julia> r_gcrf = [5102.50895790; 6123.01140070; 6378.13692820] * 1000;

julia> v_gcrf = [-4.7432201570; 0.7905364970; 5.5337557270] * 1000;

julia> sv_gcrf = OrbitStateVector(jd_utc, r_gcrf, v_gcrf)
OrbitStateVector{Float64, Float64}:
  epoch : 2.4531e6 (2004-04-06T07:51:28.386)
      r : [5102.51, 6123.01, 6378.14]    km
      v : [-4.74322, 0.790536, 5.53376]  km/s

julia> sv_itrf = sv_eci_to_ecef(sv_gcrf, GCRF(), ITRF(), eop_iau1980)
OrbitStateVector{Float64, Float64}:
  epoch : 2.4531e6 (2004-04-06T07:51:28.386)
      r : [-1033.48, 7901.3, 6380.36]    km
      v : [-3.22564, -2.87245, 5.53192]  km/s

julia> eop_iau2000a = fetch_iers_eop(Val(:IAU2000A));

julia> sv_tirs = sv_eci_to_ecef(sv_gcrf, GCRF(), TIRS(), eop_iau2000a)
OrbitStateVector{Float64, Float64}:
  epoch : 2.4531e6 (2004-04-06T07:51:28.386)
      r : [-1033.48, 7901.31, 6380.34]   km
      v : [-3.22563, -2.87244, 5.53193]  km/s
```
