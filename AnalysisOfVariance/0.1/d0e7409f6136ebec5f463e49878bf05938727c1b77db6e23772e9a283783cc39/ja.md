anova(::DataFrame, depvar::Symbol, groupvar::Symbol) anova(::DataFrame, depvar::Symbol, groupvar1::Symbol, groupvar2::Symbol; type = 1, interaction = false) anova(::DataFrame, fm::FormulaTerm; type=1) anova(::StatsModels.TableRegressionModel)

一元および二元ANOVA分析を実行します。`depvar`は連続変数で、`groupvar1`および`groupvar2`はグループ変数です。現在、`anova`は2つの異なる構文をサポートしています。最初の構文では、変数名、ANOVAタイプ、および相互作用を引数として直接指定する必要があります。2番目の構文では、線形回帰の`formula`（StatsModels.jlの@formula言語に従う）とANOVAタイプを指定する必要があります。

## オプション:

  * `df` - AbstractDataFrameの入力データ
  * `depvar` - 従属変数（連続）
  * `groupvar`, `groupvar1`, `groupvar2` - 独立変数。すべてCategoricalArraysでなければなりません。
  * `fm` - フォーミュラ
  * `type` - ANOVAの平方和のタイプ。現在、I、II、IIIがサポートされています。Iには1、IIには2を指定します。これらのタイプはSAS GLMで生成されるタイプに一致します。タイプIはStataの`sequential`平方和と同じで、タイプIIIは`partial`平方和です。
  * `interaction` - 相互作用項を含めるかどうかを示します。フォーミュラを指定する2番目の構文では、`groupvar1 * groupvar2`をフォーミュラの一部として含めるか、`groupvar1 & groupvar2`として含めます。

## 出力:

出力は、要素が次の構造体です。

  * type - 平方和のタイプ
  * title - ANOVAテーブルの行タイトル
  * ss - 平方和
  * df - 自由度
  * ms - 平均平方和
  * F - F統計量
  * pvalue - P値

## 例

この例では、https://vincentarelbundock.github.io/Rdatasets/csv/causaldata/auto.csv からダウンロードした`auto`データセットを使用します。国内製と外国製、またはMPGテルトによって車の価格が異なるかどうかを調べたいと思います。

`auto.mpg`に基づいてMPGテルトを作成し、それをCategoricalArraysに変換します。`xtile`および`values!`関数は、どちらも「未発表」のStella.jlパッケージの一部です。

```
julia> auto.mpg3 = xtile(auto, :mpg, nq = 3);

julia> values!(auto,:foreign, Dict(0 => "Domestic", 1 => "Foreign"));

julia> tab(auto, :foreign)
──────────┬───────────────────────────
  foreign │ Counts   Percent  Cum Pct 
──────────┼───────────────────────────
 Domestic │     52   70.2703  70.2703
  Foreign │     22   29.7297    100.0
──────────┼───────────────────────────
    Total │     74     100.0    100.0
──────────┴───────────────────────────

julia> values!(auto,:mpg3, Dict(1 => "MPG Tertile 1", 2 => "MPG Tertile 2", 3 => "MPG Tertile 3"));

julia> tab(auto, :mpg3)
───────────────┬───────────────────────────
          mpg3 │ Counts   Percent  Cum Pct 
───────────────┼───────────────────────────
 MPG Tertile 1 │     27   36.4865  36.4865
 MPG Tertile 2 │     24   32.4324  68.9189
 MPG Tertile 3 │     23   31.0811    100.0
───────────────┼───────────────────────────
         Total │     74     100.0    100.0
───────────────┴───────────────────────────
```

### 1. 一元ANOVA

```
julia> aov = anova(auto, :price, :mpg3)

分散分析（1元）

   Source │            SS  DF            MS      F       P 
──────────┼────────────────────────────────────────────────
    Model │ 136763694.954   2  68381847.477  9.743  0.0002
     mpg3 │ 136763694.954   2  68381847.477  9.743  0.0002
 Residual │ 498301701.168  71   7018333.819
──────────┼────────────────────────────────────────────────
    Total │ 635065396.122  73   8699525.974

julia> aov.pvalue[1]
0.00018235773127089433
```

### 2. 二元ANOVA

#### 2.1. タイプI平方和、相互作用なし

```
julia> aov = anova(auto, :price, :foreign, :mpg3, type = 1)

分散分析（タイプI）

   Source │            SS  DF            MS       F         P 
──────────┼───────────────────────────────────────────────────
    Model │ 154897061.512   3  51632353.837   7.527    0.0002
  foreign │   1507382.657   1   1507382.657   0.220    0.6407
     mpg3 │ 153389678.855   2  76694839.428  11.181  < 0.0001
 Residual │ 480168334.610  70   6859547.637
──────────┼───────────────────────────────────────────────────
    Total │ 635065396.122  73   8699525.974

julia> aov.pvalue[3] # mpg3のP値
6.112930853953449e-5
```

#### 2.2. タイプII平方和、相互作用なし

```
julia> aov = anova(auto, :price, :foreign, :mpg3, type = 2)

分散分析（タイプII）

   Source │            SS  DF            MS       F         P 
──────────┼───────────────────────────────────────────────────
    Model │ 154897061.512   3  51632353.837   7.527    0.0002
  foreign │  18133366.558   1  18133366.558   2.644    0.1085
     mpg3 │ 153389678.855   2  76694839.428  11.181  < 0.0001
 Residual │ 480168334.610  70   6859547.637
──────────┼───────────────────────────────────────────────────
    Total │ 635065396.122  73   8699525.974

julia> aov.pvalue[3] # mpg3のP値
6.112930853953449e-5
```

#### 2.3. タイプI平方和、相互作用あり

```
julia> aov = anova(auto, :price, :foreign, :mpg3, type = 1, interaction = true)

分散分析（タイプI）

         Source │            SS  DF            MS       F         P 
────────────────┼───────────────────────────────────────────────────
          Model │ 156625170.566   5  31325034.113   4.452    0.0014
        foreign │   1507382.657   1   1507382.657   0.214    0.6449
           mpg3 │ 153389678.855   2  76694839.428  10.901  < 0.0001
 foreign & mpg3 │   1728109.054   2    864054.527   0.123    0.8846
       Residual │ 478440225.555  68   7035885.670
────────────────┼───────────────────────────────────────────────────
          Total │ 635065396.122  73   8699525.974

julia> aov.pvalue[3] # mpg3のP値
7.829523220630382e-5
```

#### 2.4. タイプII平方和、相互作用あり

```
julia> aov = anova(auto, :price, :foreign, :mpg3, type = 2, interaction = true)

分散分析（タイプII）

         Source │            SS  DF            MS       F         P 
────────────────┼───────────────────────────────────────────────────
          Model │ 156625170.566   5  31325034.113   4.452    0.0014
        foreign │  18133366.558   1  18133366.558   2.577    0.1130
           mpg3 │ 153389678.855   2  76694839.428  10.901  < 0.0001
 foreign & mpg3 │   1728109.054   2    864054.527   0.123    0.8846
       Residual │ 478440225.555  68   7035885.670
────────────────┼───────────────────────────────────────────────────
          Total │ 635065396.122  73   8699525.974

julia> aov.pvalue[3] # mpg3のP値
7.829523220630382e-5
```

#### 2.5. タイプIII平方和、相互作用あり

```
julia> aov = anova(auto, :price, :foreign, :mpg3, type = 3, interaction = true)

分散分析（タイプIII）

         Source │            SS  DF            MS      F       P 
────────────────┼────────────────────────────────────────────────
          Model │ 156625170.566   5  31325034.113  4.452  0.0014
        foreign │  19148362.309   1  19148362.309  2.722  0.1036
           mpg3 │ 129967822.960   2  64983911.480  9.236  0.0003
 foreign & mpg3 │   1728109.054   2    864054.527  0.123  0.8846
       Residual │ 478440225.555  68   7035885.670
────────────────┼────────────────────────────────────────────────
          Total │ 635065396.122  73   8699525.974

julia> aov.pvalue[3] # mpg3のP値
0.0002828218888318445
```

#### 2.6. フォーミュラを使用したタイプIII平方和、相互作用あり

```
julia> aov = anova(auto, @formula(price ~ foreign + mpg3 + foreign & mpg3), type=3)

分散分析（タイプIII）

         Source │            SS  DF            MS      F       P 
────────────────┼────────────────────────────────────────────────
          Model │ 156625170.566   5  31325034.113  4.452  0.0014
        foreign │  19148362.309   1  19148362.309  2.722  0.1036
           mpg3 │ 129967822.960   2  64983911.480  9.236  0.0003
 foreign & mpg3 │   1728109.054   2    864054.527  0.123  0.8846
       Residual │ 478440225.555  68   7035885.670
────────────────┼────────────────────────────────────────────────
          Total │ 635065396.122  73   8699525.974

julia> aov.pvalue[3] # mpg3のP値
0.0002828218888318445
```
