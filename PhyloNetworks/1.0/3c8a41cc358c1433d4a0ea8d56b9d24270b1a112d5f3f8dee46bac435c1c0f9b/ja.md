```
hardwiredclusterdistance(net1::HybridNetwork, net2::HybridNetwork, rooted::Bool)
```

`net1`と`net2`のトポロジー間のハードワイヤードクラスタ距離、すなわち、一方のネットワークに存在し、もう一方には存在しないハードワイヤードクラスタの数（重複を含む、以下参照）。

2つのネットワークが木である場合、これはロビンソン-フォルズ距離です。`rooted=false`の場合、両方のネットワークは半方向と見なされます。

ネットワークはバイコンビニングであると仮定されます（各ハイブリッドには正確に2つの親があります）。

## 非類似性と距離

これは系統ネットワークの全空間における距離ではありません：この非類似性が0である異なるネットワークのペアがあります。しかし、これは「通常の」（ショートカットなし）ツリー子ネットワークのクラスや、ハイブリッドエッジの長さが0で、ツリーエッジの長さが非負であるようにノードの年齢を割り当てることができるツリー子ネットワークのクラスなど、一部のネットワーククラスにおける距離です。詳細は[Cardona, Rossello & Valiente (2008)](https://doi.org/10.1016/j.mbs.2007.11.003)、[Cardona, Llabres, Rossello & Valiente (2008)](https://doi.org/10.1109/TCBB.2008.70)、および[Huson, Rupp, Scornavacca (2010)](https://doi.org/10.1017/CBO9780511974076)を参照してください。

## 例

```jldoctest
julia> net1 = readnewick("(t6,(t5,((t4,(t3,((t2,t1))#H1)),#H1)));");

julia> taxa = sort(tiplabels(net1)); # t1からt6まで、アルファベット順にソート

julia> # using PhyloPlots; plot(net1, showedgenumber=true);

julia> # 以下の行列: 列1: エッジ番号。最終列: ツリー (10) 対 ハイブリッド (11) エッジ
       # 中間列: 'taxa' のため: t1,...t6。1=子孫、0=子孫でない
       hardwiredclusters(net1, taxa)
6×8 Matrix{Int64}:
 13  1  1  1  1  1  0  10
 12  1  1  1  1  0  0  10
 10  1  1  1  1  0  0  10
  9  1  1  1  0  0  0  10
  8  1  1  0  0  0  0  11
  7  1  1  0  0  0  0  10

julia> net2 = readnewick("(t6,(t5,((t4,(t3)#H1),(#H1,(t1,t2)))));");

julia> hardwiredclusters(net2, taxa)
6×8 Matrix{Int64}:
 13  1  1  1  1  1  0  10
 12  1  1  1  1  0  0  10
  6  0  0  1  1  0  0  10
  5  0  0  1  0  0  0  11
 11  1  1  1  0  0  0  10
 10  1  1  0  0  0  0  10

julia> hardwiredclusterdistance(net1, net2, true) # true: 根付きネットワークとして
4
```

## ハードワイヤードクラスタとは？

ネットワーク内の各エッジはその*ハードワイヤードクラスタ*に関連付けられています。すなわち、すべての子孫タクサ（葉）の集合です。ネットワークのハードワイヤードクラスタの集合は、そのエッジのハードワイヤードクラスタの集合です。[Huson, Rupp, Scornavacca (2010)](https://doi.org/10.1017/CBO9780511974076)で定義された非類似性`d_hard`は、一方のネットワークには存在するが他方には存在しないハードワイヤードクラスタの数です。

この実装は、各クラスタが重複を持ってカウントされ、エッジのハイブリッドステータスで注釈が付けられる`d_hard`のやや差別的なバージョンです。以下のように：

  * 外部エッジはカウントされません（それらは葉へのツリーエッジであり、すべての系統ネットワークで共有されています）。
  * クラスタは、そのハードワイヤードクラスタであるエッジごとにカウントされます。
  * 特定のハイブリッドノードでは、両方のハイブリッドパートナーエッジが同じクラスタを持つため、このクラスタは両方のパートナーに対して1回だけカウントされます。
  * 特定のクラスタは、両方のネットワークでツリーエッジからのクラスタである場合、または両方のネットワークでハイブリッドエッジからのクラスタである場合にのみ、2つのネットワーク間で一致します。

上記の例では、`net1`にはショートカット（ハイブリッドエッジ11）があり、同じクラスタ{t1,t2,t3,t4}を持つ2つのツリーエッジ（12と10）を生成します。したがって、クラスタ{t1,t2,t3,t4}は`net1`で重複2回カウントされます。`net2`もこのクラスタを持っていますが、1つのツリーエッジにのみ関連付けられているため、このクラスタは2-1=1をハードワイヤードクラスタ距離に寄与します。距離4はこれらの4つのクラスタに対応します：

  * {t1,t2,t3,t4}: net1で2回、net2で1回
  * {t3,t4}: net1には存在せず、net2で1回
  * {t1,t2}: net1で2回（ハイブリッドエッジとツリーエッジから）、net2で1回
  * {t3}: net1には存在せず（外部エッジはカウントされないため）、net2で1回（ハイブリッドエッジから）。

次数2のノードは複数のエッジが同じクラスタを持つ原因となるため、重複を持ってクラスタをカウントすることで、これらのノードが抑制された後の「同じ」ネットワークと追加の次数2ノードを持つネットワークを区別します（例：[`PhyloNetworks.fuseedgesat!`](@ref)または[`PhyloNetworks.shrinkedge!`](@ref)を使用）。

## ネットワークを半方向として

`rooted`がfalseで、系統の1つが木でない場合（1つ以上のリトリキュレーション）、ハードワイヤードクラスタを比較する前にすべての次数2ノードが削除され、内部ノードでネットワークを根付けるすべての可能な方法に対して最小距離が返されます。

詳細は[`hardwiredclusters`](@ref)、[`hardwiredcluster`](@ref)を参照してください。
