ペニングトラップと磁気ボトルの (x,y,z) 座標系。Yanyan Shi, Yajuan Sun, Yulei Wang, Jian Liu に基づく、荷電粒子ダイナミクスのシミュレーションのための適応的シンプレクティック法の研究、Journal of Computational Dynamics 6, 429-448, 2019。

ベクトルポテンシャルの共変成分は次のように与えられます。

$$
A (x,y,z) = B_0 / 2 \, ( -y , x, 0)^T - B_1 \, (xz, yz, (x^2 + y^2)/2 - z^2)^T,
$$

これにより、共変成分を持つ磁場が得られます。

$$
B (x,y,z) = B_0 \, ( 0, 0, 1)^T - B_1 \, ( yz^2 - y^3 / 6, x^3 / 6, xyz )^T ,
$$

そして、静電ポテンシャルは次のように与えられます。

$$
\varphi (x,y,z) = E_0 \, ( x^2 / 2 + y^2 / 2 - z^2) ,
$$

これにより、共変成分を持つ電場が得られます。

$$
E (x,y,z) = E_0 \, ( x, y, - 2 z)^T .
$$

パラメータ：

  * `B₀`: B場の強度
  * `Bₚ`: B場の摂動強度
  * `E₀`: E場の強度
