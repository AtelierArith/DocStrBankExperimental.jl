```
perturbationgrowth([p,] bd, t) -> ts, Rs, is
```

`bd`における`p`の軌道に沿った摂動ベクトル`Δ`の進化を総時間`t`にわたって計算します。`Δ`は`[1,1,1,1]`として初期化されます。

粒子が指定されていない場合、[`randominside`](@ref)を通じてランダムな粒子が選ばれます。ピン留めされた粒子には空のリストが返されます。

## 説明

この関数は、[1]に概説されているように、システムの線形化されたダイナミクスを使用して摂動ベクトルの時間進化を*安全に*計算します。ダイナミクスが線形であるため、衝突のたびに摂動ベクトルを安全に再正規化できます（そうしないと、摂動が無限大に成長します）。

すべての衝突の*直前*および*直後*に、この関数は以下を計算します。

  * 現在の時間。
  * Δとその前の値の要素ごとの比率。
  * 現在の障害物の障害物インデックス。

これらは3つのベクトル`ts, Rs, is`として返されます。

摂動ベクトルの*実際の*進化を得るには、関数`perturbationevolution(Rs)`を使用できます。これは単に以下を行います。

```julia
Δ = Vector{SVector{4,Float64}}(undef, length(R))
Δ[1] = R[1]
for i in 2:length(R)
    Δ[i] = R[i] .* Δ[i-1]
end
```

[1] : Ch. Dellago *et al*, [Phys. Rev. E **53** (1996)](http://link.aps.org/doi/10.1103/PhysRevE.53.1485)
