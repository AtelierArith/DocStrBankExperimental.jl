```
tree_hash([ predicate, ] tarball;
          [ algorithm = "git-sha1", ]
          [ skip_empty = false ]) -> hash::String

    predicate  :: Header --> Bool
    tarball    :: Union{AbstractString, AbstractCmd, IO}
    algorithm  :: AbstractString
    skip_empty :: Bool
```

tarball이 포함하고 있는 파일 트리에 대한 트리 해시 값을 계산합니다. 기본적으로 이는 SHA1 보안 해시 함수를 사용하는 git의 트리 해싱 알고리즘을 사용합니다(현재 버전의 git과 유사). 이는 git이 표현할 수 있는 파일 트리를 가진 모든 tarball—즉, 파일, 심볼릭 링크 및 비어 있지 않은 디렉토리만 있는 tarball—에 대해 이 함수로 계산된 해시 값이 해당 파일 트리에 대해 git이 계산할 해시 값과 동일함을 의미합니다. tarball은 git이 저장할 수 없는 비어 있는 디렉토리를 포함하는 파일 트리를 표현할 수 있으며, 이 함수는 이러한 디렉토리에 대한 해시를 생성할 수 있습니다. 기본적으로(아래의 `skip_empty`를 참조하여 이 동작을 변경하는 방법) 이러한 비어 있는 디렉토리를 생략하는 tarball의 해시와는 다릅니다. 요약하자면, 해시 함수는 git이 표현할 수 있는 모든 트리에 대해 git과 일치하지만, git이 표현할 수 없는 다른 트리에 대해 해시 가능한 트리의 도메인을 일관된 방식으로 확장합니다.

`predicate` 함수가 전달되면, `tarball`을 처리하는 동안 만나는 각 `Header` 객체에 대해 호출되며, `predicate(hdr)`가 true인 경우에만 항목이 해시됩니다. 이는 아카이브의 일부만 선택적으로 해시하거나, `extract`가 오류를 발생시키는 항목을 건너뛰거나, 해싱 과정에서 추출된 내용을 기록하는 데 사용할 수 있습니다.

`Header` 객체는 predicate 함수에 전달되기 전에 tarball의 원시 헤더에서 다소 수정됩니다: `path` 필드는 `.` 항목을 제거하고 여러 개의 연속 슬래시를 단일 슬래시로 대체하도록 정규화됩니다. 항목의 유형이 `:hardlink`인 경우, 링크 대상 경로도 동일한 방식으로 정규화되어 대상 항목의 경로와 일치하도록 합니다; 크기 필드는 대상 경로의 크기로 설정됩니다(이미 본 파일이어야 함).

현재 지원되는 `algorithm` 값은 `git-sha1`(기본값)과 `git-sha256`이며, 이는 `git-sha1`과 동일한 기본 알고리즘을 사용하지만 SHA1 해시 함수를 SHA2-256으로 교체합니다. 이는 git이 향후 사용할 해시 함수입니다(SHA1에 대한 알려진 공격으로 인해). 향후 다른 파일 트리 해싱 알고리즘에 대한 지원이 추가될 수 있습니다.

`skip_empty` 옵션은 파일이나 심볼릭 링크가 재귀적으로 포함되지 않은 tarball의 디렉토리를 해시에 포함할지 무시할지를 제어합니다. 일반적으로 tarball이나 파일 트리의 내용을 해시하는 경우, 비어 있지 않은 디렉토리뿐만 아니라 모든 디렉토리에 관심이 있으므로 이러한 디렉토리를 계산된 해시에 포함하는 것이 기본값입니다. 그렇다면 이 함수가 비어 있는 디렉토리를 건너뛰는 옵션을 제공하는 이유는 무엇인가요? git은 비어 있는 디렉토리를 저장하는 것을 거부하고, 이를 repo에 추가하려고 하면 무시합니다. 따라서 git repo에 파일을 추가하여 참조 트리 해시를 계산한 후 git에 트리 해시를 요청하면, 얻는 해시 값은 `skip_empty=true`로 `tree_hash`로 계산된 해시 값과 일치합니다. 다시 말해, 이 옵션은 `tree_hash`가 비어 있는 디렉토리가 있는 트리를 해시하는 방법을 에뮬레이트할 수 있게 해줍니다. 그러나 비어 있는 디렉토리를 포함할 수 있는 트리를 해시하는 경우(즉, git repo에서 오지 않는 경우), 비어 있는 디렉토리를 무시하지 않는 도구(이 도구와 같은)를 사용하여 해시하는 것이 권장됩니다.
