```julia
(1)
function comodulation( ùê°‚ÇÅ     :: TFAmplitudeVector,
                       ùê°‚ÇÇ     :: TFAmplitudeVector,
                       frange :: fInterval,
                       trange :: tInterval;
                  mode  :: Function = extract,
                  func  :: Function = identity,
                  w     :: Vector = [],
                  check :: Bool   = true) =

(2)
function comodulation( ùê≥‚ÇÅ     :: TFAnalyticSignalVector,
                       ùê≥‚ÇÇ     :: TFAnalyticSignalVector,
    < arguments frange, trange, mode, func, w and check as in method (1) >

(3)
function comodulation(ùê±‚ÇÅ        :: Vector{Vector{T}},
                      ùê±‚ÇÇ        :: Vector{Vector{T}},
                      sr        :: Int,
                      wl        :: Int,
                      frange    :: fInterval,
                      trange    :: tInterval,
                      bandwidth :: IntOrReal    = 2;
                mode            :: Function     = extract,
                func            :: Function     = identity,
                w               :: Vector       = [],
                filtkind        :: FilterDesign = Butterworth(2),
                fmin            :: IntOrReal    = bandwidth,
                fmax            :: IntOrReal    = sr√∑2,
                fsmoothing      :: Smoother     = noSmoother,
                tsmoothing      :: Smoother     = noSmoother,
                planner         :: Planner      = getplanner,
                ‚è©             :: Bool         = true) where T<:Real

```

**„Ç®„Ç§„É™„Ç¢„Çπ**: com

(1)

[TFAmplitudeVector](@ref) „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Éö„Ç¢„Çí‰∏é„Åà„Çâ„Çå„ÅüÂ†¥Âêà„ÄÅ[(Âä†Èáç)„Ç≥„É¢„Ç∏„É•„É¨„Éº„Ç∑„Éß„É≥](@ref) Ê∏¨ÂÆöÂÄ§„ÇíÊé®ÂÆö„Åó„Åæ„Åô„ÄÇ`ùêÄ‚ÇÅ` „Å® `ùêÄ‚ÇÇ` „ÅØÂêå„ÅòÊï∞„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰øùÊåÅ„Åó„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÊôÇÈñìÂë®Ê≥¢Êï∞Âπ≥Èù¢„ÅØÂêàÂêå„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

**ÂºïÊï∞**:

`frange` „Å® `trange` „ÅØ [`meanAmplitude`](@ref) „É°„ÇΩ„ÉÉ„Éâ„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ

**„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÂºïÊï∞**

`mode`„ÄÅ`func`„ÄÅ„Åä„Çà„Å≥ `check` „ÅØ [`meanAmplitude`](@ref) „É°„ÇΩ„ÉÉ„Éâ„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ

`w` „ÅØ„ÄÅÂêÑÂÖ•Âäõ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Éö„Ç¢„Å´Èñ¢ÈÄ£‰ªò„Åë„Çâ„Çå„ÅüÈùûË≤†„ÅÆÂÆüÊï∞„ÅÆÈáç„Åø„ÅÆ„Éô„ÇØ„Éà„É´„Åß„ÅÇ„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Éá„Éï„Ç©„É´„Éà„Åß„ÅØ„ÄÅÊ∏¨ÂÆöÂÄ§„ÅÆÈáç„Åø„Å™„Åó„Éê„Éº„Ç∏„Éß„É≥„ÅåË®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ

(2)

[TFAnalyticSignalVector](@ref) „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Éö„Ç¢„Çí‰∏é„Åà„Çâ„Çå„ÅüÂ†¥Âêà„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÊåØÂπÖ„ÇíË®àÁÆó„Åó„ÄÅ„É°„ÇΩ„ÉÉ„Éâ (1) „Å´Âæì„Å£„Å¶ [(Âä†Èáç)„Ç≥„É¢„Ç∏„É•„É¨„Éº„Ç∑„Éß„É≥](@ref) „ÇíÊé®ÂÆö„Åó„Åæ„Åô„ÄÇ„É°„ÇΩ„ÉÉ„Éâ (1) „Å®ÂêåÊßò„Å´„ÄÅ`ùêô‚ÇÅ` „Å® `ùêô‚ÇÇ` „ÅØÂêå„ÅòÊï∞„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰øùÊåÅ„Åó„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÊôÇÈñìÂë®Ê≥¢Êï∞Âπ≥Èù¢„ÅØÂêàÂêå„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åï„Çâ„Å´„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„Çí‰ΩøÁî®„Åô„ÇãÂ†¥Âêà„ÄÅ`ùêô‚ÇÅ` „Å® `ùêô‚ÇÇ` „ÅÆ„Åô„Åπ„Å¶„ÅÆ [TFAnalyticSignal](@ref) „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅØ `linear` „Åß„Å™„Åë„Çå„Å∞„Å™„Çâ„Åö„ÄÅ`check` „Åå true („Éá„Éï„Ç©„É´„Éà) „ÅÆÂ†¥Âêà„ÄÅ„Åù„ÅÜ„Åß„Å™„ÅÑ„Å®„Ç®„É©„Éº„ÇíÂç∞Âà∑„Åó„ÄÅ`Nothing` „ÇíËøî„Åó„Åæ„Åô„ÄÇ„É°„ÇΩ„ÉÉ„Éâ (1) „Å´„Çà„Å£„Å¶ÂÆüË°å„Åï„Çå„Çã `frange` „Å® `trange` „ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„ÇÇ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„Å´„Çà„Å£„Å¶ÂÆüË°å„Åï„Çå„Åæ„Åô„ÄÇ

(3)

`ùê±‚ÇÅ` „Å® `ùê±‚ÇÇ` „ÅÆ„Åô„Åπ„Å¶„ÅÆ„Éá„Éº„Çø„Éô„ÇØ„Éà„É´„ÅÆÊåØÂπÖ„ÇíÊé®ÂÆö„Åó„ÄÅ[`TFamplitude`](@ref) „Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„ÇíÂëº„Å≥Âá∫„Åó„Å¶„Åã„Çâ„ÄÅ„É°„ÇΩ„ÉÉ„Éâ (1) „Å´Âæì„Å£„Å¶ÊßãÁØâ„Åï„Çå„ÅüÊåØÂπÖ„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÈñì„Åß [(Âä†Èáç)„Ç≥„É¢„Ç∏„É•„É¨„Éº„Ç∑„Éß„É≥](@ref) Ê∏¨ÂÆöÂÄ§„ÇíÊé®ÂÆö„Åó„Åæ„Åô„ÄÇ

`frange`„ÄÅ`trange`„ÄÅ`mode`„ÄÅ`func`„ÄÅ`w`„ÄÅ„Åä„Çà„Å≥ `check` „ÅØ„É°„ÇΩ„ÉÉ„Éâ (1) „Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ‰ªñ„ÅÆÂºïÊï∞„ÅØ [`TFamplitude`](@ref) „Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„Å´Ê∏°„Åï„Çå„ÄÅ„Åù„ÅÆÊÑèÂë≥„Å´„Å§„ÅÑ„Å¶„ÅØË™≠ËÄÖ„Å´ÂèÇÁÖß„Åï„Çå„Åæ„Åô„ÄÇ

FFTË®àÁÆó„ÅÆ„Åü„ÇÅ„ÅÆ `planner` „ÅåÊèê‰æõ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÄÅ1ÂõûË®àÁÆó„Åï„Çå„ÄÅ„Åô„Åπ„Å¶„ÅÆÊåØÂπÖÊé®ÂÆö„Å´ÈÅ©Áî®„Åï„Çå„Åæ„Åô„ÄÇ

**ÂèÇÁÖß**: [`coherence`](@ref)„ÄÅ[timefrequencybi.jl](@ref)„ÄÇ

**‰æã**:

```julia
using FourierAnalysis

# „Éá„Éº„Çø„Éô„ÇØ„Éà„É´„ÅÆ100„Éö„Ç¢„ÇíÁîüÊàê
sr, t, bandwidth=128, 512, 2
h=taper(harris4, t)
ùê±‚ÇÅ=[sinusoidal(2, 10, sr, t, 0).*h.y+randn(t) for i=1:100]
ùê±‚ÇÇ=[sinusoidal(2, 10, sr, t, 0).*h.y+randn(t) for i=1:100]

# „Åù„Çå„Çâ„ÅÆÔºàÁ∑öÂΩ¢ÔºâËß£Êûê‰ø°Âè∑„ÇíË®àÁÆó
ùêò‚ÇÅ=TFanalyticsignal(ùê±‚ÇÅ, sr, wl, bandwidth; fmax=32, nonlinear=false)
ùêò‚ÇÇ=TFanalyticsignal(ùê±‚ÇÇ, sr, wl, bandwidth; fmax=32, nonlinear=false)

# „Åù„Çå„Çâ„ÅÆÊåØÂπÖ„ÇíË®àÁÆó
ùêÄ‚ÇÅ=TFamplitude(ùêò‚ÇÅ)
ùêÄ‚ÇÇ=TFamplitude(ùêò‚ÇÇ)

# TFAnalyticSignal „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ TF È†òÂüü„Åß„ÅÆ Com Âπ≥Âùá„ÇíË®àÁÆó
# ùêò‚ÇÅ „Å® ùêò‚ÇÇ „ÅØÁ∑öÂΩ¢„Åß„Å™„Åë„Çå„Å∞„Å™„Çâ„Å™„ÅÑ
Com=comodulation(ùêò‚ÇÅ, ùêò‚ÇÇ, (8, 12), :; mode=mean)

# TFAmplitudeVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ TF È†òÂüü„Åß„ÅÆ Com Âπ≥Âùá„ÇíË®àÁÆó
# ùêÄ‚ÇÅ „Å® ùêÄ‚ÇÇ „ÅØÁ∑öÂΩ¢„Åß„Å™„Åë„Çå„Å∞„Å™„Çâ„Å™„ÅÑ
Com=comodulation(ùêÄ‚ÇÅ, ùêÄ‚ÇÇ, (8, 12), :; mode=mean)

# „Éá„Éº„Çø„Åã„ÇâÁõ¥Êé• TF È†òÂüü„Åß„ÅÆ Com Âπ≥Âùá„ÇíË®àÁÆó
# „Åì„ÅÆÂ†¥Âêà„ÄÅÁ∑öÂΩ¢ÊÄß„Å´„Å§„ÅÑ„Å¶ÂøÉÈÖç„Åô„ÇãÂøÖË¶Å„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì
Com=comodulation(ùê±‚ÇÅ, ùê±‚ÇÇ, sr, wl, (8, 12), :, bandwidth; mode=mean)

# „Çπ„É†„Éº„Ç∫„Å™ÊåØÂπÖ„Åã„Çâ„Ç≥„É¢„Ç∏„É•„É¨„Éº„Ç∑„Éß„É≥„ÇíË®àÁÆó:
Com=comodulation(ùê±‚ÇÅ, ùê±‚ÇÇ, sr, wl, (8, 12), :, bandwidth;
                 mode=mean,
                 fsmoothing=blackmanSmoother,
                 tsmoothing=blackmanSmoother)

# FFTW „Éó„É©„É≥„Çí‰∫ãÂâç„Å´Ë®àÁÆó„Åô„Çã„Åì„Å®„Åß„ÄÅ„Çà„ÇäÈÄü„Åè„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ
# „Åì„Çå„ÅØ„ÄÅ„Ç≥„É¢„Ç∏„É•„É¨„Éº„Ç∑„Éß„É≥Èñ¢Êï∞„Çí‰ΩïÂ∫¶„ÇÇÂëº„Å≥Âá∫„ÅôÂøÖË¶Å„Åå„ÅÇ„ÇãÂ†¥Âêà„Å´‰æøÂà©„Åß„Åô
plan=Planner(plan_patient, 5, wl, Float64, true)
Com=comodulation(ùê±‚ÇÅ, ùê±‚ÇÇ, sr, wl, (8, 12), :, bandwidth; mode=mean, planner=plan)

# TFAnalyticSignalVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ TF È†òÂüü„Åß„ÅÆ Com „ÇíË®àÁÆó
Com=comodulation(ùêò‚ÇÅ, ùêò‚ÇÇ, (8, 12), :; mode=extract)

# TFAmplitudeVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ TF È†òÂüü„Åß„ÅÆ Com „ÇíË®àÁÆó
Com=comodulation(ùêÄ‚ÇÅ, ùêÄ‚ÇÇ, (8, 12), :; mode=extract)

# „Éá„Éº„Çø„Åã„ÇâÁõ¥Êé• TF È†òÂüü„Åß„ÅÆ Com „ÇíË®àÁÆó
Com=comodulation(ùê±‚ÇÅ, ùê±‚ÇÇ, sr, wl, (8, 12), :, bandwidth; mode=extract)

# „Åì„Çå„Çâ„ÅÆ„Åô„Åπ„Å¶„ÅÆÊìç‰Ωú„ÅØ„ÄÅ„Ç≥„Éí„Éº„É¨„É≥„ÇπÊ∏¨ÂÆö„Å´„ÇÇË°å„ÅÜ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Åü„Å®„Åà„Å∞
Coh=coherence(ùêò‚ÇÅ, ùêò‚ÇÇ, (8, 12), :; mode=mean)

Coh=coherence(ùêò‚ÇÅ, ùêò‚ÇÇ, (8, 12), :; mode=extract)

# „Åô„Åπ„Å¶„ÅÆ5„Å§„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ„Çø„Ç§„Éó„ÇíË®àÁÆó
Coh=coherence(ùêò‚ÇÅ, ùêò‚ÇÇ, (8, 12), :; mode=extract, allkinds=true)

# ‰ΩçÁõ∏„Ç≥„Éí„Éº„É¨„É≥„ÇπÔºà‰ΩçÁõ∏„É≠„ÉÉ„Ç≠„É≥„Ç∞ÂÄ§Ôºâ
# „Åì„ÅÆÊ∏¨ÂÆöÂÄ§„ÅØÈùûÁ∑öÂΩ¢ TFAnalyticSignalVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„ÇâÂæó„Çâ„Çå„Åæ„Åô
ùêò‚ÇÅ=TFanalyticsignal(ùê±‚ÇÅ, sr, wl, bandwidth; fmax=32, nonlinear=true)
ùêò‚ÇÇ=TFanalyticsignal(ùê±‚ÇÇ, sr, wl, bandwidth; fmax=32, nonlinear=true)

Coh=coherence(ùêò‚ÇÅ, ùêò‚ÇÇ, (8, 12), :; mode=mean, nonlinear=true)

# „Åæ„Åü„ÅØ„Éá„Éº„Çø„Åã„ÇâÁõ¥Êé•Ôºà„Åì„ÅÆÂ†¥Âêà„ÄÅÈùûÁ∑öÂΩ¢ÊÄß„Å´„Å§„ÅÑ„Å¶ÂøÉÈÖç„Åô„ÇãÂøÖË¶Å„ÅØ„ÅÇ„Çä„Åæ„Åõ„ÇìÔºâ
Coh=coherence(ùê±‚ÇÅ, ùê±‚ÇÇ, sr, wl, (8, 12), :, bandwidth; mode=mean, nonlinear=true)

```
