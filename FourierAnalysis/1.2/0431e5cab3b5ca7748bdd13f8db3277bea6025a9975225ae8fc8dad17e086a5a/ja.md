```julia
(1)
function coherence(ùôé    :: CrossSpectra;
               allkinds :: Bool = false)

(2)
function coherence(ùì¢    :: CrossSpectraVector;
               allkinds :: Bool = false,
               check    :: Bool = true)

(3)
function coherence(X  :: Matrix{T},
                   sr :: Int,
                   wl :: Int;
               tapering  :: Union{Taper, TaperKind} = harris4,
               planner   :: Planner                 = getplanner,
               slide     :: Int                     = 0,
               DC        :: Bool                    = false,
               nonlinear :: Bool                    = false,
               smoothing :: Smoother                = noSmoother,
               tril      :: Bool                    = false,
               allkinds  :: Bool                    = false,
               ‚è©       :: Bool                    = true) where T<:Real

(4)
function coherence(ùêó :: Vector{Matrix{T}},
              < same argument sr, ..., ‚è© of method (3) > where T<:Real


```

**alias**: coh

!!! note "export conflict"
    „Åì„ÅÆË≠òÂà•Â≠ê„ÅØDSP„Éë„ÉÉ„Ç±„Éº„Ç∏„Å®Á´∂Âêà„Åô„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ`FourierAnalysis.coherence`„Å®„Åó„Å¶Âëº„Å≥Âá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ


(1)

[Coherence](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí[CrossSpectra](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„ÇâÊßãÁØâ„Åó„ÄÅWelchÊ≥ï„Çí‰ΩøÁî®„Åó„Å¶„Ç≥„Éí„Éº„É¨„É≥„ÇπÊé®ÂÆö„ÇíÂèØËÉΩ„Å´„Åó„Åæ„Åô„ÄÇ„Éá„Éº„Çø„Éï„Ç£„Éº„É´„Éâ‰ª•Â§ñ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Éï„Ç£„Éº„É´„Éâ„ÅØ„ÇØ„É≠„Çπ„Çπ„Éö„ÇØ„Éà„É´„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ„Ç≥„Éî„Éº„Åï„Çå„Åæ„Åô„ÄÇ„Åô„Å™„Çè„Å°„ÄÅ`y`„ÇíÈô§„Åè„Åô„Åπ„Å¶„ÅÆ„Éï„Ç£„Éº„É´„Éâ„Åå„Ç≥„Éî„Éº„Åï„Çå„ÄÅ`y`„Å´„ÅØ„Åì„ÅÆÈñ¢Êï∞„Å´„Çà„Å£„Å¶Ë®àÁÆó„Åï„Çå„Åü„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„Åå‰øùÊåÅ„Åï„Çå„Åæ„Åô„ÄÇ

`ùôé.tril`„Ååtrue„ÅÆÂ†¥Âêà„ÄÅ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÅÆ‰∏ã‰∏âËßíÈÉ®ÂàÜ„ÅÆ„Åø„ÅåË®àÁÆó„Åï„Çå„ÄÅ`y`„ÅÆË°åÂàó„ÅØLowerTriangularË°åÂàó„Å´„Å™„Çä„Åæ„Åô„ÄÇ„Åù„ÅÜ„Åß„Å™„ÅÑÂ†¥Âêà„ÄÅÂÆåÂÖ®„Å™Ë°åÂàó„ÅåË®àÁÆó„Åï„Çå„ÄÅ`y`„ÅØ„Ç®„É´„Éü„Éº„ÉàË°åÂàó„Çí‰øùÊåÅ„Åó„Åæ„ÅôÔºà[LinearAlgebra](https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#Linear-Algebra-1Ôºâ„ÇíÂèÇÁÖßÔºâ„ÄÇ

„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÂºïÊï∞`allkinds`„Ååtrue„ÅÆÂ†¥Âêà„ÄÅ„Åô„Åπ„Å¶„ÅÆ5Á®ÆÈ°û„ÅÆ[„Ç≥„Éí„Éº„É¨„É≥„Çπ](@ref)„ÅåËøî„Åï„Çå„Åæ„Åô„ÄÇ„Åì„ÅÆÂ†¥Âêà„ÄÅÂá∫Âäõ„ÅØ„Ç≥„Éí„Éº„É¨„É≥„Çπ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ5„Çø„Éó„É´„Åß„ÄÅÈ†ÜÂ∫è„ÅØÊ¨°„ÅÆ„Å®„Åä„Çä„Åß„Åô„ÄÇ

  * *ÂÖ®‰Ωì*„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÄÅ
  * *ÂÆü*„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÄÅ
  * *Áû¨ÊôÇ*„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÄÅ
  * *Ëôö*„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÄÅ
  * *ÈÅÖÂª∂*„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÄÇ

`allkinds`„ÅåfalseÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅÆÂ†¥Âêà„ÄÅ*ÂÖ®‰Ωì*ÔºàÂè§ÂÖ∏ÁöÑÔºâ„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÅÆ„Åø„ÅåÂçò‰∏Ä„ÅÆ`Coherence`„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å®„Åó„Å¶Ëøî„Åï„Çå„Åæ„Åô„ÄÇ

(2)

ÂÖ•Âäõ[CrossSpectraVector](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà`ùì¢`„Åã„Çâ[CoherenceVector](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÊßãÁØâ„Åó„ÄÅWelchÊ≥ï„Çí‰ΩøÁî®„Åó„Å¶„Ç≥„Éí„Éº„É¨„É≥„ÇπÊé®ÂÆö„ÇíÂèØËÉΩ„Å´„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„ÅØ„ÄÅ`ùì¢`ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å´ÂØæ„Åó„Å¶„É°„ÇΩ„ÉÉ„Éâ(1)„ÇíÂëº„Å≥Âá∫„Åó„Åæ„Åô„ÄÇ

`allkinds`„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„Éâ„Éë„É©„É°„Éº„Çø„ÅØ„ÄÅ„É°„ÇΩ„ÉÉ„Éâ(1)„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„Åß„ÅØ„ÄÅÂºïÊï∞„Ååtrue„Å®„Åó„Å¶Ê∏°„Åï„Çå„Çã„Å®„ÄÅÂá∫Âäõ„ÅØ`CoherenceVector`„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ5„Çø„Éó„É´„Å´„Å™„Çä„Åæ„Åô„ÄÇ

„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÂºïÊï∞`check`„ÅåtrueÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅÆÂ†¥Âêà„ÄÅ`ùì¢`ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ`CrossSpectra`„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åå``.sr`, `.wl`, `.DC`, `.taper`, `.nonlinear`„Åä„Çà„Å≥`.smoothing`„Éï„Ç£„Éº„É´„Éâ„ÅßÂêå„ÅòÂÄ§„ÇíÊåÅ„Å§„Åì„Å®„ÅåÁ¢∫Ë™ç„Åï„Çå„Åæ„Åô„ÄÇ„Åì„Çå„ÅåÊ∫Ä„Åü„Åï„Çå„Å™„ÅÑÂ†¥Âêà„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅßÂêå‰∏Ä„Åß„Å™„ÅÑÊúÄÂàù„ÅÆ„Éï„Ç£„Éº„É´„Éâ„ÇíÊåáÊëò„Åô„Çã„Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏„ÅåË°®Á§∫„Åï„Çå„ÄÅ`Nothing`„ÅåËøî„Åï„Çå„Åæ„Åô„ÄÇ

(3)

Ê¨°ÂÖÉ$t$ x $n$„ÅÆÂ§öÂ§âÈáèÊôÇÁ≥ªÂàó„Éá„Éº„ÇøË°åÂàó`X`„Åå‰∏é„Åà„Çâ„Çå„Åü„Å®„Åç„ÄÅ„Åì„Åì„Åß$t$„ÅØ„Çµ„É≥„Éó„É´Êï∞ÔºàË°åÔºâ„ÄÅ$n$„ÅØÊôÇÁ≥ªÂàóÊï∞ÔºàÂàóÔºâ„ÄÅ„Çµ„É≥„Éó„É™„É≥„Ç∞„É¨„Éº„Éà`sr`„Åä„Çà„Å≥„Ç®„Éù„ÉÉ„ÇØÈï∑`wl`„ÇíÁî®„ÅÑ„Å¶„ÄÅ`X`„ÅÆ‰∫å‰πó„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ„Åô„Å™„Çè„Å°„ÄÅWelchÔºà„Çπ„É©„Ç§„Éá„Ç£„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶ÔºâÂπ≥Âùá„ÇØ„É≠„Çπ„Çπ„Éö„ÇØ„Éà„É´„Åã„ÇâÂæó„Çâ„Çå„Çã„Åô„Åπ„Å¶„ÅÆ„Éï„Éº„É™„Ç®Èõ¢Êï£Âë®Ê≥¢Êï∞„Åß„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„Åß„Åô„ÄÇ

**„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÂºïÊï∞**:

`sr`„ÄÅ`wl`„ÄÅ`tapering`„ÄÅ`planner`„Åä„Çà„Å≥`slide`„ÅØ[`spectra`](@ref)Èñ¢Êï∞„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ

`DC`„ÄÅ`nonlinear`„ÄÅ`smoothing`„ÄÅ`tril`„Åä„Çà„Å≥`‚è©`„ÅØ„ÄÅ„ÇØ„É≠„Çπ„Çπ„Éö„ÇØ„Éà„É´„ÇíÊé®ÂÆö„Åô„Çã„Åü„ÇÅ„Å´ÈÅ©Áî®„Åï„Çå„Çã[`crossSpectra`](@ref)Èñ¢Êï∞„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ

`allkinds`„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„Éâ„Éë„É©„É°„Éº„Çø„ÅØ„ÄÅ„É°„ÇΩ„ÉÉ„Éâ(1)„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ

(4)

ÂÆü„Éá„Éº„ÇøË°åÂàó„ÅÆ„Éô„ÇØ„Éà„É´„Åã„Çâ[CoherenceVector](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÊßãÁØâ„Åó„Åæ„Åô„ÄÇ`ùêó`ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ$k$„Éá„Éº„ÇøË°åÂàó„Å´ÂØæ„Åó„Å¶„ÄÅ„É°„ÇΩ„ÉÉ„Éâ(3)„Å´Âæì„Å£„Å¶WelchÊ≥ï„Çí‰ΩøÁî®„Åó„Å¶Êé®ÂÆö„Åï„Çå„Åü„ÇØ„É≠„Çπ„Çπ„Éö„ÇØ„Éà„É´Ë°åÂàó„Åã„Çâ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ

`ùêó`ÂÜÖ„ÅÆ$k$Ë°åÂàó„ÅØ„ÄÅÂêå„ÅòÂàóÊï∞Ôºà„Åô„Å™„Çè„Å°„ÄÅÂêå„ÅòÊôÇÁ≥ªÂàóÊï∞Ôºâ„ÇíÊåÅ„Åü„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì„Åå„ÄÅ‰ªªÊÑè„ÅÆÊï∞„ÅÆÔºàÂ∞ë„Å™„Åè„Å®„ÇÇ`wl`ÔºâË°åÔºà„Çµ„É≥„Éó„É´Ôºâ„ÇíÊåÅ„Å§„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ‰ªñ„ÅÆ„Åô„Åπ„Å¶„ÅÆÂºïÊï∞„ÅØ„É°„ÇΩ„ÉÉ„Éâ(3)„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„ÄÅ‰ª•‰∏ã„ÅÆÈÅï„ÅÑ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

`‚è©`: true„ÅÆÂ†¥ÂêàÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„ÅØ„ÄÅ$k$„ÅåJulia„Å´ÊåáÁ§∫„Åï„Çå„Åü„Çπ„É¨„ÉÉ„ÉâÊï∞„ÅÆÂ∞ë„Å™„Åè„Å®„ÇÇ2ÂÄç„Åß„ÅÇ„ÇãÂ†¥Âêà„ÄÅ$k$„Éá„Éº„ÇøË°åÂàóÂÖ®‰Ωì„Åß„Éû„É´„ÉÅ„Çπ„É¨„ÉÉ„Éâ„É¢„Éº„Éâ„ÅßÂÆüË°å„Åï„Çå„Åæ„Åô„ÄÇ„Åù„ÅÜ„Åß„Å™„ÅÑÂ†¥Âêà„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„ÅØ„É°„ÇΩ„ÉÉ„Éâ(3)„Å´Âæì„Å£„Å¶ÂêÑ„Ç≥„Éí„Éº„É¨„É≥„ÇπÊé®ÂÆö„Çí„Ç∑„É™„Éº„Ç∫ÂÖ®‰Ωì„Åß„Éû„É´„ÉÅ„Çπ„É¨„ÉÉ„Éâ„É¢„Éº„Éâ„ÅßÂÆüË°å„Åó„Çà„ÅÜ„Å®„Åó„Åæ„Åô„ÄÇ[Threads](@ref)„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

`Planner`„ÅåÊòéÁ§∫ÁöÑ„Å´ÂºïÊï∞„Å®„Åó„Å¶Ê∏°„Åï„Çå„Å™„ÅÑÂ†¥Âêà„ÄÅFFTW„Éó„É©„É≥„ÅØ‰∏ÄÂ∫¶Ë®àÁÆó„Åï„Çå„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„ÇπÊé®ÂÆö„Å´ÈÅ©Áî®„Åï„Çå„Åæ„Åô„ÄÇ

**„É°„ÇΩ„ÉÉ„Éâ(1)„Åä„Çà„Å≥(3)„Å´Èñ¢„Åô„ÇãÊ≥®ÊÑè**:

`tril`„ÅåfalseÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅÆÂ†¥Âêà„ÄÅÂá∫Âäõ„Ç≥„Éí„Éº„É¨„É≥„Çπ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅØ`Array{Hermitian,1}`Âûã„Åß„ÅÇ„Çä„ÄÅ„Åì„Çå„ÅØ[PosDefManifold](https://github.com/Marco-Congedo/PosDefManifold.jl)„Éë„ÉÉ„Ç±„Éº„Ç∏„Åß‰ΩøÁî®„Åï„Çå„Çã`‚ÑçVector`Âûã„Åß„Åô„ÄÇ„Ç≥„Éí„Éº„É¨„É≥„ÇπÊé®ÂÆö„ÅØÂØæÁß∞Ê≠£ÂÆöÂÄ§„Åß„ÅÇ„Çã„Åü„ÇÅ„ÄÅPosDefManifold„ÅÆÈñ¢Êï∞„Å´ÂºïÊï∞„Å®„Åó„Å¶„Åô„Åê„Å´‰ΩøÁî®„Åß„Åç„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅ[Ê∏¨Âú∞Á∑ö](https://marco-congedo.github.io/PosDefManifold.jl/dev/riemannianGeometry/#Geodesic-equations-1)‰∏ä„ÅÆË°åÂàóÁßªÂãï„ÄÅË°åÂàó[Ë∑ùÈõ¢](https://marco-congedo.github.io/PosDefManifold.jl/dev/riemannianGeometry/#PosDefManifold.distance)„Å™„Å©„ÄÅ„Åæ„Åü„ÅØË°åÂàó[Âπ≥Âùá](https://marco-congedo.github.io/PosDefManifold.jl/dev/riemannianGeometry/#Means-1)„ÄÅ[„Çπ„Éö„ÇØ„Éà„É´Âüã„ÇÅËæº„Åø](https://marco-congedo.github.io/PosDefManifold.jl/dev/riemannianGeometry/#PosDefManifold.spectralEmbedding)„Å™„Å©„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´‰ΩøÁî®„Åß„Åç„Åæ„Åô„ÄÇ

`tril`„Ååtrue„ÅÆÂ†¥Âêà„ÄÅÂá∫Âäõ„ÅØ`Array{LowerTriangular,1}`Âûã„Åß„ÅÇ„Çä„ÄÅ„Åì„Çå„ÅØPosDefManifold„Åß‰ΩøÁî®„Åï„Çå„Çã`ùïÉVector`Âûã„Åß„Åô„ÄÇ„Åô„Å™„Çè„Å°„ÄÅ„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÅÆ‰∏ã‰∏âËßíÈÉ®ÂàÜ„ÅÆ„Åø„ÅåË®àÁÆó„Åï„Çå„ÄÅÊôÇÈñì„Å®„É°„É¢„É™„ÇíÁØÄÁ¥Ñ„Åó„Åæ„Åô„ÄÇ

**„É°„ÇΩ„ÉÉ„Éâ(2)„Åä„Çà„Å≥(4)„Å´Èñ¢„Åô„ÇãÊ≥®ÊÑè**:

`tril`„Ååfalse„ÅÆÂ†¥Âêà„ÄÅÂá∫Âäõ„ÅØ`Array{Array{Hermitian,1},1}`Âûã„Åß„ÅÇ„Çä„ÄÅ„Åì„Çå„ÅØ[PosDefManifold](https://github.com/Marco-Congedo/PosDefManifold.jl)„Åß‰ΩøÁî®„Åï„Çå„Çã`‚ÑçVector‚ÇÇ`Âûã„Åß„Åô„ÄÇ

`tril`„Ååtrue„ÅÆÂ†¥Âêà„ÄÅÂá∫Âäõ„ÅØ`Array{Array{LowerTriangular,1},1}`Âûã„Åß„ÅÇ„Çä„ÄÅ„Åì„Çå„ÅØPosDefManifold„Åß‰ΩøÁî®„Åï„Çå„Çã`ùïÉVector‚ÇÇ`Âûã„Åß„Åô„ÄÇ

**ÂèÇÁÖß**: [crossspectra.jl](@ref)„ÄÅ[Spectra](@ref)„ÄÅ[Coherence](@ref)„ÄÇ

**‰æã**:

```julia
## „É°„ÇΩ„ÉÉ„Éâ(1)-(4)„ÅÆÂÖ±ÈÄö„Ç≥„Éº„Éâ

using FourierAnalysis, LinearAlgebra

function generateSomeData(sr::Int, t::Int; noise::Real=1.)
    # Èï∑„Åït„Çµ„É≥„Éó„É´„ÅÆ4„Å§„ÅÆÊ≠£Âº¶Ê≥¢„Å®sr„Çµ„É≥„Éó„É™„É≥„Ç∞„É¨„Éº„Éà
    # „Éî„Éº„ÇØÊåØÂπÖ: 0.7, 0.6, 0.5, 0.4
    # Âë®Ê≥¢Êï∞:        5,   7,  13,  27
    # ‰ΩçÁõ∏:            0, œÄ/4, œÄ/2,   œÄ
    v1=sinusoidal(0.7, 5,  sr, t, 0)
    v2=sinusoidal(0.6, 7,  sr, t, œÄ/4)
    v3=sinusoidal(0.5, 13, sr, t, œÄ/2)
    v4=sinusoidal(0.4, 27, sr, t, œÄ)
    return hcat(v1, v2, v3, v4) + (randn(t, 4)*noise)
end

sr, wl, t = 128, 512, 8192

# (1)

X=generateSomeData(sr, t) # Â§öÂ§âÈáè„Éá„Éº„ÇøË°åÂàó 8192x4

# „Éá„Éï„Ç©„É´„Éà„ÅÆharris4„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Çí‰ΩøÁî®„Åó„Åü„ÇØ„É≠„Çπ„Çπ„Éö„ÇØ„Éà„É´
S=crossSpectra(X, sr, wl)

# Âè§ÂÖ∏ÁöÑ„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÅÆ„Åø
C=FourierAnalysis.coherence(S)

# „Åô„Åπ„Å¶„ÅÆ5Á®ÆÈ°û„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ
Ctot, C2real, C3inst, C4imag, C5lag=FourierAnalysis.coherence(S, allkinds=true);
Ctot

# (2)

# 3„Å§„ÅÆÂ§öÂ§âÈáè„Éá„Éº„ÇøË°åÂàó 8192x4„ÇíÁîüÊàê
X=[generateSomeData(sr, t) for i=1:3]

# „Éá„Éï„Ç©„É´„Éà„ÅÆharris4„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Çí‰ΩøÁî®„Åó„Åü„ÇØ„É≠„Çπ„Çπ„Éö„ÇØ„Éà„É´
S=crossSpectra(X, sr, wl)

# Âè§ÂÖ∏ÁöÑ„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÅÆ„Åø
C=FourierAnalysis.coherence(S)

# „Åô„Åπ„Å¶„ÅÆ5Á®ÆÈ°û„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ
Ctot, C2real, C3inst, C4imag, C5lag=FourierAnalysis.coherence(S, allkinds=true);
Ctot

# (3)

X=generateSomeData(sr, t) # Â§öÂ§âÈáè„Éá„Éº„ÇøË°åÂàó 8192x4

# „Éá„Éï„Ç©„É´„Éà„ÅÆharris4„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Çí‰ΩøÁî®„Åó„Åü„Ç≥„Éí„Éº„É¨„É≥„Çπ
C=FourierAnalysis.coherence(X, sr, wl)

# Âë®Ê≥¢Êï∞5Hz„Åß„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÇíÁ¢∫Ë™ç
C.y[f2b(5, sr, wl)]

# „Éè„É≥„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Çí‰ΩøÁî®„Åó„Åü„Ç≥„Éí„Éº„É¨„É≥„Çπ
C=FourierAnalysis.coherence(X, sr, wl; tapering=hann)

# „Çπ„É¨„Éî„Ç¢„É≥„ÅÆ„Éû„É´„ÉÅ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Çí‰ΩøÁî®
C=FourierAnalysis.coherence(X, sr, wl; tapering=slepians(sr, wl))

# ÈùûÁ∑öÂΩ¢„Ç≥„Éí„Éº„É¨„É≥„ÇπÔºà‰ΩçÁõ∏„É≠„ÉÉ„Ç≠„É≥„Ç∞ÂÄ§Ôºâ„ÇíË®àÁÆó
C=FourierAnalysis.coherence(X, sr, wl; tapering=slepians(sr, wl), nonlinear=true)

# „Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÅÆ‰∏ã‰∏âËßíÈÉ®ÂàÜ„ÅÆ„Åø„ÇíË®àÁÆó
C=FourierAnalysis.coherence(X, sr, wl; tapering=slepians(sr, wl), tril=true)

# „Åô„Åπ„Å¶„ÅÆ5Á®ÆÈ°û„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÇíË®àÁÆó
Ctot, Creal, Cinst, Cimag, Clag=FourierAnalysis.coherence(X, sr, wl;
    tapering=slepians(sr, wl), tril=true, allkinds=true);
Ctot

# „Ç≥„Éí„Éº„É¨„É≥„Çπ„Çí‰∫ãÂæå„Å´„Çπ„É†„Éº„Ç∏„É≥„Ç∞
C2=smooth(blackmanSmoother, C)

# „Åô„Åß„Å´„Çπ„É†„Éº„Ç∏„É≥„Ç∞„Åï„Çå„Åü„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÇíË®àÁÆó
C=FourierAnalysis.coherence(X, sr, wl;
            tapering=slepians(sr, wl), tril=true, smoothing=blackmanSmoother)

# 8Hz-12HzÁØÑÂõ≤„ÅÆÂπ≥Âùá„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó
M=mean(C, (8, 12)) # „Åæ„Åü„ÅØ M=mean(C, (8.0, 12.0))

# 8Hz-12HzÁØÑÂõ≤„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÇíÊäΩÂá∫
E=extract(C, (8, 12))

# 2Hz„Éê„É≥„Éâ„Éë„ÇπÈ†òÂüü„ÅßÂπ≥ÂùáÂåñ„Åï„Çå„Åü„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó
B=bands(C, 2)

# (4)

# 3„Å§„ÅÆÂ§öÂ§âÈáè„Éá„Éº„ÇøË°åÂàó 8192x4„ÇíÁîüÊàê
X=[generateSomeData(sr, t) for i=1:3]

# ‰ª•‰∏ã„ÅÆ‰æã„ÅØ„É°„ÇΩ„ÉÉ„Éâ(3)„Å®ÂÖ®„ÅèÂêå„ÅòÊßãÊñá„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ
# „Åü„Å†„Åó„ÄÅ„Åì„Åì„Åß„ÅÆÂÖ•Âäõ„ÅØ„Éá„Éº„ÇøË°åÂàó„ÅÆ„Éô„ÇØ„Éà„É´„Åß„ÅÇ„Çä„ÄÅ
# Âçò‰∏Ä„ÅÆ„Éá„Éº„ÇøË°åÂàó„Åß„ÅØ„Å™„ÅÑ„Åü„ÇÅ„ÄÅ‰ª•‰∏ã„ÅÆ‰æã„ÅØ
# „É°„ÇΩ„ÉÉ„Éâ(3)„ÅÆ‰æã„Å´„Çà„Å£„Å¶‰ΩúÊàê„Åï„Çå„Åü„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Éô„ÇØ„Éà„É´„Çí‰ΩúÊàê„Åó„Åæ„Åô„ÄÇ
# ‰æã„Åà„Å∞Ôºö

# „Éá„Éï„Ç©„É´„Éà„ÅÆharris4„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Çí‰ΩøÁî®„Åó„Åü„Ç≥„Éí„Éº„É¨„É≥„Çπ
# „Åì„Çå„Å´„Çà„ÇäCoherenceVector„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åå‰ΩúÊàê„Åï„Çå„Åæ„Åô
C=FourierAnalysis.coherence(X, sr, wl)

# ÊúÄÂàù„ÅÆCoherence„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÁ¢∫Ë™ç
C[1]

# ÊúÄÂàù„ÅÆCoherence„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÂë®Ê≥¢Êï∞5Hz„Åß„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÇíÁ¢∫Ë™ç
C[1].y[f2b(5, sr, wl)]

# „Éè„É≥„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Çí‰ΩøÁî®„Åó„Åü„Ç≥„Éí„Éº„É¨„É≥„Çπ
C=FourierAnalysis.coherence(X, sr, wl; tapering=hann)

# „Çπ„É¨„Éî„Ç¢„É≥„ÅÆ„Éû„É´„ÉÅ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Çí‰ΩøÁî®
C=coherence(X, sr, wl; tapering=slepians(sr, wl))

# ÈùûÁ∑öÂΩ¢„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÇíË®àÁÆó
C=FourierAnalysis.coherence(X, sr, wl; tapering=slepians(sr, wl), nonlinear=true)

# „Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÅÆ‰∏ã‰∏âËßíÈÉ®ÂàÜ„ÅÆ„Åø„ÇíË®àÁÆó
C=FourierAnalysis.coherence(X, sr, wl; tapering=slepians(sr, wl), tril=true)

# „Åô„Åπ„Å¶„ÅÆ5Á®ÆÈ°û„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ„ÇíË®àÁÆó
Ctot, Creal, Cinst, Cimag, Clag=FourierAnalysis.coherence(X, sr, wl;
    tapering=slepians(sr, wl), tril=true, allkinds=true);
Ctot

# SÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰∫ãÂæå„Å´„Çπ„É†„Éº„Ç∏„É≥„Ç∞
C2=smooth(blackmanSmoother, C)

# „Åô„Åß„Å´„Çπ„É†„Éº„Ç∏„É≥„Ç∞„Åï„Çå„Åü„Åô„Åπ„Å¶„ÇíË®àÁÆó
C=FourierAnalysis.coherence(X, sr, wl; tapering=parzen, smoothing=blackmanSmoother)

# „Åô„Åπ„Å¶„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ8Hz-12HzÁØÑÂõ≤„ÅÆÂπ≥Âùá„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó
M=mean(C, (8, 12)) # „Åæ„Åü„ÅØ M=mean(C, (8.0, 12.0))

# ‰∏äË®ò„ÅÆ„Åô„Åπ„Å¶„ÅÆCoherence„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å´„Çè„Åü„Çã„Ç∞„É©„É≥„ÉâÂπ≥Âùá
meanM=mean(mean(C, (8, 12)))

# „Åô„Åπ„Å¶„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„Çπ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ8Hz-12HzÁØÑÂõ≤„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÇíÊäΩÂá∫
E=extract(C, (8, 12))

# „Åô„Åπ„Å¶„ÅÆcoh.„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ8Hz-12HzÁØÑÂõ≤„ÅÆ„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó„ÅÆ„Ç∞„É©„É≥„ÉâÂπ≥Âùá
meanE=mean(extract(C, (8, 12)))

# „Åô„Åπ„Å¶„ÅÆcoh.„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ2Hz„Éê„É≥„Éâ„Éë„ÇπÈ†òÂüü„ÅßÂπ≥ÂùáÂåñ„Åï„Çå„Åü„Ç≥„Éí„Éº„É¨„É≥„ÇπË°åÂàó
B=bands(C, 2)

# FFT„Éó„É©„É≥„Éä„Éº„Çí‰∫ãÂâç„Å´Ë®àÁÆó„Åó„ÄÅÂºïÊï∞„Å®„Åó„Å¶Ê∏°„Åô
# Ôºà„Åì„Çå„ÅØÈñ¢Êï∞„ÅåÁπ∞„ÇäËøî„ÅóÂëº„Å≥Âá∫„Åï„Çå„ÇãÂ†¥Âêà„Å´ËààÂë≥Ê∑±„ÅÑÔºâ„ÄÇ
plan=Planner(plan_exhaustive, 10.0, wl, eltype(X[1])) # 10ÁßíÂæÖ„Å§
C=FourierAnalysis.coherence(X, sr, wl; planner=plan)

# „Åì„Çå„Åå„Å©„Çå„Å†„ÅëÈÄü„Åè„Å™„Çã„ÅãÔºü
using BenchmarkTools
@benchmark(FourierAnalysis.coherence(X, sr, wl))
@benchmark(FourierAnalysis.coherence(X, sr, wl; planner=plan))
...
...
```
