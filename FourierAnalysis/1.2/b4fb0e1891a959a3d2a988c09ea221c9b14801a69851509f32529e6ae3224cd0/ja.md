```julia
(1)
function meanAmplitude( ùêÄ      :: TFAmplitudeVector,
                        frange :: fInterval,
                        trange :: tInterval;
                    mode   :: Function = extract,
                    func   :: Function = identity,
                    w      :: Vector   = [],
                    check  :: Bool     = true)

(2)
function meanAmplitude( ùêô :: TFAnalyticSignalVector,
                    < same arguments as method (1) >

(3)
function meanAmplitude( ùê±      :: Vector{Vector{T}},
                        sr     :: Int,
                        wl     :: Int,
                        frange :: fInterval,
                        trange :: tInterval,
                     bandwidth :: IntOrReal    = 2;
                 mode          :: Function     = extract,
                 func          :: Function     = identity,
                 w             :: Vector       = [],
                 check         :: Bool         = true,
                 filtkind      :: FilterDesign = Butterworth(2),
                 fmin          :: IntOrReal    = bandwidth,
                 fmax          :: IntOrReal    = sr√∑2,
                 fsmoothing    :: Smoother     = noSmoother,
                 tsmoothing    :: Smoother     = noSmoother,
                 planner       :: Planner      = getplanner,
                 ‚è©           :: Bool         = true) where T<:Real

```

**„Ç®„Ç§„É™„Ç¢„Çπ**: mamp

(1)

[TFAmplitudeVector](@ref) „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰∏é„Åà„Çâ„Çå„ÅüÂ†¥Âêà„ÄÅ„Åì„Çå„Çâ„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÂÖ®‰Ωì„Å´„Çè„Åü„Çã [(Âä†Èáç) Âπ≥ÂùáÊåØÂπÖ](@ref) Ê∏¨ÂÆöÂÄ§„ÇíÊé®ÂÆö„Åó„Åæ„Åô„ÄÇ`ùêÄ` ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÊôÇÈñì-Âë®Ê≥¢Êï∞Âπ≥Èù¢„ÅØ‰∏ÄËá¥„Åó„Å¶„ÅÑ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

**ÂºïÊï∞**:

`frange` „Å® `trange` „ÅØ„ÄÅÊé®ÂÆö„ÅåÊ±Ç„ÇÅ„Çâ„Çå„ÇãÊôÇÈñì-Âë®Ê≥¢Êï∞È†òÂüü„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ`frange` „ÅØ [fInterval](@ref) Âûã„Åß„ÄÅ„Éï„Ç£„É´„Çø„Éê„É≥„ÇØ„ÅÆ‰∏≠ÂøÉÂë®Ê≥¢Êï∞„ÇíÂà∂Èôê„Åó„Åæ„Åô„ÄÇ`trange` „ÅØ [tInterval](@ref) Âûã„Åß„ÄÅÊôÇÈñì„Çµ„É≥„Éó„É´„ÇíÂà∂Èôê„Åó„Åæ„Åô„ÄÇÂÖ®‰Ωì„ÅÆÊôÇÈñì-Âë®Ê≥¢Êï∞Âπ≥Èù¢„ÅßÊé®ÂÆö„ÇíÂæó„Çã„Å´„ÅØ„ÄÅ‰∏°Êñπ„ÅÆÂºïÊï∞„Å´„Ç≥„É≠„É≥ (:) Ë®òÂè∑„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

**„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÂºïÊï∞**

`mode=extract` „ÅåÊ∏°„Åï„Çå„ÅüÂ†¥ÂêàÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÄÅÈÅ∏Êäû„Åó„ÅüÊôÇÈñì-Âë®Ê≥¢Êï∞È†òÂüüÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆÁÇπ„Å´ÂØæ„Åó„Å¶Ê∏¨ÂÆö„ÅåË®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ`mode=mean` „ÅåÊ∏°„Åï„Çå„ÅüÂ†¥Âêà„ÄÅ„Åì„Çå„Çâ„ÅÆÁÇπ„ÅÆÂπ≥ÂùáÔºà„Ç∞„É©„É≥„Éâ„Ç¢„Éô„É¨„Éº„Ç∏Ôºâ„Å´ÂØæ„Åó„Å¶Ë®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ[`extract`](@ref) „Åä„Çà„Å≥ [`mean`](@ref) Èñ¢Êï∞„ÅØ *FourierAnalysis* „ÅÆ [Ê±éÁî®„É°„ÇΩ„ÉÉ„Éâ](@ref) „Åß„Åô„ÄÇ

**Ê≥®ÊÑè**: `mode=mean` „ÅÆÂ†¥Âêà„ÄÅÈñ¢Êï∞„ÅÆÂá∫Âäõ„ÅØÂ∏∏„Å´ÂÆüÊï∞„Åß„Åô„Åå„ÄÅ`mode=extract` „ÅÆÂ†¥Âêà„ÄÅÂá∫Âäõ„ÅØÂÆüÊï∞„ÄÅÂÆüÊï∞„ÅÆË°å„Åæ„Åü„ÅØÂàó„Éô„ÇØ„Éà„É´„ÄÅ„Åæ„Åü„ÅØÂÆüÊï∞„ÅÆË°åÂàó„Å´„Å™„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åì„Çå„ÅØÈÅ∏Êäû„Åó„ÅüÊôÇÈñì-Âë®Ê≥¢Êï∞È†òÂüü„ÅÆÂΩ¢Áä∂„Å´„Çà„Çä„Åæ„Åô„ÄÇ

`func` ÂºïÊï∞„ÅßÈñ¢Êï∞„ÇíÊ∏°„Åô„Åì„Å®„Åß„ÄÅ[Áã¨Ëá™„ÅÆÊôÇÈñì-Âë®Ê≥¢Êï∞Ê∏¨ÂÆöÂÄ§„ÇíÂ∞éÂá∫„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô](@ref)„ÄÇ

`w` „ÅØ„ÄÅÂêÑÂÖ•Âäõ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å´Èñ¢ÈÄ£‰ªò„Åë„Çâ„Çå„ÅüÈùûË≤†„ÅÆÂÆüÊï∞„ÅÆÈáç„Åø„ÅÆ„Éô„ÇØ„Éà„É´„Åß„ÅÇ„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Éá„Éï„Ç©„É´„Éà„Åß„ÅØ„ÄÅÊ∏¨ÂÆö„ÅÆÈùûÂä†Èáç„Éê„Éº„Ç∏„Éß„É≥„ÅåË®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ

`check` „Åå trueÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅÆÂ†¥Âêà„ÄÅÂàóË®òÂè∑„ÅåÊ∏°„Åï„Çå„ÅüÂ†¥Âêà„Å´„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åô„ÄÇ

  * `frange` ÂºïÊï∞„Å®„Åó„Å¶„ÄÅ„Åô„Åπ„Å¶„ÅÆÂÖ•Âäõ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅåÂêå„ÅòË°åÊï∞Ôºà‰∏≠ÂøÉÂë®Ê≥¢Êï∞Ôºâ„ÇíÊåÅ„Å£„Å¶„ÅÑ„Çã„Åì„Å®„ÄÇ
  * `trange` ÂºïÊï∞„Å®„Åó„Å¶„ÄÅ„Åô„Åπ„Å¶„ÅÆÂÖ•Âäõ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅåÂêå„ÅòÂàóÊï∞ÔºàÊôÇÈñì„Çµ„É≥„Éó„É´Ôºâ„ÇíÊåÅ„Å£„Å¶„ÅÑ„Çã„Åì„Å®„ÄÇ

„ÅÑ„Åö„Çå„Åã„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„ÅåÂ§±Êïó„Åó„ÅüÂ†¥Âêà„ÄÅ„Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂç∞Âà∑„Åó„ÄÅ`Nothing` „ÇíËøî„Åó„Åæ„Åô„ÄÇ‰ªñ„ÅÆÁØÑÂõ≤„ÉÅ„Çß„ÉÉ„ÇØ„ÅØË°å„Çè„Çå„Åæ„Åõ„Çì„ÄÇ

(2)

[TFAnalyticSignalVector](@ref) „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰∏é„Åà„Çâ„Çå„ÅüÂ†¥Âêà„ÄÅ`ùêô` ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÊåØÂπÖ„ÇíË®àÁÆó„Åó„ÄÅ„É°„ÇΩ„ÉÉ„Éâ (1) „Å´Âæì„Å£„Å¶„Åì„Çå„Çâ„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÂÖ®‰Ωì„Å´„Çè„Åü„Çã [(Âä†Èáç) Âπ≥ÂùáÊåØÂπÖ](@ref) Ê∏¨ÂÆöÂÄ§„ÇíÊé®ÂÆö„Åó„Åæ„Åô„ÄÇ„Åï„Çâ„Å´„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„Çí‰ΩøÁî®„Åô„ÇãÂ†¥Âêà„ÄÅ`ùêô` ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ [TFAnalyticSignal](@ref) „ÅØ `linear` „Åß„Å™„Åë„Çå„Å∞„Å™„Çâ„Åö„ÄÅ`check` „Åå trueÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÅÆÂ†¥Âêà„ÄÅ„Åì„Çå„ÅåÊ∫Ä„Åü„Åï„Çå„Å™„ÅÑ„Å®„Ç®„É©„Éº„ÇíÂç∞Âà∑„Åó„ÄÅ`Nothing` „ÇíËøî„Åó„Åæ„Åô„ÄÇ„É°„ÇΩ„ÉÉ„Éâ (1) „Å´„Çà„Å£„Å¶Ë°å„Çè„Çå„Çã `frange` „Åä„Çà„Å≥ `trange` „ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„ÇÇ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„Å´„Çà„Å£„Å¶Ë°å„Çè„Çå„Åæ„Åô„ÄÇ

(3)

`ùê±` ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Éá„Éº„Çø„Éô„ÇØ„Éà„É´„ÅÆÊåØÂπÖ„ÇíÊé®ÂÆö„Åó„ÄÅ[`TFamplitude`](@ref) „Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„ÇíÂëº„Å≥Âá∫„Åó„Å¶„Åã„Çâ„ÄÅ„É°„ÇΩ„ÉÉ„Éâ (1) „Å´Âæì„Å£„Å¶ÊßãÁØâ„Åï„Çå„ÅüÊåØÂπÖ„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÂÖ®‰Ωì„Å´„Çè„Åü„Çã [(Âä†Èáç) Âπ≥ÂùáÊåØÂπÖ](@ref) Ê∏¨ÂÆöÂÄ§„ÇíÊé®ÂÆö„Åó„Åæ„Åô„ÄÇ

`frange`„ÄÅ`trange`„ÄÅ`mode`„ÄÅ`func`„ÄÅ`w` „Åä„Çà„Å≥ `check` „ÅØ„ÄÅ„É°„ÇΩ„ÉÉ„Éâ (1) „Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ‰ªñ„ÅÆÂºïÊï∞„ÅØ [`TFamplitude`](@ref) „Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„Å´Ê∏°„Åï„Çå„ÄÅÊÑèÂë≥„Å´„Å§„ÅÑ„Å¶„ÅØË™≠ËÄÖ„Å´ÂèÇÁÖß„Åï„Çå„Åæ„Åô„ÄÇ

**ÂèÇÁÖß**: [`concentration`](@ref)„ÄÅ[`meanDirection`](@ref)„ÄÅ[timefrequencybi.jl](@ref)„ÄÇ

**‰æã**:

```julia
using FourierAnalysis

# 100 „ÅÆ„Éá„Éº„Çø„Éô„ÇØ„Éà„É´„ÇíÁîüÊàê
sr, t, bandwidth=128, 512, 2
h=taper(harris4, t)
ùê±=[sinusoidal(2, 10, sr, t, 0).*h.y+randn(t) for i=1:100]

ùêò=TFanalyticsignal(ùê±, sr, t, bandwidth; fmax=32)
ùêÄ=TFamplitude(ùêò)

# TFAnalyticSignalVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ„ÅÆ TF È†òÂüü„Å´„Åä„Åë„ÇãÂπ≥ÂùáÊåØÂπÖ
MAmp=meanAmplitude(ùêò, (4, 16), :)
heatmap(MAmp; c=:fire) # y Ëª∏„É©„Éô„É´„ÅØÊ≠£„Åó„Åè„ÅÇ„Çä„Åæ„Åõ„Çì

# TFAmplitudeVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ„ÅÆ TF È†òÂüü„Å´„Åä„Åë„ÇãÂπ≥ÂùáÊåØÂπÖ
MAmp=meanAmplitude(ùêÄ, (4, 16), :)

# „Éá„Éº„Çø„Åã„ÇâÁõ¥Êé•„ÅÆ TF È†òÂüü„Å´„Åä„Åë„ÇãÂπ≥ÂùáÊåØÂπÖ
MAmp=meanAmplitude(ùê±, sr, t, (4, 16), :, bandwidth)

# Ê≥®ÊÑè: ‰∏äË®ò„Åß„ÅØ„ÄÅËß£Êûê‰ø°Âè∑„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅØ„Åô„Åπ„Å¶
# Á∑öÂΩ¢„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Å™„Åú„Å™„Çâ„ÄÅmeanAmplitude „ÅØÊåØÂπÖ„Åã„ÇâË®àÁÆó„Åï„Çå„ÄÅ
# ÈùûÁ∑öÂΩ¢Ëß£Êûê‰ø°Âè∑„ÅÆÊåØÂπÖ„ÅØÂùá‰∏Ä„Å´ 1 „Å´Á≠â„Åó„ÅÑ„Åã„Çâ„Åß„Åô„ÄÇ

# „Åì„Çå„Çâ„ÅÆË®àÁÆó„ÅØ„ÄÅTF È†òÂüü„Åß„ÅÆÂπ≥Âùá„ÇíÂèñÂæó„Åô„Çã„Åì„Å®„ÅßÂæó„Çâ„Çå„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅ
MAmp=meanAmplitude(ùêò, (4, 16), :; mode=mean) # ÂÆüÊï∞„ÇíÂá∫Âäõ

# „Åæ„Åü„ÄÅÂπ≥ÊªëÂåñ„Åï„Çå„ÅüÊåØÂπÖ„Å´ÂØæ„Åó„Å¶„ÇÇÂèñÂæó„Åß„Åç„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅ
MAmp=meanAmplitude(ùê±, sr, t, (4, 16), :;
                   fsmoothing=blackmanSmoother,
                   tsmoothing=blackmanSmoother)
# „Åæ„Åü„ÅØ„ÄÅÂêåÁ≠â„Å´„ÄÅ„Ç®„Ç§„É™„Ç¢„Çπ `mamp` „Çí‰ΩøÁî®„Åó„Å¶„ÄÅ
MAmp=mamp(smooth(blackmanSmoother, blackmanSmoother, ùêÄ), (4, 16), :)

# ‰ªñ„ÅÆÂçòÂ§âÈáèÊ∏¨ÂÆö„Å´ÂØæ„Åó„Å¶„ÇÇÂêåÊßò„ÅÆÊßãÊñá„Åå‰ΩøÁî®„Åï„Çå„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅ
# TFAnalyticSignalVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ„ÅÆ TF È†òÂüü„Åß„ÅÆÈõÜ‰∏≠Â∫¶„ÅÆÂπ≥Âùá
ConM=concentration(ùêò, (4, 16), (128, 384); mode=mean)

# „Éá„Éº„Çø„Åã„ÇâÁõ¥Êé•„ÅÆ TF È†òÂüü„Åß„ÅÆÈõÜ‰∏≠Â∫¶Ôºà„Ç®„Ç§„É™„Ç¢„Çπ `con` „Çí‰ΩøÁî®Ôºâ
ConE=con(ùê±, sr, t, (4, 16), (128, 384), bandwidth; mode=extract)
heatmap(Con; c=:fire) # y Ëª∏„É©„Éô„É´„ÅØÊ≠£„Åó„Åè„ÅÇ„Çä„Åæ„Åõ„Çì

Ê≥®ÊÑè: ConM „ÅØ mean(ConE) „Å®ÂÖ®„ÅèÂêåÁ≠â„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„ÇìÔºÅ

# „Éá„Éº„Çø„Åã„ÇâÁõ¥Êé•„ÅÆ TF È†òÂüü„Åß„ÅÆÂπ≥ÂùáÊñπÂêë
MDir=meanDirection(ùê±, sr, t, (4, 16), :, bandwidth; mode=mean)

# TFAnalyticSignalVector „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„Çâ„ÅÆ TF È†òÂüü„Åß„ÅÆÂπ≥ÂùáÊñπÂêë
MDir=meanDirection(ùêò, (4, 16), :)

# ÈùûÁ∑öÂΩ¢„ÅÆÂØæÂøúÁâ©„Å´„Å§„ÅÑ„Å¶:
# „Éá„Éº„Çø„Åã„ÇâÁõ¥Êé•„ÅÆ TF È†òÂüü„Åß„ÅÆ‰ΩçÁõ∏ÈõÜ‰∏≠Â∫¶
Con=concentration(ùê±, sr, t, (8, 12), :; nonlinear=true)

# Âçò‰∏Ä„ÅÆ TF ÁÇπ„Åß„ÅÆ‰ΩçÁõ∏ÈõÜ‰∏≠Â∫¶
Con=concentration(ùê±, sr, t, 10, 256; nonlinear=true)

# „Éá„Éº„Çø„Åã„ÇâÁõ¥Êé•„ÅÆ TF È†òÂüü„Åß„ÅÆ‰ΩçÁõ∏Âπ≥ÂùáÊñπÂêë
# „Ç®„Ç§„É™„Ç¢„Çπ `mdir` „Çí‰ΩøÁî®
MDir=mdir(ùê±, sr, t, (8, 12), :; mode=mean, nonlinear=true)

# Á∑öÂΩ¢Ëß£Êûê‰ø°Âè∑„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„ÇâÈùûÁ∑öÂΩ¢Ê∏¨ÂÆö„ÇíË®àÁÆó„Åó„Çà„ÅÜ„Å®„Åô„Çã„Å®„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åô
# ÔºàREPL „ÇíÂèÇÁÖßÔºâ„ÄÅ‰æã„Åà„Å∞„ÄÅ
Con=con(ùêò, (8, 12), (1, 512); mode=mean, nonlinear=true)

# Ëß£Êûê‰ø°Âè∑„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åã„ÇâÈùûÁ∑öÂΩ¢Ê∏¨ÂÆö„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´„ÅØ„ÄÅ
# „Åæ„ÅöÈùûÁ∑öÂΩ¢Ëß£Êûê‰ø°Âè∑„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíË®àÁÆó„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„ÅôÔºö
ùêò=TFanalyticsignal(ùê±, sr, t, bandwidth; fmax=32, nonlinear=true)

# „Åù„ÅÆÂæå„ÄÅ‰æã„Åà„Å∞‰ΩçÁõ∏ÈõÜ‰∏≠Â∫¶„ÇíÂèñÂæó„Åß„Åç„Åæ„Åô
Con=con(ùêò, (8, 12), :; mode=mean, nonlinear=true)

# „Åù„Åó„Å¶‰ΩçÁõ∏Âπ≥ÂùáÊñπÂêë
MDir=meanDirection(ùêò, (8, 12), :; nonlinear=true)
```
