```julia
(1)
function spectra( X     :: Union{Vector{T}, Matrix{T}},
                  sr    :: Int,
                  wl    :: Int;
            tapering  :: Union{Taper, TaperKind} = harris4,
            planner   :: Planner                 = getplanner,
            slide     :: Int                     = 0,
            DC        :: Bool                    = false,
            func      :: Function                = identity, # equal to x->x
            smoothing :: Smoother                = noSmoother,
            ‚è©       :: Bool                    = true) where T<:Real

(2)
function spectra( ùêó   :: Vector{Matrix{T}},
            < same argument sr, ..., ‚è© of method (1) > where T<:Real
```

(1)

ÂÆüÊï∞„ÅÆÂçòÂ§âÈáè„Åæ„Åü„ÅØÂ§öÂ§âÈáè„Éá„Éº„Çø„Åã„Çâ[Spectra](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÊßãÁØâ„Åó„Åæ„Åô„ÄÇ„Çµ„É≥„Éó„É™„É≥„Ç∞„É¨„Éº„Éà`sr`„Å®„Ç®„Éù„ÉÉ„ÇØÈï∑`wl`„Åå‰∏é„Åà„Çâ„Çå„ÅüÂ†¥Âêà„ÄÅÊ¨°ÂÖÉ$t$x$n$„ÅÆ„Éô„ÇØ„Éà„É´ÔºàÂçòÂ§âÈáèÔºâ„Åæ„Åü„ÅØ„Éá„Éº„ÇøË°åÂàóÔºàÂ§öÂ§âÈáèÔºâ`X`„ÅÆ„Ç¶„Çß„É´„ÉÅ„Éë„ÉØ„Éº„Çπ„Éö„ÇØ„Éà„É´„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ„Åì„Åì„Åß„ÄÅ$t$„ÅØ„Çµ„É≥„Éó„É´Êï∞ÔºàË°åÊï∞Ôºâ„ÄÅ$n$„ÅØÊôÇÁ≥ªÂàó„ÅÆÊï∞ÔºàÂàóÊï∞Ôºâ„Åß„Åô„ÄÇ

„Çπ„Éö„ÇØ„Éà„É´„ÅØ„ÄÅ‰ΩúÊàê„Åï„Çå„Åü„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ`.y`„Éï„Ç£„Éº„É´„Éâ„Å´‰øùÊåÅ„Åï„Çå„Åæ„Åô„ÄÇ`X`„Åå„Éô„ÇØ„Éà„É´„ÅÆÂ†¥Âêà„ÄÅ`.y`„ÅØ„Éô„ÇØ„Éà„É´„Åß„ÅÇ„Çä„ÄÅ`X`„ÅåË°åÂàó„ÅÆÂ†¥Âêà„ÄÅ`.y`„ÅØ`X`„ÅÆÂàó„ÅÆ‰ø°Âè∑„ÅÆ„Çπ„Éö„ÇØ„Éà„É´„ÇíÂàó„Å´‰øùÊåÅ„Åô„ÇãË°åÂàó„Åß„Åô„ÄÇ„Çπ„Éö„ÇØ„Éà„É´„ÅÆ„Çµ„Ç§„Ç∫„ÅØ„ÄÅ`DC`„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÂºïÊï∞„Å´‰æùÂ≠ò„Åó„Åæ„ÅôÔºà‰∏ãË®òÂèÇÁÖßÔºâ„ÄÇ„Åì„Çå„ÅØ„ÄÅ[Spectra](@ref)ÊßãÈÄ†‰Ωì„ÅÆ„Éâ„Ç≠„É•„É°„É≥„Éà„Å´Ë®òËºâ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ

**„Ç™„Éó„Ç∑„Éß„É≥„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÂºïÊï∞**:

`tapering`: „Åì„Çå„ÅØ„ÄÅ[Taper](@ref)Âûã„ÅÆ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Åæ„Åü„ÅØ[TaperKind](@ref)Âûã„ÅÆ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„ÅÆÁ®ÆÈ°û„Åß„Åô„ÄÇ„Éá„Éï„Ç©„É´„Éà„Åß„ÅØ„ÄÅ*harris4*„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Åå‰ΩøÁî®„Åï„Çå„Åæ„Åô„ÄÇ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Åå‰∏çË¶Å„Å™Â†¥Âêà„ÅØ„ÄÅÂºïÊï∞`tapering=rectangular`„ÇíÊ∏°„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆÂêå„ÅòÊßãÊñá„ÅØ„ÄÅ„Åô„Åπ„Å¶„ÅÆÂçòÁ¥î„Å™„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„ÇíÊåáÂÆö„Åô„ÇãÊúÄ„ÇÇ‰æøÂà©„Å™ÊñπÊ≥ï„Åß„Åô„ÄÇ‰æãÔºö`tapering=hann`„ÄÅ`tapering=hamming`„Å™„Å©„ÄÇ*Èõ¢Êï£„Éó„É≠„É¨„Éº„ÉàÁêÉÈù¢Á≥ªÂàóÔºàdpssÔºâ*„ÅÆ„Éû„É´„ÉÅ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Å´„ÅØ„ÄÅ‰ª£„Çè„Çä„Å´[`slepians`](@ref)„Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ‰æãÔºö`tapering=slepians(sr, wl, 2)`„ÅÆ„Çà„ÅÜ„Å´ÂºïÊï∞„ÇíÊ∏°„Åó„Åæ„Åô„ÄÇ

`planner`: „Åì„Çå„ÅØ„ÄÅFFT„ÇíË®àÁÆó„Åô„Çã„Åü„ÇÅ„Å´‰ΩøÁî®„Åï„Çå„ÇãÂâçÊñπFFTW„Éó„É©„É≥„Çí‰øùÊåÅ„Åô„Çã[`Planner`](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Ç§„É≥„Çπ„Çø„É≥„Çπ„Åß„Åô„ÄÇ„Éá„Éï„Ç©„É´„Éà„Åß„ÅØ„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„Å´„Çà„Å£„Å¶„Éó„É©„É≥„Éä„Éº„ÅåË®àÁÆó„Åï„Çå„Åæ„Åô„Åå„ÄÅ‰∫ãÂâç„Å´Ë®àÁÆó„Åï„Çå„ÅüÂ†¥Âêà„ÅØ„Åì„Åì„Å´ÂºïÊï∞„Å®„Åó„Å¶Ê∏°„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ„Åì„ÅÆÈñ¢Êï∞„ÅåÁπ∞„ÇäËøî„ÅóÂëº„Å≥Âá∫„Åï„Çå„ÇãÂ†¥Âêà„Å´ËààÂë≥Ê∑±„ÅÑ„Åß„Åô„ÄÇ

`slide`: „Åì„Çå„ÅØ„ÄÅ„Ç¶„Ç£„É≥„Éâ„Ç¶„Åå„Çπ„É©„Ç§„Éâ„Åô„Çã„Çµ„É≥„Éó„É´Êï∞Ôºà„Ç¶„Çß„É´„ÉÅÊ≥ïÔºâ„Åß„Åô„ÄÇ„Éá„Éï„Ç©„É´„Éà„Åß„ÅØ„ÄÅ„Çµ„É≥„Éó„É´Êï∞„ÅØ50ÔºÖ„ÅÆ„Ç™„Éº„Éê„Éº„É©„ÉÉ„Éó„ÇíË®±ÂèØ„Åô„Çã„Çà„ÅÜ„Å´ÈÅ∏Êäû„Åï„Çå„Åæ„Åô„ÄÇ

`DC`: true„ÅÆÂ†¥Âêà„ÄÅDC„É¨„Éô„É´„ÅÆ„Çπ„Éö„ÇØ„Éà„É´„Åå`y`„ÅÆÊúÄÂàù„ÅÆË°å„Å´Ëøî„Åï„Çå„Åæ„ÅôÔºà[Spectra](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Éï„Ç£„Éº„É´„Éâ„ÇíÂèÇÁÖßÔºâ„ÄÇ„Åù„ÅÜ„Åß„Å™„ÅÑÂ†¥ÂêàÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÄÅ`y`„ÅÆË°å„ÅØÊúÄÂàù„ÅÆÊ≠£„ÅÆÈõ¢Êï£Âë®Ê≥¢Êï∞„Åã„ÇâÂßã„Åæ„Çä„Åæ„Åô„ÄÇ„Åô„Å™„Çè„Å°„ÄÅ$sr/wl$ Hz„Åß„Åô„ÄÇ

`func`: „Åì„Çå„ÅØ„ÄÅ„Éë„ÉØ„Éº„Çπ„Éö„ÇØ„Éà„É´„ÇíËøî„ÅôÂâç„Å´Ë¶ÅÁ¥†„Åî„Å®„Å´Â§âÊèõ„Åô„ÇãÈñ¢Êï∞„Åß„Åô„ÄÇÁÑ°ÂêçÈñ¢Êï∞„ÇíÂê´„Åø„Åæ„Åô„ÄÇ‰∏ÄËà¨ÁöÑ„Å™ÈÅ∏ÊäûËÇ¢„ÅØÊ¨°„ÅÆ„Å®„Åä„Çä„Åß„ÅôÔºö

  * `func=sqrt`„ÅØÊåØÂπÖ„Çπ„Éö„ÇØ„Éà„É´„ÇíËøî„Åó„Åæ„Åô„ÄÇ
  * `func=log`„ÅØÂØæÊï∞„Éë„ÉØ„Éº„Çπ„Éö„ÇØ„Éà„É´„ÇíËøî„Åó„Åæ„Åô„ÄÇ
  * `func=decibel`„ÅØ„Éá„Ç∑„Éô„É´„Åß„Éë„ÉØ„Éº„Çπ„Éö„ÇØ„Éà„É´„ÇíËøî„Åó„Åæ„ÅôÔºà[`decibel`](@ref)„ÇíÂèÇÁÖßÔºâ„ÄÇ

„Éá„Éï„Ç©„É´„Éà„Åß„ÅØ„ÄÅÈñ¢Êï∞„ÅØÈÅ©Áî®„Åï„Çå„Åö„ÄÅ„Éë„ÉØ„Éº„Çπ„Éö„ÇØ„Éà„É´„ÅåËøî„Åï„Çå„Åæ„Åô„ÄÇ„Çπ„É†„Éº„Ç∏„É≥„Ç∞„ÅåË¶ÅÊ±Ç„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥ÂêàÔºà‰∏ãË®òÂèÇÁÖßÔºâ„ÄÅÈñ¢Êï∞„ÅÆÂæå„Å´ÈÅ©Áî®„Åï„Çå„Åæ„Åô„ÄÇ

`smoothing`: „Åì„Çå„ÅØ„ÄÅÈö£Êé•„Åô„ÇãÂë®Ê≥¢Êï∞„Å´„Çè„Åü„Å£„Å¶„Çπ„Éö„ÇØ„Éà„É´„Å´ÂØæ„Åó„Å¶[„Çπ„É†„Éº„Ç∂„Éº](@ref)Âûã„ÅÆ„Çπ„É†„Éº„Ç∏„É≥„Ç∞Èñ¢Êï∞„ÇíÈÅ©Áî®„Åó„Åæ„Åô„ÄÇ„Éá„Éï„Ç©„É´„Éà„Åß„ÅØ„ÄÅ„Çπ„É†„Éº„Ç∏„É≥„Ç∞„ÅØÈÅ©Áî®„Åï„Çå„Åæ„Åõ„Çì„ÄÇ

`‚è©`: true„ÅÆÂ†¥ÂêàÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„ÅØ„ÄÅ`X`„ÅÆÁ≥ªÂàó„ÅåJulia„Å´ÊåáÁ§∫„Åï„Çå„Åü„Çπ„É¨„ÉÉ„ÉâÊï∞„ÅÆÂ∞ë„Å™„Åè„Å®„ÇÇ2ÂÄç„Åß„ÅÇ„ÇãÂ†¥Âêà„ÄÅÁ≥ªÂàó„Å´„Çè„Åü„Å£„Å¶„Éû„É´„ÉÅ„Çπ„É¨„ÉÉ„Éâ„É¢„Éº„Éâ„ÅßÂÆüË°å„Åï„Çå„Åæ„Åô„ÄÇ[Threads](@ref)„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

(2)

ÂÆüÊï∞„ÅÆÂçòÂ§âÈáèÔºà„Éô„ÇØ„Éà„É´Ôºâ„Åæ„Åü„ÅØÂ§öÂ§âÈáè„Éá„Éº„ÇøÔºàË°åÂàóÔºâ„ÅÆ„Éô„ÇØ„Éà„É´„Åã„Çâ[SpectraVector](@ref)„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÊßãÁØâ„Åó„Åæ„Åô„ÄÇ`ùêó`ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ$k$„Éá„Éº„Çø„Éô„ÇØ„Éà„É´„Åæ„Åü„ÅØ„Éá„Éº„ÇøË°åÂàó„Å´ÂØæ„Åó„Å¶„ÄÅ„É°„ÇΩ„ÉÉ„ÉâÔºà1Ôºâ„Å´Âæì„Å£„Å¶„Çπ„Éö„ÇØ„Éà„É´„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ

`ùêó`„Åå„Éá„Éº„ÇøË°åÂàó„Çí‰øùÊåÅ„Åó„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÄÅ`ùêó`ÂÜÖ„ÅÆ$k$Ë°åÂàó„ÅØÂêå„ÅòÂàóÊï∞Ôºà„Åô„Å™„Çè„Å°„ÄÅÂêå„ÅòÊôÇÁ≥ªÂàó„ÅÆÊï∞Ôºâ„ÇíÊåÅ„Åü„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì„Åå„ÄÅ‰ªªÊÑè„ÅÆÊï∞„ÅÆÔºàÂ∞ë„Å™„Åè„Å®„ÇÇ`wl`ÔºâË°åÔºà„Çµ„É≥„Éó„É´Ôºâ„ÇíÊåÅ„Å§„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ‰ªñ„ÅÆ„Åô„Åπ„Å¶„ÅÆÂºïÊï∞„ÅØ„ÄÅ„É°„ÇΩ„ÉÉ„ÉâÔºà1Ôºâ„Å®Âêå„ÅòÊÑèÂë≥„ÇíÊåÅ„Å°„ÄÅ‰ª•‰∏ã„ÅÆÈÅï„ÅÑ„Åå„ÅÇ„Çä„Åæ„ÅôÔºö

  * `‚è©`: true„ÅÆÂ†¥ÂêàÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„ÅØ„ÄÅ$k$„ÅåJulia„Å´ÊåáÁ§∫„Åï„Çå„Åü„Çπ„É¨„ÉÉ„ÉâÊï∞„ÅÆÂ∞ë„Å™„Åè„Å®„ÇÇ2ÂÄç„Åß„ÅÇ„ÇãÂ†¥Âêà„ÄÅ$k$„Éá„Éº„ÇøË°åÂàó„Å´„Çè„Åü„Å£„Å¶„Éû„É´„ÉÅ„Çπ„É¨„ÉÉ„Éâ„É¢„Éº„Éâ„ÅßÂÆüË°å„Åï„Çå„Åæ„Åô„ÄÇ„Åù„ÅÜ„Åß„Å™„ÅÑÂ†¥Âêà„ÄÅ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„ÅØ„ÄÅ„É°„ÇΩ„ÉÉ„ÉâÔºà1Ôºâ„Å´Âæì„Å£„Å¶ÂêÑ„Çπ„Éö„ÇØ„Éà„É´Êé®ÂÆö„ÇíÁ≥ªÂàó„Å´„Çè„Åü„Å£„Å¶„Éû„É´„ÉÅ„Çπ„É¨„ÉÉ„Éâ„É¢„Éº„Éâ„ÅßÂÆüË°å„Åó„Çà„ÅÜ„Å®„Åó„Åæ„Åô„ÄÇ[Threads](@ref)„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
  * `planner`„ÅåÊòéÁ§∫ÁöÑ„Å´ÂºïÊï∞„Å®„Åó„Å¶Ê∏°„Åï„Çå„Å™„ÅÑÂ†¥Âêà„ÄÅFFTW„Éó„É©„É≥„ÅØ‰∏ÄÂ∫¶Ë®àÁÆó„Åï„Çå„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Çπ„Éö„ÇØ„Éà„É´Êé®ÂÆö„Å´ÈÅ©Áî®„Åï„Çå„Åæ„Åô„ÄÇ

**ÂèÇÁÖß**: [Spectra](@ref)„ÄÅ[„Çπ„Éö„ÇØ„Éà„É´„Çí„Éó„É≠„ÉÉ„Éà](@ref)„ÄÇ

**Èñ¢ÈÄ£**: [`crossSpectra`](@ref)„ÄÅ[`coherence`](@ref)„ÄÅ[goertzel.jl](@ref)„ÄÇ

**‰æã**:

```julia
using FourierAnalysis

###################################################################

# (1)

# Ê≠£„Åó„ÅÑÊåØÂπÖ„Çπ„Éö„ÇØ„Éà„É´„Åå„Åô„Åπ„Å¶„ÅÆÈõ¢Êï£
# „Éï„Éº„É™„Ç®Âë®Ê≥¢Êï∞„ÅßËøî„Åï„Çå„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç„Åó„Åæ„ÅôÔºàÁü©ÂΩ¢„ÉÜ„Éº„Éë„Éº„Çí‰ΩøÁî®Ôºâ„ÄÇ
# „Çµ„Ç§„É≥Ê≥¢„ÅØ„Åô„Åπ„Å¶„ÅÆÂë®Ê≥¢Êï∞„ÅßÊåØÂπÖ10„Åß‰ΩúÊàê„Åï„Çå„ÄÅ
# ÊúÄÂàù„ÅÆÂë®Ê≥¢Êï∞„ÅßÊåØÂπÖ10„ÄÅÊ¨°„Å´Âë®Ê≥¢Êï∞„Å´Ê≤ø„Å£„Å¶10Âçò‰Ωç„Åö„Å§Â¢óÂä†„Åó„Åæ„Åô„ÄÇ
# NB t„ÅåÂÅ∂Êï∞„ÅÆÂ†¥Âêà„ÄÅÊúÄÂæå„ÅÆÂë®Ê≥¢Êï∞„ÅÆÊ≠£„Åó„ÅÑÊåØÂπÖ„ÅØ
# „Çµ„Ç§„É≥Ê≥¢„ÅåÁâπÂÆö„ÅÆ‰ΩçÁõ∏„ÇíÊåÅ„Å§Â†¥Âêà„Å´„ÅÆ„ÅøÂæó„Çâ„Çå„Åæ„Åô„ÄÇ

sr, t, wl= 16, 32, 16
V=Matrix{Float64}(undef, t, wl)
for i=1:wl V[:, i]=sinusoidal(10*i, b2f(i, sr, t), sr, t, œÄ/6) end

# FFTW.jl„ÅÆ„Åø„Çí‰ΩøÁî®
using FFTW
P=plan_rfft(V, 1)*(2/t);
Œ£=abs.(P*V)
using Plots
bar(Œ£[brange(t, DC=true), :], labels="")

# FourierAnalysis.jl„Çí‰ΩøÁî®
Œ£2=spectra(V, sr, t; tapering=rectangular, func=‚àö, DC=true)
using Plots
bar(Œ£2.y[brange(t, DC=true), :], labels="")

#############################################################################

### „Ç¶„Çß„É´„ÉÅÊ≥ï„Å´„Çà„Å£„Å¶Âæó„Çâ„Çå„ÅüÈï∑„ÅÑ‰ø°Âè∑„ÅÆÊåØÂπÖ„Çπ„Éö„ÇØ„Éà„É´„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô
# ‰∏Ä„Å§„ÅÆ„Çµ„Ç§„É≥Ê≥¢„ÅØÊ≠£Á¢∫„Å™Èõ¢Êï£„Éï„Éº„É™„Ç®Âë®Ê≥¢Êï∞„Å´„ÅÇ„Çä„ÄÅ„ÇÇ„ÅÜ‰∏Ä„Å§„ÅØ„Åù„ÅÜ„Åß„Å™„ÅÑ
# Áü©ÂΩ¢„Ç¶„Ç£„É≥„Éâ„Ç¶
sr, t, f, a = 128, 128, 10, 0.5
v=sinusoidal(a, f, sr, t*16)+sinusoidal(a, f*3.5+0.5, sr, t*16)+randn(t*16);
Œ£=spectra(v, sr, t; tapering=rectangular, func=‚àö)
bar(Œ£.y, labels="rectangular")

# harris4„Ç¶„Ç£„É≥„Éâ„Ç¶Ôºà„Éá„Éï„Ç©„É´„ÉàÔºâ
Œ£2=spectra(v, sr, t; func=‚àö)
bar!(Œ£2.y, labels="harris4")

# „Çπ„É†„Éº„Ç∫„Å™„Çπ„Éö„ÇØ„Éà„É´
Œ£3=smooth(blackmanSmoother, Œ£2)
bar!(Œ£3.y, labels="smoothed")

#############################################################################

function generateSomeData(sr::Int, t::Int; noise::Real=1.)
    # Èï∑„Åït„Çµ„É≥„Éó„É´„ÅÆ4„Å§„ÅÆ„Çµ„Ç§„É≥Ê≥¢„Å®sr„Çµ„É≥„Éó„É™„É≥„Ç∞„É¨„Éº„Éà
    # „Éî„Éº„ÇØÊåØÂπÖ: 0.7, 0.6, 0.5, 0.4
    # Âë®Ê≥¢Êï∞:        5,   7,  13,  27
    # ‰ΩçÁõ∏:            0, œÄ/4, œÄ/2,   œÄ
    v1=sinusoidal(0.7, 5,  sr, t, 0)
    v2=sinusoidal(0.6, 7,  sr, t, œÄ/4)
    v3=sinusoidal(0.5, 13, sr, t, œÄ/2)
    v4=sinusoidal(0.4, 27, sr, t, œÄ)
    return hcat(v1, v2, v3, v4) + (randn(t, 4)*noise)
end

sr, wl, t = 128, 512, 8192
X=generateSomeData(sr, t)
# Â§öÂ§âÈáè„Éá„Éº„ÇøË°åÂàó8192x4

# „Çπ„Éö„ÇØ„Éà„É´„ÇíË®àÁÆó
S=spectra(X, sr, wl)

# ÊúÄÂàù„ÅÆÁ≥ªÂàó„ÅÆ„Çπ„Éö„ÇØ„Éà„É´„ÇíÁ¢∫Ë™ç
S.y[:, 1]

# „Åç„Çå„ÅÑ„Å™„Éó„É≠„ÉÉ„Éà„ÇíÂæó„Çã„Åü„ÇÅ„ÅÆ„Éó„É≠„ÉÉ„ÉàÂ±ûÊÄß„ÇíÈõÜ„ÇÅ„Çã
using Plots.Measures
spectraArgs=(fmax = 32,
             left_margin = 2mm,
             bottom_margin = 2mm,
             xtickfont = font(11, "Times"),
             ytickfont = font(11, "Times"))
plot(S; spectraArgs...)
plot(S; xspace=2, spectraArgs...)

# „Ç´„Çπ„Çø„É†„ÅÆÂçòÁ¥î„Å™„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶„Çí‰ΩøÁî®
S=spectra(X, sr, wl; tapering=riesz)

# „Çπ„É¨„Éî„Ç¢„É≥„ÅÆ„Éû„É´„ÉÅ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Çí‰ΩøÁî®
S=spectra(X, sr, wl; tapering=slepians(sr, wl, 1.5))

# „Çπ„É†„Éº„Ç∏„É≥„Ç∞„Çí‰ΩøÁî®„Åó„Å¶ÊßãÁØâ
S=spectra(X, sr, wl; tapering=slepians(sr, wl, 1.5), smoothing=hannSmoother)

# ‰ª£„Çè„Çä„Å´ÊåØÂπÖ„Çπ„Éö„ÇØ„Éà„É´„ÇíË®àÁÆó
S=spectra(X, sr, wl; tapering=slepians(sr, wl, 1.5), func=‚àö)

# ÊåØÂπÖ„Çπ„Éö„ÇØ„Éà„É´„Çí„Éó„É≠„ÉÉ„Éà
plot(S; ytitle="Amplitude", spectraArgs...)

# „Çπ„Éö„ÇØ„Éà„É´„Çí‰∫ãÂæåÁöÑ„Å´„Çπ„É†„Éº„Ç∫„Å´„Åô„Çã
S=smooth(blackmanSmoother, S)

# ÁØÑÂõ≤(8Hz„Åã„Çâ12Hz)„ÅÆ„Çπ„Éö„ÇØ„Éà„É´„ÇíÊäΩÂá∫
e=extract(S, (8, 12))

# „Ç∑„É™„Éº„Ç∫1„Å®2„ÅÆÁØÑÂõ≤(8Hz„Åã„Çâ12Hz)„ÅÆ„Çπ„Éö„ÇØ„Éà„É´„ÇíÊäΩÂá∫
e=extract(S, (8, 12))[:, 1:2]

# 10Hz„Åß„ÅÆ„Åø„Çπ„Éö„ÇØ„Éà„É´„ÇíÊäΩÂá∫ÔºàÂêÑÁ≥ªÂàó1„Éì„É≥Ôºâ
e=extract(S, 10)

# 8Hz-12HzÁØÑÂõ≤„ÅÆÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´
bar(mean(S, (8.0, 12.0)))

# 8Hz-12HzÁØÑÂõ≤„ÅÆÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´„ÅÆÁ≥ªÂàóÈñìÂπ≥Âùá
mean(mean(S, (8.0, 12.0)))

# ÂêÑÁ≥ªÂàó„ÅÆ„Åô„Åπ„Å¶„ÅÆÂë®Ê≥¢Êï∞„Å´„Çè„Åü„ÇãÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´
bar(mean(S, :))

# „Åô„Åπ„Å¶„ÅÆÁ≥ªÂàó„ÅÆÂùáÁ≠â„Å´ÈñìÈöî„ÇíÁ©∫„Åë„Åü2Hz„Éê„É≥„Éâ„Éë„ÇπÈ†òÂüü„ÅÆÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´
plot(bands(S, 2))

# „Ç∑„É™„Éº„Ç∫1„Å®2„ÅÆÂùáÁ≠â„Å´ÈñìÈöî„ÇíÁ©∫„Åë„Åü2Hz„Éê„É≥„Éâ„Éë„ÇπÈ†òÂüü„ÅÆÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´
plot(bands(S, 2)[:, 1:2])

# (2)

# 8192x4„ÅÆÂ§öÂ§âÈáè„Éá„Éº„ÇøË°åÂàó„Çí3„Å§ÁîüÊàê
X=[generateSomeData(sr, t) for i=1:3]

# „Åì„Çå„Åß„Çπ„Éö„ÇØ„Éà„É©Èñ¢Êï∞„ÅÆÂëº„Å≥Âá∫„Åó„ÅØ3„Å§„ÅÆSpectra„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÁîüÊàê„Åó„Åæ„Åô
S=spectra(X, sr, wl)
plot(S[1]; spectraArgs...)
plot(S[2]; spectraArgs...)
plot(S[3]; spectraArgs...)

# Â§ö„Åè„ÅÆ„Éá„Éº„ÇøË°åÂàó„ÅÆ„Çπ„Éö„ÇØ„Éà„É´„ÇíË®àÁÆó„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ„ÄÅ
# È´òÈÄü„Å™FFTW„Éó„É©„É≥„Çí‰ΩøÁî®„Åó„Å¶Ë°å„ÅÜ„Åì„Å®„Çí„ÅäÂãß„ÇÅ„Åó„Åæ„ÅôÔºà„Éó„É©„É≥„ÅÆË®àÁÆó„Å´ÊúÄÂ§ß10ÁßíÂæÖÊ©üÔºâ
plan=Planner(plan_exhaustive, 10.0, wl)
S=spectra(X, sr, wl; planner=plan)

# „Å©„Çå„Å†„ÅëÈÄü„Åè„Å™„Çã„ÅÆ„ÅãÔºü
using BenchmarkTools
@benchmark(spectra(X, sr, wl))
@benchmark(spectra(X, sr, wl; planner=plan))


# „Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Åô„Åπ„Å¶„ÅÆÁ≥ªÂàó„ÅÆÁØÑÂõ≤(8Hz-12Hz)„ÅÆÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´
M=mean(S, (8, 12))

# 3„Å§„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Åô„Åπ„Å¶„ÅÆÁ≥ªÂàó„Å´ÂØæ„Åô„ÇãÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´„Çí„Éó„É≠„ÉÉ„Éà
# Julia„ÅÆÊ®ôÊ∫ñÂπ≥ÂùáÈñ¢Êï∞„Çí‰ΩøÁî®
plot(mean(S[1].y[:, i] for i=1:size(S[1].y, 2)))
plot!(mean(S[2].y[:, i] for i=1:size(S[2].y, 2)))
plot!(mean(S[3].y[:, i] for i=1:size(S[3].y, 2)))

# 4Hz-32.5Hz„ÅÆÁØÑÂõ≤„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÈñì„ÅÆÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´
plot(mean(mean(S, (4, 32.5))))

# „Åô„Åπ„Å¶„ÅÆÁ≥ªÂàó„Å®„Åô„Åπ„Å¶„ÅÆË¢´È®ìËÄÖ„ÅÆÁØÑÂõ≤(8Hz-12Hz)„ÅÆ„Çπ„Éö„ÇØ„Éà„É´„ÇíÊäΩÂá∫
extract(S, (8, 12))

# ‰∏çÊ≠£„Å™ÁØÑÂõ≤„ÇíÂÖ•Âäõ„Åô„Çã„Å®„ÄÅ‰Ωï„ÇÇË°å„Çè„Çå„Åö„ÄÅÂºïÊï∞„Å´‰Ωï„ÅåÂïèÈ°å„Åã„ÇíË™¨Êòé„Åô„Çã
# „Ç®„É©„Éº„ÅåREPL„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô
extract(S, (0, 12))
mean(S, (1, 128))

# „Åô„Åπ„Å¶„ÅÆÁ≥ªÂàó„Å®„Åô„Åπ„Å¶„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ4Hz„Éê„É≥„Éâ„Éë„ÇπÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´„ÇíÊäΩÂá∫
bands(S, 4)

# „Çπ„Éö„ÇØ„Éà„É´Ë®àÁÆó„Å´„Çπ„É†„Éº„Ç∏„É≥„Ç∞„ÇíÈÅ©Áî®
S=spectra(X, sr, t; smoothing=blackmanSmoother)
plot(S[1]; spectraArgs...)
plot(S[2]; spectraArgs...)
plot(S[3]; spectraArgs...)

# S[1]„ÅÆ„Åô„Åπ„Å¶„ÅÆÁ≥ªÂàó„Å´ÂØæ„Åó„Å¶1Hz„Éê„É≥„Éâ„Éë„ÇπÈ†òÂüü„Åß„Çπ„Éö„ÇØ„Éà„É´„Çí„Éó„É≠„ÉÉ„Éà
plot(bands(S[1], 1))

# „Çπ„É¨„Éî„Ç¢„É≥„ÅÆ„Éû„É´„ÉÅ„ÉÜ„Éº„Éë„É™„É≥„Ç∞„Çí‰ΩøÁî®
S=spectra(X, sr, wl; tapering=slepians(sr, wl, 1.))
plot(S[1]; spectraArgs...)

# „Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÈñì„ÅÆÂπ≥Âùá„Çπ„Éö„ÇØ„Éà„É´„Çí„Éó„É≠„ÉÉ„Éà
plot(mean(s.y for s ‚àà S))


```
