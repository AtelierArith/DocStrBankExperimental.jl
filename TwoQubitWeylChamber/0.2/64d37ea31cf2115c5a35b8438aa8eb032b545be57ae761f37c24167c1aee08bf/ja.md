完璧エンタングラーの距離測定。

```julia
D = D_PE(U; unitarity_weight=0.0, absolute_square=false)
```

与えられた2量子ビットゲート $Û$ に対して、これは [`local_invariants`](@ref) $g_1$, $g_2$, $g_3$ を用いて次のように定義されます。

$$
D = g_3 \sqrt{g_1^2 + g_2^2} - g_1
$$

これは量子ゲートがワイル空間の完璧エンタングラーの多面体からの幾何学的距離を表します。

この方程式は、$Û$ がユニタリであるという仮定の下でのみ意味があります。2量子ビットレベルがより大きな物理ヒルベルト空間に埋め込まれた論理部分空間である場合、論理部分空間からの人口の喪失は非ユニタリな $Û$ を引き起こす可能性があります。この場合、[`unitarity`](@ref) 測定を機能に追加することができ、$D$ 項とユニタリティ項の相対的な比率を指定する `unitary_weight` ∈ [0, 1) を与えます。

`absolute_square=true` を指定することで、機能は $D → |D|²$ に修正され、完璧エンタングラー多面体の*境界*に特化して最適化されます。これは、$D$ が多面体内で負の値を取る可能性があること、ならびにワイル空間の `W1` 領域（SWAP に隣接する領域）を考慮に入れています。これは、人口損失のあるシステム（`unitarity_weight` > 0）において特に有用であり、最適化が完璧エンタングラーの深い部分に進む一方で、人口損失を*増加させる*状況を避けることができます。

!!! 警告     機能は量子ゲートがワイル空間のどの領域にあるかをチェックしません。最適化のために使用する際に、推測がワイル空間の `W1` 領域（SWAP に近い）にポイントを導く場合、機能の符号を反転させる必要があります。さもなければ、SWAP の最適化が行われます。あるいは、`absolute_square=true` を使用してください。

!!! ヒント     機能は、各論理基底状態に対して1つの軌道を使用する最適化のための正しい形式に変換することができ、`QuantumControl.Functionals.gate_functional` を使用します。
