```
ApproximateEntropy <: ComplexityEstimator
ApproximateEntropy([x]; r = 0.2std(x), kwargs...)
```

近似エントロピー [Pincus1991](@cite) 複雑性測定の推定器であり、[`complexity`](@ref) と共に使用されます。

入力時系列 `x` が提供されていない場合、キーワード引数 `r` は必須です。

## キーワード引数

  * `r::Real`: 点の周りの最近傍を照会する際に使用される半径。その値は、データの標準偏差のいくつかの割合として、入力データから決定されるべきです。
  * `m::Int = 2`: 埋め込み次元。
  * `τ::Int = 1`: 埋め込みラグ。
  * `base::Real = MathConstants.e`: 対数に使用する基数。Pincus (1991) は自然対数を使用します。

## 説明

近似エントロピー (ApEn) は次のように定義されます。

$$
ApEn(m ,r) = \lim_{N \to \infty} \left[ \phi(x, m, r) - \phi(x, m + 1, r) \right].
$$

近似エントロピーは、まず埋め込み次元 `m` と埋め込みラグ `τ` を使用して `x` を埋め込み、その後、与えられた `base`（Pincus, 1991 では自然対数が使用されます）で対数を使用して、許容半径 `r` 内の類似ベクトルを検索することによって、時系列 `x` に対して推定されます。

具体的には、有限長の時系列 `x` に対する $ApEn(m ,r)$ の推定器は次のようになります。

$$
ApEn(m, r, N) = \phi(x, m, r, N) -  \phi(x, m + 1, r, N),
$$

ここで `N = length(x)` であり、

$$
\phi(x, k, r, N) =
\dfrac{1}{N-(k-1)\tau} \sum_{i=1}^{N - (k-1)\tau}
\log{\left(
    \sum_{j = 1}^{N-(k-1)\tau} \dfrac{\theta(d({\bf x}_i^m, {\bf x}_j^m) \leq r)}{N-(k-1)\tau}
    \right)}.
$$

ここで、$\theta(\cdot)$ は引数が真であれば 1 を返し、そうでなければ 0 を返し、$d({\bf x}_i, {\bf x}_j)$ はベクトル ${\bf x}_i$ と ${\bf x}_j$ のチェビシェフ距離を返し、`k` 次元の埋め込みベクトルは入力時系列 $x(t)$ から次のように構築されます。

$$
{\bf x}_i^k = (x(i), x(i+τ), x(i+2τ), \ldots, x(i+(k-1)τ)).
$$

!!! note "柔軟な埋め込みラグ"
    元の論文では `τ = 1` に固定されています。私たちの実装では、`τ != 1` の埋め込みを考慮するために正規化定数が修正されています。

