```
TransferOperator <: OutcomeSpace
TransferOperator(b::AbstractBinning; warn_precise = true, rng = Random.default_rng())
```

与えられたビニングスキーム `b` によって決定される長方形のボックスにデータをビニングすることに基づいた [`OutcomeSpace`](@ref) です。

[`probabilities`](@ref) と一緒に使用されると、転送（ペロン-フロベニウス）演算子はビンに対して近似され、その後、ビンの確率はその転送演算子に関連する不変測度として推定されます。入力データが順次（時間順）であることを前提としています。

この実装は、[Diego2019](@citet) のグリッド推定器アプローチに従っています。

## 精度

[`RectangularBinning`](@ref) または [`FixedRectangularBinning`](@ref) を使用する際のデフォルトの動作は、スピードアップのためにビンの境界での精度の損失を受け入れることですが、これにより `TransferOperator` において一部のポイントがシンボル `-1`（「ビニングの外」）としてエンコードされる問題が発生する可能性があります。`warn_precise` キーワードは、ユーザーが精度の低いビニングを使用しているときに警告されるかどうかを制御します。

## アウトカムスペース

`TransferOperator` のアウトカムスペースは、`b` から構築されたユニークなビンの集合です。ビンはその左（最小値）コーナーによって識別され、データ単位で与えられ、`SVector` として返されます。

## ビンの順序

[`probabilities_and_outcomes`](@ref) によって返されるビンは、最初の出現に従って順序付けられます（すなわち、入力（多変量）時系列がビンを訪れる最初の時間）。したがって、もし

```julia
b = RectangularBinning(4)
est = TransferOperator(b)
probs, outcomes = probabilities_and_outcomes(x, est) # x は何らかの時系列
```

であれば、`probs[i]` はビン `outcomes[i]` の不変測度（確率）であり、これは時系列が非ゼロ測度で訪れた `i` 番目のビンです。

## 説明

転送演算子 $P^{N}$ は、軌道/ポイントによって訪問される分割要素によって定義された状態間の遷移確率の `N`-by-`N` 行列として計算されます。ここで `N` は、分割で訪問されるボックスの数です。

もし $\{x_t^{(D)} \}_{n=1}^L$ が転送演算子が近似される $L$ 個の異なる $D$ 次元ポイントであり、$\{ C_{k=1}^N \}$ がポイントによって訪問される $N$ 個の異なる分割要素（`ϵ` によって決定される）であり、$\phi(x_t) = x_{t+1}$ であれば、

$$
P_{ij} = \dfrac
{\#\{ x_n | \phi(x_n) \in C_j \cap x_n \in C_i \}}
{\#\{ x_m | x_m \in C_i \}},
$$

ここで $\#$ は基数を示します。要素 $P_{ij}$ は、最初にボックス $C_i$ にあったポイントが、ボックス $C_i$ のポイントが時間を一歩前に投影されたときにボックス $C_j$ にどれだけのポイントが移動するかを示します。したがって、$k \in \{1, 2, \ldots, N \}$ の行 $P_{ik}^N$ は、ボックス $C_i$ によって定義された状態から他の $N$ の状態のいずれかにジャンプする確率を示します。したがって、すべての $i$ に対して $\sum_{k=1}^{N} P_{ik} = 1$ となります。したがって、$P^N$ は行/右確率行列です。

### 転送演算子からの不変測度の推定

左不変分布 $\mathbf{\rho}^N$ は行ベクトルであり、$\mathbf{\rho}^N P^{N} = \mathbf{\rho}^N$ です。したがって、$\mathbf{\rho}^N$ は固有値 1 に関連する転送行列 $P^{N}$ の行固有ベクトルです。分布 $\mathbf{\rho}^N$ は、`ビニング` の影響を受けたシステムの不変密度を近似し、分割要素に対する確率分布として取ることができます。

実際には、不変測度 $\mathbf{\rho}^N$ は [`invariantmeasure`](@ref) を使用して計算され、転送行列も近似されます。不変分布は長さ `N` のランダム分布として初期化され、その後 $P^{N}$ に適用されます。このステップでの再現性のために、`rng` を設定します。得られた長さ `N` の分布は再び $P^{N}$ に適用されます。このプロセスは、連続した反復間の分布の違いがある閾値を下回るまで繰り返されます。

参照: [`RectangularBinning`](@ref), [`FixedRectangularBinning`](@ref), [`invariantmeasure`](@ref). ```
