```
WLS(shufflemethod::Surrogate = IAAFT();
    f::Union{Nothing, Function} = Statistics.cor,
    rescale::Bool = true,
    wt::Wavelets.WT.OrthoWaveletClass = Wavelets.WT.Daubechies{16}())
```

A wavelet surrogate generated by the following procedure:

1. Compute the wavelet transform of the signal. This results in a set of   detail coefficients over a set of dyadic scales. As in Keylock (2006),   we here use the maximal overlap discrete wavelet transform, or MODWT,  so that the number of coefficients at each scale are the same.
2. Shuffle the detail coefficients at each dyadic scale using the   provided `shufflemethod`. See "Shuffling methods" below for alternatives.
3. Apply the inverse wavelet transform to the shuffled detail coefficients   to obtain a surrogate time series.

## Shuffling methods

You may choose to use any surrogate from this package to perform the  randomization of the detail coefficients at each dyadic scale.

The following methods have been discussed in the literature (more may exist): 

  * Random permutations of wavelet coefficients within each scale (Breakspear et al., 2003). To get this behaviour, use `WLS(x, RandomShuffle(), rescale = false, f = nothing)`.
  * Cyclic rotation of wavelet coefficients within each scale (Breakspear et al., 2003).  To get this behaviour, use `WLS(x, Circshift(1:length(x)), rescale = false, f = nothing)`.
  * Block resampling of wavelet coefficients within each scale (Breakspear et al., 2003). To get this behaviour, use `WLS(x, BlockShuffle(nblocks, randomize = true), rescale = false, f = nothing)`.
  * IAAFT resampling of wavelet coefficients within each scale (Keylock, 2006). To get this behaviour, use `WLS(x, IAAFT(), rescale = true, f = Statistics.cor)`.   This method preserves the local mean and variance structure of the signal, but    randomises nonlinear properties of the signal (i.e. Hurst exponents)[^Keylock2006].    These surrogates can therefore be used to test for changes in nonlinear properties    of the original signal. In contrast to IAAFT surrogates, the IAAFT-wavelet surrogates    also preserves nonstationarity. Using other `shufflemethod`s does not necessarily   preserve nonstationarity. To deal with nonstationary signals, Keylock (2006) recommends    using a wavelet with a high number of vanishing moments. Thus, our default is to   use a Daubechies wavelet with 16 vanishing moments. *Note: The iterative procedure after    the rank ordering step (step [v] in [^Keylock2006]) is not performed in    this implementation.*

The default method and parameters replicate the behaviour of Keylock (2006)'s IAAFT  wavelet surrogates.

## Error minimization

For the [`IAAFT`](@ref) approach introduced in Keylock (2006), detail coefficients  at each level are circularly rotated to minimize an error function. The methods  introduced in Breakspear et al. (2003) do not apply this error minimization.

In our implementation, you can turn this option on/off using the `f` parameter of  the `WLS` constructor. If `f = nothing` turns off error minization. If `f` is set  to a two-argument function that computes some statistic, for example  `f = Statistics.cor`, then detail coefficients at each scale are circularly  rotated until that function is maximized (and hence the "error" minimized).  If you want to *minimize* some error function, then instead provide an appropriate  transform of your function. For example, if using the root mean squared deviation, define `rmsd_inv(x, y) = 1 - StatsBase.rmsd(x, y)` and set `f = rmsd_inv`.

## Rescaling

If `rescale == true`, then surrogate values are mapped onto the  values of the original time series, as in the [`AAFT`](@ref) algorithm. If `rescale == false`, surrogate values are not constrained to the  original time series values. If [`AAFT`](@ref) or [`IAAFT`](@ref) shuffling  is used, `rescale` should be set to `true`. For other methods, it does not  necessarily need to be.

[^Breakspear2003]: Breakspear, M., Brammer, M., & Robinson, P. A. (2003). Construction of multivariate surrogate sets from nonlinear data using the wavelet transform. Physica D: Nonlinear Phenomena, 182(1-2), 1-22.

[^Keylock2006]: C.J. Keylock (2006). "Constrained surrogate time series with preservation of the mean and variance structure". Phys. Rev. E. 73: 036707. doi:10.1103/PhysRevE.73.036707.
