```
sinkhorn(
    μ, ν, C, ε, alg=SinkhornGibbs();
    atol=0, rtol=atol > 0 ? 0 : √eps, check_convergence=10, maxiter=1_000,
)
```

エントロピー正則化された最適輸送問題の最適輸送計画を、ソースおよびターゲットの周辺分布 `μ` と `ν`、サイズ `(length(μ), length(ν))` のコスト行列 `C`、およびエントロピー正則化パラメータ `ε` を用いて計算します。

最適輸送計画 `γ` は `C` と同じサイズであり、次の問題を解決します。

$$
\inf_{\gamma \in \Pi(\mu, \nu)} \langle \gamma, C \rangle
+ \varepsilon \Omega(\gamma),
$$

ここで、$\Omega(\gamma) = \sum_{i,j} \gamma_{i,j} \log \gamma_{i,j}$ はエントロピー正則化項です。

`check_convergence` ステップごとに、輸送計画の反復 `G` が次の条件を満たすかどうかを確認することで、アルゴリズムが収束しているかどうかが評価されます。

```julia
isapprox(sum(G; dims=2), μ; atol=atol, rtol=rtol, norm=x -> norm(x, 1))
```

デフォルトの `rtol` は `μ`、`ν`、および `C` の型に依存します。`maxiter` 回の反復後、計算は停止します。

共通のコスト行列 `C` を持つ複数のヒストグラムのバッチ計算は、`μ` または `ν` をヒストグラムに対応する列を持つ行列として渡すことで実行できます。ソースとターゲットの周辺分布の数が等しいか、単一のソースまたは単一のターゲット周辺分布が提供される必要があります（行列またはベクトルのいずれか）。最適輸送計画は三次元配列として返され、`γ[:, :, i]` は `i` 番目のソースとターゲットの周辺分布のペアに対する最適輸送計画です。

参照: [`sinkhorn2`](@ref)
