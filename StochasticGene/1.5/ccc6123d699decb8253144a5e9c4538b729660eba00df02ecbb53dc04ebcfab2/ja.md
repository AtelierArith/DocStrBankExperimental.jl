```
fit(; <キーワード引数> )
```

RNAデータに対して単一遺伝子の定常状態または過渡GM/GRSMモデルをフィットし、結果を（関数finalizeを通じて）書き込み、フィット結果と診断を返します。

結合転写ユニットの場合、引数transitions、G、R、S、insertstep、およびtraceは単一ユニットタイプのタプルになります。たとえば、G=2およびG=3の2種類の転写モデルが必要な場合、G = (2,3)となります。

# 引数

  * `annealsteps=0`: アニーリングステップの数（アニーリング中は温度がtempannealからtempに下がります）
  * `burst=false`: trueの場合、バースト頻度を計算します
  * `cell::String=""`: 半減期とアレル数のための細胞タイプ
  * `coupling=tuple()`: 空でない場合、各ユニットに対応するモデルインデックスの4タプルで、要素は次のとおりです。

    1. 各ユニットに対応するモデルインデックスのタプル。たとえば、(1, 1, 2)はユニット1と2がモデル1を使用し、ユニット3がモデル2を使用することを意味します。
    2. 各ユニットのソースユニットを示すベクトルのタプル。たとえば、([2,3], [1], Int[])はユニット1がソースユニット2と3の影響を受け、ユニット2がユニット1の影響を受け、ユニット3は影響を受けないことを意味します。
    3. ソース状態：文字列のベクトルのタプル。たとえば、(["G3","R1"], [])はモデル1がG状態3またはRステップ1のときに他のユニットに影響を与えることを意味します（数値が含まれていない場合（例：（R,0））、すべてのG状態またはRステップが含まれます）。モデル2は他のユニットに影響を与えません。
    4. ターゲット遷移：タプル。たとえば、([], 4)はモデル1がソースから影響を受けず、モデル2が遷移4でソースから影響を受けることを意味します。遷移は遷移率の順序で連続的に番号が付けられます。したがって、G=2モデルの場合、遷移1はG1からG2への遷移であり、遷移3は開始遷移です。
    5. 結合パラメータの数を示すInt
  * `datacol=3`: 使用するデータの列、デフォルトはRNAデータのための3
  * `datatype::String=""`: データタイプを説明する文字列、選択肢は"rna"、"rnaonoff"、"rnadwelltime"、"trace"、"tracerna"、"tracejoint"、"tracegrid"
  * `datacond=""`: データを説明する文字列または文字列のベクトル。たとえば、"WT"、"DMSO"または["DMSO","AUXIN"]、["gene","enhancer"]
  * `datapath=""`: データファイルまたはフォルダーへのパス、またはファイルまたはフォルダーの配列
  * `decayrate=1.0`: mRNAの減衰率、-1に設定すると、halflivesフォルダー内の値が存在する場合に使用されます
  * `ejectnumber=1`: バーストごとに生成されるmRNAの数、デフォルトは1
  * `dttype=String[]`: 滞在時間のタイプ、選択肢は"OFF"、"ON"（R状態用）および"OFFG"、"ONG"（G状態用）
  * `elongationtime=6.0`: 伸長の平均時間、結合モデルの時間のベクトル
  * `fittedparam::Vector=Int[]`: フィットするレートインデックスのベクトル。たとえば、[1,2,3,5,6,7]（階層モデルの共有レートに適用され、フィットされたハイパーパラメータは個別のfittedparamsによって指定されます）
  * `fixedeffects::String`: ハイフンの後に"fixed"が含まれている場合、R遷移が同一になるようにfixedeffectsタプルが作成されます
  * `fixedeffects::Tuple=tuple()`: 最初のインデックスがフィットし、他のインデックスが最初に固定されるレートのベクトルのタプル。たとえば、([3,8],)はインデックス8がインデックス3に固定されることを意味します（フィットされたparamには最初のパラメータのみを含めるべきです）（階層モデルの共有レートに適用されます）
  * `gene::String="MYC"`: 遺伝子名
  * `grid=nothing`: グリッドモデルのためのグリッドポイントのInt数
  * `G=2`: 遺伝子状態の数。結合モデルの場合、G、R、S、およびinsertstepはベクトル（結合モデルのためのベクトル）
  * `hierarchical=tuple()`: 非階層モデルのための空のタプル；階層モデルのための3タプル：hierarchical=(ハイパーパラメータセットの数::Int、個別のfittedparams::Vector、個別のfixedeffects::Tuple)。階層モデルの場合、キーワード`fittedparam`および`fixedeffects`は共有レートに関連します。レートは、モデルレートとノイズパラメータに対応する列を持つ行列に再形成できる単一のベクトルによって与えられます。最初のnhyper行は共有およびハイパーパラメータレート（フィットされているかどうかにかかわらず）に関連します。通常、最初の行は共有および平均ハイパーパラメータであり、2行目は標準偏差であり、残りの行は個別のレートとノイズパラメータです。
  * `infolder::String=""`: 初期パラメータに使用される結果フォルダー
  * `inlabel::String=""`: 初期条件に使用されるファイルのラベル
  * `insertstep=1`: レポータが挿入されるRステップ
  * `label::String=""`: 生成された出力ファイルのラベル
  * `maxtime=60`: 実行の最大壁時間、デフォルト= 60分
  * `method=Tsit5()`: DifferentialEquations.jlの数値法（例：Tsit5()、Tsit5()、...）；階層モデルの場合はタプルを使用：method = tuple(method, Bool) = (数値法（現在は使用されていない）、遷移率が共有されている場合はtrue)
  * `nalleles=1`: アレルの数。アレルフォルダー内の値が存在する場合に使用されます。結合モデルの場合、nallelesは定常状態RNAヒストグラムを計算する際にのみ使用され、結合されていないと見なされます。結合アレルをユニットとして追加し、nallelesを1に設定します。
  * `nchains::Int=2`: MCMCチェーンの数 = Juliaによって呼び出されるプロセッサの数、デフォルト= 2
  * `noisepriors=[]`: 観測ノイズの事前分布（トレースをフィットしない場合は空のセットを使用）、priormeanが設定されている場合は上書きされます
  * `onstates=Int[]`: onまたは滞在状態のベクトル。たとえば、[2]。複数のonstatesが必要な場合は、ベクトルのベクトルを使用します。たとえば、[[2,3],Int[]]。R状態用の空のベクトルまたは結合モデルのR状態用の空のベクトルのベクトルを使用します。R=0モデルにはInt[]を使用しないでください。
  * `optimize=false`: 最尤値を計算するためにオプティマイザを使用します
  * `priormean=Float64[]`: 事前分布の平均レート（フィットされていないレートを含むすべてのレートの事前分布を設定する必要があります）
  * `priorcv=10.`: （ベクトルまたは数）レート事前分布の変動係数、デフォルトは10。
  * `probfn=prob_Gaussian`: HMM観測確率の確率関数（すなわち、ノイズ分布）
  * `propcv=0.01`: 提案分布の変動係数（平均/標準偏差）。cv <= 0の場合、前回の実行からのcvが使用されます。
  * `resultfolder::String=test`: MCMC実行の結果のフォルダー
  * `R=0`: プレRNAステップの数（古典的な電報モデルの場合は0に設定）
  * `root="."`: プロジェクトのルートディレクトリの名前。たとえば、"scRNA"
  * `samplesteps::Int=1000000`: MCMCサンプリングステップの数
  * `S=0`: スプライス部位の数（古典的な電報モデルの場合は0に設定し、GRSモデルの場合はR - insertstep + 1に設定）
  * `splicetype=""`: GRSモデルのRNA経路（例："offeject" = スプライスされたイントロンは生存できない）
  * `temp=1.0`: MCMC温度
  * `tempanneal=100.`: アニーリング温度
  * `temprna=1.`: 滞在時間に比べてtemprnaでRNAカウントを減少させます
  * `traceinfo=(1.0, 1., -1, 1., 0.5)`: 5タプル = (強度トレースのフレーム間隔（分）、開始フレーム時間（分）、終了フレーム時間（最後のインデックスには-1を使用）、観測されたアクティブトレースの割合、背景平均)。同時共同トレースの場合、アクティブトレースの割合は各トレースのアクティブ割合のベクトルです。たとえば、(1.0, 1., -1, [.5, .7], [0.5,0.5])。アクティブ割合が1.0の場合、traceinfoは3タプルにすることができます。たとえば、(1.0, 1., -1)は背景補正が必要ないためです。すべてのトレースは、すべてのトレースの中央値の最大値でスケーリングされ、信号振幅は同じであるべきなので、すべてのトレースは同じ係数でスケーリングされます。
  * `TransitionType=""`: G遷移タイプを説明する文字列。たとえば、"3state"、"KP"（動的校正）、"cyclic"、または階層的な場合は結合
  * `transitions::Tuple=([1,2],[2,1])`: G状態の状態遷移を指定するベクトルのタプル。たとえば、([1,2],[2,1])は古典的な2状態電報モデルのためのものであり、([1,2],[2,1],[2,3],[3,1])は3状態動的校正モデルのためのものです。G=1の場合は空です。
  * `warmupsteps=0`: 提案分布の共分散を見つけるためのMCMCウォームアップステップの数
  * `writesamples=false`: trueの場合、MHサンプルを出力します。デフォルトはfalseです。
  * `zeromedian=false`: trueの場合、各トレースの中央値を各トレースから引き、その後中央値の最大値でスケーリングします。

# 戻り値

  * `fits`: MCMCフィット結果（事後サンプル、対数尤度など）
  * `stats`: パラメータの要約統計
  * `measures`: 診断測定（WAICおよびその標準誤差を含む。これは現在、総WAICのためであり、sqrt(n_obs)でスケーリングされています）
  * `data`、`model`、`options`: 使用されたデータ、モデル、およびオプション構造

# 注意事項

  * `propcv < 0`の場合、提案共分散は利用可能な場合、前回の実行から読み取られます。
  * WAICの標準誤差は総WAICのためのものであり（観測ごとではなく）、sqrt(n_obs)でスケーリングされています。
  * ファイルおよびフォルダーの規約が変更されている可能性があります。詳細についてはREADMEを参照してください。

# 例

データ/HCT116_testdataがインストールされているフォルダーにいる場合、次のようにして4つのMCMCチェーンを実行してモックRNAヒストグラムをフィットできます。

```julia
julia> fits, stats, measures, data, model, options = fit(nchains = 4)
```
