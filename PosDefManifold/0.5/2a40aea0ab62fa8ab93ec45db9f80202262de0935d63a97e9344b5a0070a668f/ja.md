```julia
    (1) spectralEmbedding(metric::Metric, ğ::â„Vector, q::Int, epsilon::Real=0;
    <
    tol::Real=0.,
    maxiter::Int=300,
    densityInvariant=false,
    verbose=false,
    â©=true >)

    (2) spectralEmbedding(type::Type{T}, metric::Metric, ğ::â„Vector, q::Int, epsilon::Real=0;
    < (1)ã¨åŒã˜ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•° >) where T<:Real
```

**ã‚¨ã‚¤ãƒªã‚¢ã‚¹**: `spEmb`

$$
k
$$

å€‹ã®æ­£å®šå€¤è¡Œåˆ—${P_1,...,P_k}$ï¼ˆå®Ÿæ•°ã¾ãŸã¯è¤‡ç´ æ•°ï¼‰ã®1æ¬¡å…ƒé…åˆ—$ğ$ã‚’ä¸ãˆã‚‰ã‚ŒãŸã¨ãã€$q$æ¬¡å…ƒã§ã®*å›ºæœ‰ãƒãƒƒãƒ—*ã‚’è¨ˆç®—ã—ã¾ã™ã€‚

ã“ã®é–¢æ•°ã¯ã€æ¬¡ã®é–¢æ•°ã‚’é †æ¬¡å®Ÿè¡Œã—ã¾ã™ï¼š

  * [`distanceSqrMat`](@ref)ï¼ˆäºŒä¹—é–“è·é›¢è¡Œåˆ—ã‚’è¨ˆç®—ï¼‰ã€
  * [`laplacian`](@ref)ï¼ˆæ­£è¦åŒ–ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã‚’è¨ˆç®—ï¼‰ã€
  * [`laplacianEigenMaps`](@ref)ï¼ˆå›ºæœ‰ãƒãƒƒãƒ—ã‚’å–å¾—ï¼‰ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ä¸Šè¨˜ã®ã™ã¹ã¦ã®è¨ˆç®—ã¯`Float32`ç²¾åº¦ã§è¡Œã‚ã‚Œã¾ã™ã€‚åˆ¥ã®å®Ÿæ•°å‹ã¯ã€`type`å¼•æ•°ãŒå®šç¾©ã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰(2)ã‚’ä½¿ç”¨ã—ã¦è¦æ±‚ã§ãã¾ã™ã€‚

4ã‚¿ãƒ—ãƒ«`(Î›, U, iterations, convergence)`ã‚’è¿”ã—ã¾ã™ã€‚ã“ã“ã§ï¼š

  * $$
    Î›
    $$

    ã¯ã€ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³å›ºæœ‰ãƒãƒƒãƒ—ã®$q$æ¬¡å…ƒã«å¯¾å¿œã™ã‚‹å›ºæœ‰å€¤ã‚’å¯¾è§’ã«ä¿æŒã™ã‚‹$qâ‹…q$å¯¾è§’è¡Œåˆ—ã§ã™ã€‚
  * $$
    U
    $$

    ã¯ã€åŸ‹ã‚è¾¼ã¿ç©ºé–“å†…ã®ç‚¹ã®$q$åº§æ¨™ã‚’ä¿æŒã™ã‚‹$q$å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’åˆ—ã«ä¿æŒã—ã¾ã™ã€‚
  * $$
    iterations
    $$

    ã¯ã€å†ªæ³•ã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚ŒãŸåå¾©ã®æ•°ã§ã™ã€‚
  * $$
    convergence
    $$

    ã¯ã€å†ªæ³•ã«ã‚ˆã£ã¦é”æˆã•ã‚ŒãŸåæŸã§ã™ã€‚

**å¼•æ•°**ï¼š

  * `metric`ã¯ã€é–“è·é›¢ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹[Metric::åˆ—æŒ™å‹](@ref)ã®ãƒ¡ãƒˆãƒªãƒƒã‚¯ã§ã™ã€‚
  * $$
    ğ
    $$

    ã¯ã€[â„Vectorå‹](@ref)ã®$k$å€‹ã®æ­£ã®è¡Œåˆ—ã®1æ¬¡å…ƒé…åˆ—ã§ã™ã€‚
  * $$
    q
    $$

    ã¯ã€ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³å›ºæœ‰ãƒãƒƒãƒ—ã®æ¬¡å…ƒã§ã™ã€‚
  * $$
    epsilon
    $$

    ã¯ã€ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®å¸¯åŸŸå¹…ã§ã™ï¼ˆ[`laplacian`](@ref)ã‚’å‚ç…§ï¼‰ã€‚
  * æ¬¡ã®*<ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°>*ã¯ã€é–“è·é›¢ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«é©ç”¨ã•ã‚Œã¾ã™ï¼š
  * `â©=true`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã®å ´åˆã€é–“è·é›¢ã®è¨ˆç®—ã¯ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã§è¡Œã‚ã‚Œã¾ã™ã€‚
  * æ¬¡ã®*<ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°>*ã¯ã€[`laplacian`](@ref)é–¢æ•°ã«ã‚ˆã‚‹ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®è¨ˆç®—ã«é©ç”¨ã•ã‚Œã¾ã™ï¼š
  * `densityInvariant=true`ã®å ´åˆã€å¯†åº¦ä¸å¤‰ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ãŒè¨ˆç®—ã•ã‚Œã¾ã™ï¼ˆ[`laplacian`](@ref)ã‚’å‚ç…§ï¼‰ã€‚
  * æ¬¡ã®*<ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°>*ã¯ã€[`laplacianEigenMaps`](@ref)ã«ã‚ˆã£ã¦å‘¼ã³å‡ºã•ã‚Œã‚‹å†ªæ³•åå¾©ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ãŸã‚ã®ã‚‚ã®ã§ã™ï¼š

      * `tol`ã¯ã€å†ªæ³•ã®åæŸã®ãŸã‚ã®è¨±å®¹èª¤å·®ã§ã™ï¼ˆä»¥ä¸‹ã‚’å‚ç…§ï¼‰ã€‚
      * `maxiter`ã¯ã€å†ªæ³•ã«è¨±å¯ã•ã‚Œã‚‹æœ€å¤§åå¾©å›æ•°ã§ã™ã€‚
      * `verbose=true`ã®å ´åˆã€ã™ã¹ã¦ã®åå¾©ã§ã®åæŸãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

!!! note "Nota Bene"
    $$
    tol
    $$

    ã¯ã€`Float32`å‹ï¼ˆ1ï¼‰ã¾ãŸã¯å¼•æ•°ï¼ˆ2ï¼‰ã¨ã—ã¦æ¸¡ã•ã‚ŒãŸ`type`ã®`Base.eps`ã®å¹³æ–¹æ ¹ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ç´„åŠåˆ†ã®æœ‰åŠ¹æ•°å­—ã«å¯¾ã™ã‚‹2å›ã®é€£ç¶šã—ãŸå†ªåå¾©ã®åæŸåŸºæº–ã®ç­‰ä¾¡æ€§ã‚’è¦æ±‚ã™ã‚‹ã“ã¨ã«ç›¸å½“ã—ã¾ã™ã€‚

    [ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰](https://docs.julialang.org/en/v1/manual/parallel-computing/#Multi-Threading-(Experimental)-1)ã¯ã€JuliaãŒ1ã¤ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã®ã¿ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«æŒ‡ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã€è‡ªå‹•çš„ã«ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚[Threads](@ref)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚


**é–¢é€£é …ç›®**: [`distanceSqrMat`](@ref), [`laplacian`](@ref), [`laplacianEigenMaps`](@ref)ã€‚

**ä¾‹**

```julia
using PosDefManifold
# kå€‹ã®ãƒ©ãƒ³ãƒ€ãƒ ãª10x10 SPDè¡Œåˆ—ã®ã‚»ãƒƒãƒˆã‚’ç”Ÿæˆ
k=10
Pset=randP(10, k)
evalues, maps, iter, conv=spectralEmbedding(Fisher, Pset, 2)

# åæŸæƒ…å ±ã‚’è¡¨ç¤º
evalues, maps, iter, conv=spectralEmbedding(Fisher, Pset, 2; verbose=true)

# Float64ç²¾åº¦ã‚’ä½¿ç”¨ã€‚
evalues, maps, iter, conv=spectralEmbedding(Float64, Fisher, Pset, 2)

using Plots
# å›ºæœ‰å€¤ã¨å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç¢ºèª
plot(diag(evalues))
plot(maps[:, 1])
plot!(maps[:, 2])
plot!(maps[:, 3])

# åŸ‹ã‚è¾¼ã¾ã‚ŒãŸç©ºé–“å†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
plot(maps[:, 1], maps[:, 2], seriestype=:scatter, title="ã‚¹ãƒšã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿", label="Pset")

# epsilonã®ç•°ãªã‚‹å€¤ã‚’è©¦ã™
evalues, maps, iter, conv=spEmb(Fisher, Pset, k-1, 0.01; maxiter=1000)
plot(maps[:, 1], maps[:, 2], seriestype=:scatter, title="ã‚¹ãƒšã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿", label="Pset")
# ã“ã‚Œã«é–¢ã™ã‚‹è©³ç´°ã¯`Laplacian`é–¢æ•°ã®ä¾‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„
```
