```
(1) spectralFunctions(P::â„{T}, func) where T<:RealOrComplex
(2) spectralFunctions(D::ğ”»{S}, func) where S<:Real

(1) ã“ã‚Œã¯ã€ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®å›ºæœ‰å€¤ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«é–¢æ•°ã®*æ¯é–¢æ•°*ã§ã™ã€‚ã“ã‚Œã«ã¯ä»¥ä¸‹ãŒå«ã¾ã‚Œã¾ã™ï¼š

  * `pow`     (ç´¯ä¹—),
  * `isqrt`   (é€†å¹³æ–¹æ ¹)ã€‚

é–¢æ•°`sqr`ï¼ˆå¹³æ–¹ï¼‰ã¯ã“ã‚Œã‚’ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚ãªãœãªã‚‰ã€å˜ç´”ãªä¹—ç®—ã«ã‚ˆã£ã¦ã‚ˆã‚ŠåŠ¹ç‡çš„ã«å¾—ã‚‰ã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚

æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸`LinearAlgebra`ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ä»¥å¤–ã®å›ºæœ‰å€¤ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«é–¢æ•°ãŒå¿…è¦ãªå ´åˆã¯ã€ã“ã®é–¢æ•°ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ä¸€èˆ¬çš„ã«ã¯ã€ç›´æ¥å‘¼ã³å‡ºã™ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

`func`ã¯å›ºæœ‰å€¤ã«é©ç”¨ã•ã‚Œã‚‹é–¢æ•°ã§ã™ã€‚

$P$ã¯ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆè¡Œåˆ—ã¨ã—ã¦ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è©³ç´°ã¯[typecasting matrices](@ref)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚`func`ã«å¿œã˜ã¦ã€æ­£å®šå€¤ã¾ãŸã¯åŠæ­£å®šå€¤ã®è¡Œåˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

å®Ÿæ•°ã®`Diagonal`è¡Œåˆ—ï¼ˆ2ï¼‰ã«ã¯ç‰¹åˆ¥ãªãƒ¡ã‚½ãƒƒãƒ‰ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

!!! note "Nota Bene"
    é–¢æ•°`func`ã¯`func.`æ§‹æ–‡ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã—ãŸãŒã£ã¦å›ºæœ‰å€¤ã«è¦ç´ ã”ã¨ã«é©ç”¨ã§ãã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆã“ã‚Œã«ã¯[åŒ¿åé–¢æ•°](https://docs.julialang.org/en/v1/manual/functions/#man-anonymous-functions-1)ãŒå«ã¾ã‚Œã¾ã™ï¼‰ã€‚

### æ•°å­¦

æ­£å®šå€¤è¡Œåˆ—$P$ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«é–¢æ•°ã®å®šç¾©ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

$f\big(P\big)=Uf\big(Î›\big)U^H,$

ã“ã“ã§ã€$U$ã¯$P$ã®å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’åˆ—ã«æŒã¤è¡Œåˆ—ã€$Î›$ã¯å¯¾è§’ã«ãã®å›ºæœ‰å€¤ã‚’æŒã¤è¡Œåˆ—ã§ã‚ã‚Šã€$f$ã¯å›ºæœ‰å€¤ã«è¦ç´ ã”ã¨ã«é©ç”¨ã•ã‚Œã‚‹é–¢æ•°ã§ã™ã€‚

**å‚ç…§**: [`evd`](@ref)ã€‚

**ä¾‹**

```

julia using LinearAlgebra, PosDefManifold n=5 P=randP(n) # P=randP(ComplexF64, 5)ã§ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆè¤‡ç´ è¡Œåˆ—ã‚’ç”Ÿæˆ noise=0.1; Q=spectralFunctions(P, x->x+noise) # å›ºæœ‰å€¤ã«ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºã‚’è¿½åŠ  tr(Q)-tr(P) â‰ˆ noise*n ? println(" â­ ") : println(" â›” ") ```
