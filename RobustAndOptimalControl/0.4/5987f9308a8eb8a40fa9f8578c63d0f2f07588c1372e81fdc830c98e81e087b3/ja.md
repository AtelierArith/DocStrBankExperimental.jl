```
sysr, hs, info = baltrunc_coprime(sys; residual = false, n = missing, factorization::F = DescriptorSystems.gnlcf, kwargs...)
```

`sys`の左共素因子分解のバランスされた切り捨てを計算します。追加のキーワード引数のヘルプについては、[`baltrunc2`](@ref)を参照してください。

共素因子削減は、モデルを$P(s) = M(s)^{-1}N(s)$に共素因子分解し、$M$と$N$は安定した因子であり、$P$が不安定なモードを含んでいても安定です。その後、システム$NM = \begin{bmatrix}N & M \end{bmatrix}$はバランスされた切り捨てを使用して削減され、最終的な低次元モデルは$P_r(s) = M_r(s)^{-1}N_r(s)$として形成されます。この方法では、$NM$のハンケル特異値が報告され、報告される誤差は$||NM - N_rM_r||_\infty$です。この方法は、モデル削減誤差$||NM - N_rM_r||_\infty$がプラントとコントローラの正規化共素マージンを超えない場合、$P$または$K$が削減されても閉ループが安定であることを保証するため、特に閉ループの状況で関心があります。正規化共素マージンは、`ncfmargin(P, K)`で計算できます（[`ncfmargin`](@ref)）。

# 引数:

  * `factorization`: 共素因子分解を実行する関数。非正規化因子分解は、`RobustAndOptimalControl.DescriptorSystems.glcf`を渡すことで使用できます。
  * `kwargs`: `DescriptorSystems.gbalmr`に渡され、以下にそのドキュメント文字列が再現されています：

Base.Docs.DocStr(svec("    gbalmr(sys, balance = false, matchdc = false, ord = missing, offset = √ϵ,\n           atolhsv = 0, rtolhsv = nϵ, atolmin = atolhsv, rtolmin = rtolhsv, \n           atol = 0, atol1 = atol, atol2 = atol, rtol, fast = true) -> (sysr, hs)\n\n適切で安定した記述子システム`sys = (A-λE,B,C,D)`に対して、伝達関数行列`G(λ)`を持つ、低次元実現`sysr = (Ar-λEr,Br,Cr,Dr)`と、システム`sys`の減少順序のハンケル特異値のベクトル`hs`を計算します。`balance = true`の場合、バランスに基づくアプローチが使用され、`sysr = (Ar-λI,Br,Cr,Dr)`の形の低次元最小実現が決定されます。連続時間システム`sys`の場合、結果として得られる実現`sysr`はバランスされており、すなわち、制御可能性と可観測性のグラミアンが等しく対角です。さらに`matchdc = true`の場合、結果として得られる`sysr`は状態残差化の公式を使用して計算され（*特異摂動近似*とも呼ばれます）、`sys`のDCゲインを保持します。この場合、結果として得られる実現`sysr`は（連続時間および離散時間システムの両方に対して）バランスされています。`balance = false`の場合、バランスなしの精度向上アプローチが使用され、低次元システム`sysr`が決定されます。\n\n`ord = nr`の場合、結果として得られる`sysr`の次数は`min(nr,nrmin)`であり、ここで`nrmin`は、`max(atolmin,rtolmin*HN)`を超えるハンケル特異値の数として決定される`sys`の最小実現の次数であり、`HN`は`G(λ)`のハンケルノルムです。`ord = missing`の場合、結果として得られる次数は`max(atolhsv,rtolhsv*HN)`を超えるハンケル特異値の数として選択されます。\n\nペンシル`A-λE`の固有値の安定性を確認するには、連続時間システムの場合は固有値の実部が`-β`未満である必要があり、離散時間システムの場合は固有値の絶対値が`1-β`未満である必要があります。ここで、`β`は安定性領域の境界オフセットです。使用するオフセット`β`は、キーワードパラメータ`offset = β`を介して指定できます。`β`に使用されるデフォルト値は`sqrt(ϵ)`であり、ここで`ϵ`は作業機械精度です。\n\nキーワード引数`atol1`、`atol2`、および`rtol`は、それぞれ、`A`、`B`、`C`、`D`の非ゼロ要素の絶対許容誤差、`E`の非ゼロ要素の絶対許容誤差、および`A`、`B`、`C`、`D`および`E`の非ゼロ要素の相対許容誤差を指定します。デフォルトの相対許容誤差は`nϵ`であり、ここで`ϵ`は作業*機械エプシロン*であり、`n`はシステム`sys`の次数です。キーワード引数`atol`を使用して、`atol1 = atol`および`atol2 = atol`を同時に設定できます。\n\n`E`が特異な場合、ペア`(A,E)`の制御不可能な無限固有値と非動的モードは、最小実現技術を使用して排除されます。実行された削減におけるランクの決定は、`fast = true`の場合は列ピボットを伴うランクを明らかにするQR分解に基づき、`fast = false`の場合はより信頼性の高いSVD分解に基づきます。\n\n方法：標準システムの次数削減には、[1]のバランスなしの方法または[2]のバランスに基づく方法が使用されます。記述子システムの場合、[3]のバランスに関連する次数削減方法が使用されます。元のシステムのDCゲインを保持するために、[4]の特異摂動近似法が[5]のバランスに基づくまたはバランスなしのアプローチと組み合わせて使用されます。\n\n参考文献\n\n[1] A. Varga. \n    バランスに基づく効率的な最小実現手続き。\n    A. El Moudni、P. Borne、およびS.G. Tzafestas（編）、\n    IMACSシンポジウムの予稿。技術システムのモデリングと制御、\n    フランス、リール、ボリューム2、pp.42-47、1991年。\n\n[2] M. S. TombsおよびI. Postlethwaite. \n    安定した非最小状態空間システムの切り捨てバランス実現。制御の国際ジャーナル、ボリューム46、pp. 1319–1330、1987年。\n\n[3] T. Stykel. \n    記述子システムのグラミアンに基づくモデル削減。 \n    制御、信号、およびシステムの数学、16:297–319、2004年。\n\n[4] Y. Liu Y.およびB.D.O. Anderson \n    バランスされたシステムの特異摂動近似、\n    制御の国際ジャーナル、ボリューム50、pp. 1379-1405、1989年。\n\n[5] Varga A.\n    特異摂動近似を計算するためのバランスなしの平方根アルゴリズム。\n    第30回IEEE CDC、ブライトン、1991年12月11-13日、ボリューム2、pp. 1062-1065。\n"), nothing, Dict{Symbol, Any}(:typesig => Union{Tuple{DescriptorSystems.DescriptorStateSpace{T, ET, MT} where {ET<:Union{LinearAlgebra.UniformScaling{Bool}, AbstractMatrix{T}}, MT<:AbstractMatrix{T}}}, Tuple{T}} where T, :module => DescriptorSystems, :linenumber => 461, :binding => DescriptorSystems.gbalmr, :path => "/home/terasaki/.julia/packages/DescriptorSystems/7S3aT/src/order_reduction.jl")) ```
