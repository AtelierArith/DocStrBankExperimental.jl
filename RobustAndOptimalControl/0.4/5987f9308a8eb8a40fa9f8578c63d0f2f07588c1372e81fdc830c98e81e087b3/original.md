```
sysr, hs, info = baltrunc_coprime(sys; residual = false, n = missing, factorization::F = DescriptorSystems.gnlcf, kwargs...)
```

Compute a balanced truncation of the left coprime factorization of `sys`. See [`baltrunc2`](@ref) for additional keyword-argument help.

Coprime-factor reduction performs a coprime factorization of the model into $P(s) = M(s)^{-1}N(s)$ where $M$ and $N$ are stable factors even if $P$ contains unstable modes. After this, the system $NM = \begin{bmatrix}N & M \end{bmatrix}$ is reduced using balanced truncation and the final reduced-order model is formed as $P_r(s) = M_r(s)^{-1}N_r(s)$. For this method, the Hankel signular values of $NM$ are reported and the reported errors are $||NM - N_rM_r||_\infty$. This method is of particular interest in closed-loop situations, where a model-reduction error $||NM - N_rM_r||_\infty$ no greater than the normalized-coprime margin of the plant and the controller, guaratees that the closed loop remains stable when either $P$ or $K$ are reduced. The normalized-coprime margin can be computed with `ncfmargin(P, K)` ([`ncfmargin`](@ref)).

# Arguments:

  * `factorization`: The function to perform the coprime factorization. A non-normalized factorization may be used by passing `RobustAndOptimalControl.DescriptorSystems.glcf`.
  * `kwargs`: Are passed to `DescriptorSystems.gbalmr`, the docstring of which is reproduced below:

Base.Docs.DocStr(svec("    gbalmr(sys, balance = false, matchdc = false, ord = missing, offset = √ϵ,\n           atolhsv = 0, rtolhsv = nϵ, atolmin = atolhsv, rtolmin = rtolhsv, \n           atol = 0, atol1 = atol, atol2 = atol, rtol, fast = true) -> (sysr, hs)\n\nCompute for a proper and stable descriptor system `sys = (A-λE,B,C,D)` with the transfer function\nmatrix `G(λ)`, a reduced order realization `sysr = (Ar-λEr,Br,Cr,Dr)` and the vector `hs` of decreasingly \nordered Hankel singular values of the system `sys`. If `balance = true`, a balancing-based approach\nis used to determine a reduced order minimal realization \nof the form `sysr = (Ar-λI,Br,Cr,Dr)`. For a continuous-time system `sys`, the resulting realization `sysr`\nis balanced, i.e., the controllability and observability grammians are equal and diagonal. \nIf additonally `matchdc = true`, the resulting `sysr` is computed using state rezidualization formulas \n(also known as *singular perturbation approximation*) which additionally preserves the DC-gain of `sys`. \nIn this case, the resulting realization `sysr` is balanced (for both continuous- and discrete-time systems).\nIf `balance = false`, an enhanced accuracy balancing-free approach is used to determine the \nreduced order system `sysr`. \n\nIf `ord = nr`, the resulting order of `sysr` is `min(nr,nrmin)`, where `nrmin` is the order of a minimal  \nrealization of `sys` determined as the number of Hankel singular values exceeding `max(atolmin,rtolmin*HN)`, with\n`HN`, the Hankel norm of `G(λ)`. If `ord = missing`, the resulting order is chosen as the number of Hankel \nsingular values exceeding `max(atolhsv,rtolhsv*HN)`. \n\nTo check the stability of the eigenvalues of the pencil `A-λE`, the real parts of eigenvalues must be less than `-β`\nfor a continuous-time system or \nthe moduli of eigenvalues must be less than `1-β` for a discrete-time system, where `β` is the stability domain boundary offset.  \nThe offset  `β` to be used can be specified via the keyword parameter `offset = β`. \nThe default value used for `β` is `sqrt(ϵ)`, where `ϵ` is the working machine precision. \n\nThe keyword arguments `atol1`, `atol2`, and `rtol`, specify, respectively, \nthe absolute tolerance for the nonzero elements of `A`, `B`, `C`, `D`,  \nthe absolute tolerance for the nonzero elements of `E`,  \nand the relative tolerance for the nonzero elements of `A`, `B`, `C`, `D` and `E`.  \nThe default relative tolerance is `nϵ`, where `ϵ` is the working *machine epsilon* \nand `n` is the order of the system `sys`. The keyword argument `atol` can be used \nto simultaneously set `atol1 = atol` and `atol2 = atol`. \n\nIf `E` is singular, the uncontrollable infinite eigenvalues of the pair `(A,E)` and\nthe non-dynamic modes are elliminated using minimal realization techniques.\nThe rank determinations in the performed reductions\nare based on rank revealing QR-decompositions with column pivoting \nif `fast = true` or the more reliable SVD-decompositions if `fast = false`. \n\nMethod:  For the order reduction of a standard system, the balancing-free method of [1] or \nthe balancing-based method of [2] are used. For a descriptor system the balancing related order reduction \nmethods of [3] are used. To preserve the DC-gain of the original system, the singular perturbation \napproximation method of [4] is used in conjunction with the balancing-based or balancing-free\napproach of [5]. \n\nReferences\n\n[1] A. Varga. \n    Efficient minimal realization procedure based on balancing.\n    In A. El Moudni, P. Borne, and S.G. Tzafestas (Eds.), \n    Prepr. of the IMACS Symp. on Modelling and Control of Technological \n    Systems, Lille, France, vol. 2, pp.42-47, 1991.\n\n[2] M. S. Tombs and I. Postlethwaite. \n    Truncated balanced realization of a stable non-minimal state-space \n    system. Int. J. Control, vol. 46, pp. 1319–1330, 1987.\n\n[3] T. Stykel. \n    Gramian based model reduction for descriptor systems. \n    Mathematics of Control, Signals, and Systems, 16:297–319, 2004.\n\n[4] Y. Liu Y. and B.D.O. Anderson \n    Singular Perturbation Approximation of Balanced Systems,\n    Int. J. Control, Vol. 50, pp. 1379-1405, 1989.\n\n[5] Varga A.\n    Balancing-free square-root algorithm for computing singular perturbation approximations.\n    Proc. 30-th IEEE CDC,  Brighton, Dec. 11-13, 1991, Vol. 2, pp. 1062-1065.\n"), nothing, Dict{Symbol, Any}(:typesig => Union{Tuple{DescriptorSystems.DescriptorStateSpace{T, ET, MT} where {ET<:Union{LinearAlgebra.UniformScaling{Bool}, AbstractMatrix{T}}, MT<:AbstractMatrix{T}}}, Tuple{T}} where T, :module => DescriptorSystems, :linenumber => 461, :binding => DescriptorSystems.gbalmr, :path => "/home/terasaki/.julia/packages/DescriptorSystems/7S3aT/src/order_reduction.jl"))
