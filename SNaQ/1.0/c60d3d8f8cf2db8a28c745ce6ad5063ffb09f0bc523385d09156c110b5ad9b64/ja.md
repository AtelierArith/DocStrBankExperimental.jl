```
snaq!(T::HybridNetwork, d::DataCF)
```

観測されたクワルテットの一致因子（CF）をDataCFオブジェクトに格納されたものにフィットさせるネットワーク（またはツリー）を推定します。最大擬似尤度を使用します。レベル1のネットワークが仮定されています。検索はトポロジー`T`から始まり、`hmax`ハイブリッドノードを超えないツリーまたはネットワークであることができます。関数名は!で終わるのは、CFデータ`d`を修正し、その属性`expCF`を更新するためです：ネットワークモデルの下で期待されるCFです。`T`は*変更されません*。クワルテット擬似逸脱は、加法定数までの負の対数擬似尤度であり、完全なフィットは逸脱0.0に対応します。

出力：

  * ファイル`.out`（および`.log`）に推定されたネットワーク：全体の最良ネットワークと各個別の実行からのネットワークのリスト。
  * ファイル`.networks`における最良ネットワークとその修正。すべてのネットワークは最良ネットワークと同じ無向トポロジーを持っていますが、異なるハイブリッド/遺伝子流の方向を持っています。これらの他のネットワークは、その擬似尤度スコアと共に報告されます。非同定性の問題により、非常に似たスコアを持つことがあるため、SNaQは無向トポロジーを正確に推定することが示されていますが、近い非同定性のケースではハイブリダイゼーションの方向を推定することはできません。
  * エラーが発生した場合、ファイル`.err`はエラーを再現するための情報（シード）を提供します。

多くのオプション引数があります。含まれるものは：

  * `hmax`（デフォルト1）：許可されるハイブリダイゼーションの最大数
  * `verbose`（デフォルトfalse）：trueの場合、数値最適化に関する情報を印刷します
  * `runs`（デフォルト10）：検索のための独立した出発点の数
  * `outgroup`（デフォルトなし）：推定されたトポロジーを最終的に根付けるための外群タクソン
  * `filename`（デフォルト"snaq"）：出力ファイル（`.out`、`.err`）のルート名。空（""）の場合、ファイルは*作成されず*、進行ログは画面のみに出力されます（標準出力）。
  * `seed`（デフォルト0、時計から取得）：特定の検索を再現するためのシード
  * `probST`（デフォルト0.3）：各実行で`T`から開始する確率。確率1-probSTで、検索はハイブリッド隣接ノードのないツリーエッジに沿った`T`のNNI修正から開始され、`T`に1つのレティキュレーションがある場合は1つの修正が可能です。
  * `updateBL`（デフォルトtrue）：trueの場合、`T`がツリーであれば、`updateBL!`を使用して各ブランチを定義するすべてのクワルテットの平均CFを使用して、`T`のブランチ長を最初に大まかに最適化します。

次のオプション引数は、各個別候補ネットワークのブランチ長とγの最適化を停止するタイミングを制御します。デフォルトは括弧内にあります：

  * `ftolRel`（1e-6）および`ftolAbs`（1e-6）：現在のパラメータと提案されたパラメータ間のネットワークスコアの相対的および絶対的な差、
  * `xtolRel`（1e-2）および`xtolAbs`（1e-3）：現在のパラメータと提案されたパラメータ間の相対的および絶対的な差。

大きな値は、徹底的ではないがより速い検索をもたらします。これらのパラメータは、候補ネットワークを評価する際にのみ使用されます。次のオプション引数は、新しいネットワークトポロジーの提案を停止するタイミングを制御します：

  * `Nfail`（75）：新しいトポロジーが提案されて拒否される最大回数（連続）。
  * `liktolAbs`（1e-6）：提案されたネットワークは、そのスコアが現在のスコアよりも少なくともliktolAbsだけ良い場合に受け入れられます。

`Nfail`の低い値と`liktolAbs`および`ftolAbs`の高い値は、徹底的ではないがより速い検索をもたらします。

最後に、ブランチ長とγは、異なる非常に徹底した許容パラメータで最後の「最良」ネットワークで最適化されます：`ftolRel`に対して1e-12、`ftolAbs`に対して1e-10、`xtolRel`、`xtolAbs`。

参照：   Claudia Solís-LemusおよびCécile Ané（2016）。不完全な系統分化の下で最大擬似尤度を用いて系統ネットワークを推定する。[PLoS Genetics 12(3):e1005896](http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1005896)
