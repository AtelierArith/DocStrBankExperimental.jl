```
value_and_gradient!!(cache::Cache, f, x...)
```

2タプルを計算します。最初の要素は `f(x...)` で、2番目の要素は `f` の各引数に関する勾配を含むタプルです。最初の要素は `f` の任意の微分可能なフィールドに関する勾配で、2番目は `x` の最初の要素に関する勾配、などです。

`f` が `Union{Float16, Float32, Float64}` を返すことを前提としています。

Mooncakeのすべての機能と同様に、`f` が自分自身または `x` を変更する場合、`value_and_gradient!!` は勾配を計算する過程の一部として両方を元の状態に戻します。

!!! info
    `cache` は [`prepare_gradient_cache`](@ref) の出力でなければならず、`f` と `x` の（フィールドの）サイズと形状は `cache` を構築するために使用されたものと同じでなければなりません。これは、勾配が `cache` が構築されたときに割り当てられたメモリに書き込まれることを保証するためです。


!!! warning
    `cache` はこの関数によって返される可変状態を所有しており、つまり、この関数を異なる引数で再度実行すると、返される値の可変コンポーネントが変更されます。したがって、この関数を同じ `cache` で複数回呼び出す際に返される値を保持する必要がある場合は、再度呼び出す前にそれらのコピー（`copy` または `deepcopy` を使用）を取るべきです。


# 使用例

```jldoctest
f(x, y) = sum(x .* y)
x = [2.0, 2.0]
y = [1.0, 1.0]
cache = prepare_gradient_cache(f, x, y)
value_and_gradient!!(cache, f, x, y)

# 出力

(4.0, (NoTangent(), [1.0, 1.0], [2.0, 2.0]))
```
