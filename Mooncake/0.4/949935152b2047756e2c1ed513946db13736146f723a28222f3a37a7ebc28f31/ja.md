```
value_and_pullback!!(cache::Cache, ȳ, f, x...)
```

!!! info
    `f(x...)` がスカラーを返す場合は、この関数ではなく [`value_and_gradient!!`](@ref) を使用するべきです。


2タプルを計算します。最初の要素は `f(x...)` で、2番目の要素は `ȳ` に適用された `f` のプルバックを含むタプルです。最初の要素は `f` の任意のフィールドに関連するプルバックのコンポーネントであり、2番目は `x` の最初の要素に関するものです。

`y = f(x...)` が返すことが許可されているものに制限はありません。ただし、`ȳ` は `y` に対して受け入れ可能な接線でなければなりません。これは、例えば `tangent_type(typeof(y)) == typeof(ȳ)` が成り立つ必要があることを意味します。

Mooncake のすべての機能と同様に、`f` が自分自身または `x` を変更する場合、`value_and_gradient!!` は勾配を計算する過程の一部として、両方を元の状態に戻します。

!!! info
    `cache` は [`prepare_pullback_cache`](@ref) の出力でなければならず、`f` と `x` の（フィールドの）サイズと形状は `cache` を構築するために使用されたものと同じでなければなりません。これは、勾配が `cache` が構築されたときに割り当てられたメモリに書き込まれることを保証するためです。


!!! warning
    `cache` はこの関数によって返される可変状態を所有しており、異なる引数でこの関数を再度実行すると、返される値の可変コンポーネントが変更されます。したがって、同じ `cache` でこの関数を複数回呼び出す際に、返される値を保持する必要がある場合は、再度呼び出す前にそれらのコピー（`copy` または `deepcopy` を使用）を取るべきです。


# 使用例

```jldoctest
f(x, y) = sum(x .* y)
x = [2.0, 2.0]
y = [1.0, 1.0]
cache = Mooncake.prepare_pullback_cache(f, x, y)
Mooncake.value_and_pullback!!(cache, 1.0, f, x, y)

# 出力

(4.0, (NoTangent(), [1.0, 1.0], [2.0, 2.0]))
```
